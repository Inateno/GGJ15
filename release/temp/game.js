/*
 ___ ___ ___ ___ ___ ____ ___ ___ ___ ___ ___ ____ ___ ___ ___ ___ ___ _____ ___ ___ ___ ___ ___ ____ ___ ___
/    ____    ____    ____   _____   _      _     ____   __    _   ______   _   __    _   ____                \
|   |    \  |  _ \  |  __| /  _  \ | \    / |   |  __| |  \  | | /  ____| |_| |  \  | | |  __|      <|>      |
|   | |\  | | |_\ | | |__  | |_| | |  \  /  |   | |__  |   \ | | | |  __   _  |   \ | | | |__    /|_/|\_|\   |
|   | | | | |  _ /  |  __| |  _  | |   \/   |   |  __| | |\ \| | | | |_ | | | | |\ \| | |  __|  <<---X--->>  |
|   | |/  | | | |\  | |__  | | | | | |\__/| |   | |__  | | \   | | |___|| | | | | \   | | |__    \| \|/ |/   |
|   |____/  |_| |_\ |____| |_| |_| |_|    |_|   |____| |_|  \__| \______/ |_| |_|  \__| |____|      <|>      |
\___________________________________________________________________________________________________________/

-- by Inateno aka Rogliano Antoine for Dreamirl and all HTML5 lovers --
@DreamirlGames - http://dreamirl.com
@Inateno - http://inateno.com

The Dreamengine is released under the MIT License : http://opensource.org/licenses/MIT
You can't sell the engine, but game made with could be.

The Dreamengine use:
- RequireJS (module loader)                 -->    requirejs.org
- stashJS (localStorage)    by Rezitech     -->    rezitech.github.io/stash
- buzz (audio lib)          by Jay Salvat   -->    buzz.jaysalvat.com
- hand (mouse & touch)      by David Catuhe -->    handjs.codeplex.com

DreamEngine version 0.1.0

*/

/*! Stash v1.2.4 MIT/GPL2 @rezitech */

// Licensed under the MIT license.

// Copyright (C) 2010-2013 Jay Salvat

define("DE.CONFIG",[],function(){var e={};return e.DEName="CONFIG",e.DEBUG=0,e.DEBUG_LEVEL=0,e.CLICK_DELAY=200,e.COLLISION_TYPE={ORIENTED_BOX:1,FIXED_BOX:2,CIRCLE:3},e.DEFAULT_SIZES={BUTTON:{WIDTH:120,HEIGHT:50,OFFSET_TOP:10,FONT_SIZE:25},GUI:{WIDTH:100,HEIGHT:100}},e.debug={log:function(t,n){if(e.DEBUG&&(!n||e.DEBUG_LEVEL>=n)){var r=[];for(var i in arguments)r.push(arguments[i]);r.splice(1,1),console.log.apply(console,r)}}},e.notifications={gamepadEnable:!0,gamepadAvalaible:"Gamepad avalaible !",gamepadChange:!0},e.debug.log("CONFIG loaded",3),e}),define("DE.COLORS",["DE.CONFIG"],function(e){var t={};return t.DEName="COLORS",t.defaultColor="white",t.DEBUG={},t.DEBUG.GAME_OBJECT="white",t.DEBUG.GUI="purple",t.DEBUG.X_AXIS="blue",t.DEBUG.Y_AXIS="red",t.DEBUG.COLLIDER="rgb(205,20,100)",t.DEBUG.CIRCLE_COLLIDER="rgb(205,50,100)",e.debug.log("COLORS loaded",3),t}),define("DE.Event",["DE.CONFIG"],function(e){var t=new function(){this.DEName="Event"};t.callbacks={},t.contexts={},t.persistents=
{},t.on=function(e,n,r,i){t.callbacks[e]||(t.callbacks[e]=new Array,t.contexts[e]=new Array,t.persistents[e]=new Array),t.callbacks[e].push(n),t.contexts[e].push(r||window),t.persistents[e].push(i!==undefined?i:!0)},t.emit=function(){var e=Array.prototype.slice.call(arguments),n=e.shift(),r=t.callbacks[n]||[],i=t.contexts[n]||[],s=t.persistents[n]||[];for(var o=0;o<r.length;o++)r[o].apply(i[o],e),s[o]||(delete r[o],delete i[o],delete s[o],r.splice(o,1),i.splice(o,1),s.splice(o,1),--o)},t.trigger=t.emit,e.debug.log("Event loaded",3),t.addEventComponents=function(e){e.callbacks={},e.contexts={}},t.addEventCapabilities=function(e){e.prototype?(e.prototype.on=n,e.prototype.emit=r,e.prototype.trigger=r,e.prototype.stopListen=i):(e.callbacks={},e.contexts={},e.on=n,e.emit=r,e.trigger=r,e.stopListen=i)};var n=function(e,t,n){this.callbacks[e]||(this.callbacks[e]=[],this.contexts[e]=[]),this.callbacks[e].push(t),this.contexts[e].push(n||this)},r=function(){var e=Array.prototype.slice.call(arguments
),t=e.shift(),n=this.callbacks[t]||[];for(var r=0;r<n.length;++r)n[r].apply(this.contexts[t][r],e)},i=function(e,t){if(!t)return delete this.callbacks[e],!0;for(var n in this.callbacks[e])if(this.callbacks[e][n]==t)return this.callbacks[e].splice(n,1),this.contexts[e].splice(n,1),!0;return!1};return e.debug.log("Event classes loaded",3),t}),define("DE.Time",["DE.CONFIG","DE.Event"],function(e,t){var n=new function(){this.DEName="Time",this.deltaTime=1,this.missedFrame=0,this.lastCalcul=Date.now(),this.scaleDelta=1,this.currentTime=Date.now(),this.lastRender=Date.now(),this.fps=0,this.FPS=30,this.update=function(){return this.currentTime=Date.now(),this.timeSinceLastFrame=this.currentTime-this.lastCalcul,this.timeSinceLastFrame<14?!1:(this.fps=Math.floor(1e3/this.timeSinceLastFrame),this.deltaTime=this.timeSinceLastFrame/14*this.scaleDelta,this.missedFrame=this.deltaTime,this.deltaTime>2&&(this.deltaTime=this.deltaTime%1,this.deltaTime<1&&(this.deltaTime+=1)),this.deltaTime<0&&(this.deltaTime+=1
),this.missedFrame=this.missedFrame-this.deltaTime,this.timeSinceLastFrameScaled=(this.currentTime-this.lastRender)*this.scaleDelta,this.lastRender=this.currentTime,this.lastCalcul=this.currentTime,!0)},this.getDelta=function(){return this.deltaTime}};return t.on("isInited",function(){n.deltaTime=0,n.lastCalcul=Date.now()}),e.debug.log("Time loaded",3),n}),define("DE.Vector2",["DE.Time","DE.CONFIG"],function(e,t){function n(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0,this.rotation=0;var o=1,u=0;return this.setRotation=function(e){return this.rotation=e%(r*2),this.rotation==0?(u=0,o=1):(u=Math.sin(this.rotation),o=Math.cos(this.rotation)),this.rotation},this.setPosition=function(e,t){return e.x&&e.y?(this.x=e.x,this.y=e.y,this):(this.x=e,this.y=t,this)},this.rotate=function(t,n){return n?this.setRotation(this.rotation+t):this.setRotation(this.rotation+t*e.deltaTime)},this.multiply=function(e){return this.x*=e,this.y*=e,this},this.translate=function(t,n,r){if(!t.x&&t.x!=0||!t.y&&t.y!=0)throw new 
Error(t+" is not a Vector2");return r||(t={x:t.x*e.deltaTime,y:t.y*e.deltaTime}),n?(this.x+=t.x,this.y+=t.y):this.rotation==0?(this.x+=t.x,this.y+=t.y):(this.x-=-t.x*o+t.y*u,this.y-=-t.x*u+t.y*-o),this},this.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return this.x=this.x/e,this.y=this.y/e,this},this.getVector=function(e,t){if(!e.x&&e.x!=0||!e.y&&e.y!=0||!t.x&&t.x!=0||!t.y&&t.y!=0)throw new Error("Vector2 need two Vector2 to return getVector");return this.x=t.x-e.x,this.y=t.y-e.y,this},this.dotProduct=function(e,t){if(!e.x||!e.y)throw new Error("Vector2 need two Vector2 to return dotProduct");return t&&t.x?e.x*t.x+e.y*t.y:this.x*e.x+this.y*e.y},this.getAngle=function(e,t){var r=null;t.x?r=(new n(t.x,t.y)).normalize():r=(new n(this.x,this.y)).normalize();var i=(new n(e.x,e.y)).normalize();return Math.acos(i.dotProduct(r))},this.getDistance=function(e){var t=this.x-e.x;t*=t;var n=this.y-e.y;return n*=n,Math.sqrt(t+n)>>0},this.isInRangeFrom=function(e,t){t*=t;var n=this
.x-e.x;n*=n;var r=this.y-e.y;r*=r;var i=n+r;return i<=t?!0:!1},this.getHarmonics=function(e){return e?{cos:Math.cos(e+this.rotation),sin:Math.sin(e+this.rotation)}:{cos:o,sin:u}},this}var r=Math.PI;return n.prototype.DEName="Vector2",t.debug.log("Vector2 loaded",3),n}),define("DE.Sizes",["DE.CONFIG"],function(e){function t(e,t,n,r,i){if(!e||!t)throw new Error("Sizes :: You have to pass a width and height when instantiate -- see the doc");this.width=e,this.height=t,this.scaleX=n||1,this.scaleY=r||1,this.parent=i,this.setScale=function(e,t){return this._uncenter(),e.x&&e.y?(this.scaleX=e.x,this.scaleY=e.y):t?(this.scaleX=e,this.scaleY=t):(this.scaleX=e,this.scaleY=e),this._center(),this},this._center=function(){return this.parent&&(this.parent.localPosition.x-=this.width*this.scaleX*.5>>0,this.parent.localPosition.y-=this.height*this.scaleY*.5>>0),this},this._uncenter=function(){return this.parent&&(this.parent.localPosition.x+=this.width*this.scaleX*.5>>0,this.parent.localPosition.y+=this
.height*this.scaleY*.5>>0),this},this.scaleTo=function(e,t){return this._uncenter(),e.x&&e.y?(this.scaleX=e.x,this.scaleY=e.y):(this.scaleX=e,this.scaleY=e),this._center(),this},this.scaleXTo=function(e,t){return this._uncenter(),this.scaleX=valX,this._center(),this},this.scaleYTo=function(e){return this._uncenter(),this.scaleY=valY,this._center(),this},this.setSizes=function(e,t){return this._uncenter(),e.width?(this.width=e.width,this.height=e.height||this.height):e&&!t?(this.width=e,this.height=e):(this.width=e,this.height=t),this._center(),this}}return t.prototype.DEName="Sizes",e.debug.log("Sizes loaded",3),t}),define("DE.States",["DE.Event","DE.CONFIG"],function(e,t){var n={isLoadingImages:!1,isReady:!1,isInited:!1,isLoading:!0},r=new function(){this.DEName="States",this.up=function(r){t.debug.log("State up "+r,3),i(r,!0),e.emit(r,!0),n[r]=!0},this.down=function(r){t.debug.log("State down "+r,3),i(r,!1),e.emit("not"+r,!1),n[r]=!1},this.get=function(e){return n[e]}},i=function(e,t)
{if(e=="isReady"||e=="isLoading")return;var i=n;(!i.isLoadingImages||e=="isLoadingImages"&&t===!1)&&(i.isInited||e=="isInited"&&t===!0)&&r.up("isReady")};return t.debug.log("states loaded",3),r}),define("DE.CanvasBuffer",["DE.CONFIG"],function(e){function t(e,t){if(!e||!t)throw new Error("CanvasBuffer :: can't instantiate a buffer with a width or a height 0 -- see the doc");this.canvas=document.createElement("canvas"),this.canvas.width=e,this.canvas.height=t,this.ctx=this.canvas.getContext("2d"),this.ctx.mozImageSmoothingEnabled=!0,this.ctx.webkitImageSmoothingEnabled=!0,this.resize=function(e,t){return this.canvas.width=e,this.canvas.height=t,this},this.clear=function(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this}}return t.prototype.DEName="CanvasBuffer",e.debug.log("CanvasBuffer loaded",3),t}),define("DE.ImageManager",["DE.CONFIG","DE.States","DE.Event","DE.CanvasBuffer"],function(e,t,n,r){var i=new function(){this.DEName="ImageManager",this.images={},this
.imagesLoaded=0,this.imagesRequested=0,this.defaultImages=[],this.pathPrefix="",this.imageNotRatio=!1,this.ratioToConception=1,this.folderName="img",this.arrayLoader=function(n){if(!n){e.debug.log("%cno images loaded",1,"color:red");return}var r=n;for(var i=0,s;i<r.length;++i){s=r[i];if(!s||(s[3]||{}).load===!1)continue;this.pushImage(s[0],s[1],s[2],s[3])}n.length==0&&setTimeout(function(){t.down("isLoadingImages")},10)},this.pushImage=function(n,r,s,o){o=o||{},this.images[n]=new Image;var u=this.images[n];u.src=this.folderName+"/"+this.pathPrefix+r+"."+s,u.name=n,u.totalFrame=o.totalFrame||1,u.totalLine=o.totalLine||1,u.eachAnim=o.eachAnim||0,u.isReversed=o.isReversed||!1,u.isAnimated=o.isAnimated||!1,u.isPaused=o.isPaused||!1,u.isLoop=o.isLoop!=undefined?o.isLoop:!0,u.totalFrame<=1&&(u.isAnimated=!1),u.onload=function(){i.imageLoaded(this)},this.imagesRequested++,t.up("isLoadingImages"),e.debug.log("LoadImage "+n,3)},this.imageLoaded=function(i){e.debug.log("Image:"+i.name+" correctly loaded"
,3);var s=new r(i.width,i.height),o=s.canvas,u=s.ctx;this.imageNotRatio&&(o.width=o.width*this.ratioToConception,o.height=o.height*this.ratioToConception),o.name=i.name,o.totalFrame=i.totalFrame,o.totalLine=i.totalLine,o.eachAnim=i.eachAnim,o.isReversed=i.isReversed,o.isAnimated=i.isAnimated,o.isPaused=i.isPaused,o.isLoop=i.isLoop,o.widthFrame=o.width/o.totalFrame>>0,o.heightFrame=o.height/o.totalLine>>0,u.drawImage(i,0,0,o.width,o.height),this.images[i.name]=o,this.imagesLoaded++,this.imagesLoaded==this.imagesRequested&&t.down("isLoadingImages"),n.emit("imageLoaded",this.imagesLoaded,this.imagesRequested,i.name)}};return e.debug.log("ImageManager loaded",3),i}),define("DE.CollisionSystem",["DE.CONFIG"],function(e){var t=new function(){this.DEName="CollisionSystem",this.pointFixedBoxCollision=function(e,t){var n=t.getRealPosition?t.getRealPosition():{x:t.x,y:t.y};return e.x>=n.x&&e.x<n.x+t.width&&e.y>=n.y&&e.y<n.y+t.height?!0:!1},this.fixedBoxCollision=function(e,t){var n=e.getRealPosition?
e.getRealPosition():{x:e.x,y:e.y},r=t.getRealPosition?t.getRealPosition():{x:t.x,y:t.y};return r.x>=n.x+e.width||r.x+t.width<=n.x||r.y>=n.y+e.height||r.y+t.height<=n.y?!1:!0},this.pointCircleCollision=function(e,t){var n=t.getRealPosition(),r=(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y);return r>t.radius*t.radius?!1:!0},this.circleCollision=function(e,t){var n=(t.radius+e.radius)*(t.radius+e.radius),r=e.getRealPosition(),i=t.getRealPosition(),s=(i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y);return s<n?!0:!1},this.orientedBoxCollision=function(e,t){var n=e.getExternCircle(),r=t.getExternCircle(),i=n.radius+r.radius;i*=i;var s=e.getRealPosition(),o=t.getRealPosition(),u=(o.x-s.x)*(o.x-s.x)+(o.y-s.y)*(o.y-s.y);return u>i?!1:!0},this.fixedBoxWithOrientedBoxCollision=function(e,t){},this.orientedBoxWithCircleCollision=function(e,t){},this.fixedBoxWithCircleCollision=function(e,t){},this.checkCollisionWith=function(t,n){if(n.type==t.type){switch(t.type){case e.COLLISION_TYPE.FIXED_BOX:return this.fixedBoxCollision
(t,n);case e.COLLISION_TYPE.CIRCLES:return this.circleCollision(t,n);case e.COLLISION_TYPE.ORIENTED_BOX:return this.orientedBoxCollision(t,n)}return null}if(!t.type||!n.type){var r=t,i=n;n.type||(r=n,i=t);switch(i.type){case e.COLLISION_TYPE.CIRCLE:return this.pointCircleCollision(r,i);case e.COLLISION_TYPE.FIXED_BOX:return this.pointFixedBoxCollision(r,i)}return null}return n.type==e.COLLISION_TYPE.ORIENTED_BOX&&t.type==e.COLLISION_TYPE.FIXED_BOX?this.fixedBoxWithOrientedBoxCollision(t,n):n.type==e.COLLISION_TYPE.FIXED_BOX&&t.type==e.COLLISION_TYPE.ORIENTED_BOX?this.fixedBoxWithOrientedBoxCollision(n,t):n.type==e.COLLISION_TYPE.CIRCLE&&t.type==e.COLLISION_TYPE.ORIENTED_BOX?this.orientedBoxWithCircleCollision(t,n):n.type==e.COLLISION_TYPE.ORIENTED_BOX&&t.type==e.COLLISION_TYPE.CIRCLE?this.orientedBoxWithCircleCollision(n,t):n.type==e.COLLISION_TYPE.CIRCLE&&t.type==e.COLLISION_TYPE.FIXED_BOX?this.fixedBoxWithCircleCollision(t,n):n.type==e.COLLISION_TYPE.FIXED_BOX&&t.type==e.COLLISION_TYPE
.CIRCLE?this.fixedBoxWithCircleCollision(n,t):null}};return e.debug.log("CollisionSystem loaded",3),t}),define("DE.Collider",["DE.Vector2","DE.CONFIG"],function(e,t){function n(t){t=t||{},this.type=t.type||undefined,this.gameObject=t.gameObject||undefined,this.localPosition=t.localPosition||new e(t.offsetX||t.offsetLeft||0,t.offsetY||t.offsetTop||0),this.isColliding=!1,this.isTrigger=t.isTrigger||!1,this.collideWith=new Array,this.getRealPosition=function(){var e=this.gameObject.getPos();return e.x+=this.localPosition.x,e.y+=this.localPosition.y,e},this.debugRender=function(e,t,n){if(!this.debugBuffer)return;e.drawImage(this.debugBuffer.canvas,this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.debugBuffer.canvas.width*t*n>>0,this.debugBuffer.canvas.height*t*n>>0)}}return n.prototype.DEName="Collider",t.debug.log("Collider loaded",3),n}),define("DE.Renderer",["DE.COLORS","DE.Vector2","DE.CONFIG"],function(e,t,n){function r(n){n=n||{},this.gameObject=n.gameObject||undefined,this
.alpha=n.alpha||1,this.fillColor=n.fillColor||e.defaultColor,this.strokeColor=n.strokeColor||e.defaultColor,this.method=n.method||"fill",this.localPosition=n.localPosition||new t(n.offsetx||n.offsetX||n.left||n.x||n.offsetLeft||0,n.offsety||n.offsetY||n.top||n.y||n.offsetTop||0),this.setScale=function(e,t){if(!this.sizes)return;t=t||e,this.localPosition.x+=this.sizes.width*this.sizes.scaleX*.5>>0,this.localPosition.y+=this.sizes.height*this.sizes.scaleY*.5>>0,this.sizes.setScale(e,t),this.localPosition.x-=this.sizes.width*this.sizes.scaleX*.5>>0,this.localPosition.y-=this.sizes.height*this.sizes.scaleY*.5>>0},this.scale=function(e,t){if(!this.sizes)return;this.setScale(this.sizes.scaleX+(e||0),this.sizes.scaleY+(t||0))}}return r.prototype={constructor:r,translate:function(e){this.localPosition.translate(e,!0,!0)},translateX:function(e){this.translate({x:e,y:0})},translateY:function(e){this.translate({x:0,y:e})}},r.prototype.render=function(e,t,n){},r.prototype.DEName="Renderer",n.debug.
log("Renderer loaded",3),r}),define("DE.GameObject.render",["DE.CONFIG","DE.COLORS","DE.Time"],function(e,t,n){function r(n,r,i,s,o){if(!this.enable)return;r=r||1,i=i||1,s=s||{x:0,y:0},o=o||{width:0,height:0};if(this.renderers.length==0&&this.childrens.length==0&&!e.DEBUG)return;this.parent?n.translate((this.position.x-s.x)*r*i>>0,(this.position.y-s.y)*r*i>>0):n.translate((this.position.x-s.x)*r>>0,(this.position.y-s.y)*r>>0),n.rotate(this.position.rotation);for(var u=0,a;a=this.renderers[u];u++)a.render(n,r,i);e.DEBUG_LEVEL>1&&(n.fillStyle=t.DEBUG.GAME_OBJECT,n.fillRect(0,0,1,1),n.fillStyle=t.DEBUG.X_AXIS,n.fillRect(0,0,20,2),n.fillStyle=t.DEBUG.Y_AXIS,n.fillRect(0,0,2,20),this.collider!==null&&this.collider.debugRender(n,r,i));for(var u=0,f;f=this.childrens[u];u++)f.render(n,r,i);n.rotate(-this.position.rotation),this.parent?n.translate(-(this.position.x-s.x)*r*i>>0,-(this.position.y-s.y)*r*i>>0):n.translate(-(this.position.x-s.x)*r>>0,-(this.position.y-s.y)*r>>0)}return e.debug.log("GameObject.render loaded"
,3),r}),define("DE.GameObject.update",["DE.CollisionSystem","DE.CONFIG","DE.Time"],function(e,t,n){function r(e){if(!this.enable)return;for(var t in this.automatism){var r=this.automatism[t];if(r.interval&&e-r.lastCall<r.interval/n.scaleDelta)continue;r.lastCall=e,this[r.methodName](r.value1,r.value2),r.persistent||delete this.automatism[t]}for(var i=0;child=this.childrens[i];i++)child.update(e);if(!this.isMoved||!this.collider)return}return t.debug.log("GameObject.update loaded",3),r}),define("DE.GameObject",["DE.Vector2","DE.GameObject.render","DE.GameObject.update","DE.CONFIG","DE.Sizes","DE.Event"],function(e,t,n,r,i,s){function o(t){t=t||{},this.id=t.id||Math.random()*999999999>>0,this.name=t.name!=undefined?t.name:"noname",this.tag=t.tag||"none",this.enable=!0,this.scene=null,this.killArgs={},this.sceneIndex=0,this.parent=t.parent||undefined,this.zindex=t.zindex||0,this.childrens=t.childrens||new Array,this.position=t.position||new e(t.x||0,t.y||0,t.z||0),this.automatism={},this.flag=
null,this.indexMouseOver=[0,0,0,0,0,0,0,0,0,0,0,0],this.isMoved=!1,this.biggerOffset=new i(1,1,1,1),this.renderers=new Array;if(t.renderers&&t.renderers.length>0)for(var n=0,r;r=t.renderers[n];n++)r.gameObject=this,this.addRenderer(r);t.renderer&&(t.renderer.gameObject=this,this.addRenderer(t.renderer)),this.collider=t.collider||null,this.collider!==null&&(this.collider.gameObject=this),this.rigidbody=t.rigidbody||undefined,this.rigidbody&&this.rigidbody.gameObject!=this&&(this.rigidbody.gameObject=this),s.addEventComponents(this)}var u=Math.PI;return o.prototype={constructor:o},o.prototype.translate=function(e,t){this.moved(),t=t||!1,this.position.translate(e,t)},o.prototype.translateX=function(e,t){t=t||!1,this.translate({x:e,y:0},t)},o.prototype.translateY=function(e,t){t=t||!1,this.translate({x:0,y:e},t)},o.prototype.getPos=function(){if(this.parent){var e=this.parent.getPos(),t=this.parent.getHarmonics();return{x:-(-this.position.x*t.cos+this.position.y*t.sin)+e.x,y:-(-this.position
.x*t.sin+this.position.y*-t.cos)+e.y,z:this.position.z+e.z}}return{x:this.position.x,y:this.position.y,z:this.position.z}},o.prototype.getHarmonics=function(){return this.parent?this.position.getHarmonics(this.parent.getRotation()):this.position.getHarmonics()},o.prototype.getRotation=function(){return this.parent?(this.position.rotation+this.parent.getRotation())%(u*2):this.position.rotation%(u*2)},o.prototype.rotate=function(e){this.moved(),this.position.rotate(e)},o.prototype.lookAt=function(e){this.moved();if(this.parent){var t=this.getPos();this.position.setRotation(-Math.atan2(e.x-t.x,e.y-t.y)-this.parent.getRotation());return}this.position.setRotation(-Math.atan2(e.x-this.position.x,e.y-this.position.y)+u)},o.prototype.add=function(e){if(!(e instanceof o))throw new Error("DREAM_ENGINE.GameObject.add: this not inherit from GameObject, do it well please");e.parent!==undefined&&e.parent.remove(e),e.parent=this,this.childrens.push(e);if(e.renderers.length>0){var t=e.position.x,n=e.position
.y;for(var r=0,i;i=e.renderers[r];r++)i.sizes?(t+i.sizes.width>this.biggerOffset.width?this.biggerOffset.width=t+i.sizes.width:t-i.sizes.width>this.biggerOffset.width&&(this.biggerOffset.width=t-i.sizes.width),n+i.sizes.height>this.biggerOffset.height?this.biggerOffset.height=n+i.sizes.height:n-i.sizes.height>this.biggerOffset.height&&(this.biggerOffset.height=n-i.sizes.height)):i.radius&&(t+i.radius>this.biggerOffset.width?this.biggerOffset.width=t+i.radius:t-i.radius>this.biggerOffset.width&&(this.biggerOffset.width=t-i.radius),n+i.radius>this.biggerOffset.height?this.biggerOffset.height=n+i.radius:n-i.radius>this.biggerOffset.height&&(this.biggerOffset.height=n-i.radius))}},o.prototype.remove=function(e){var t=this.childrens.indexOf(e);t!==-1&&(e.parent=undefined,this.childrens.splice(t,1))},o.prototype.getChildByName=function(e,t){var n,r;for(n=0;r=this.childrens[n];n++){if(r.name===e)return r;if(t){r=r.getChildByName(e,t);if(r!==undefined)return r}}return undefined},o.prototype.bindGlobalEvent=
function(e,t){if(!this.scene){console.log("%cCall bindGlobalEvent without adding the object in a scene","color:red");return}this.scene["on"+(t?"Last":"")+"GlobalMouse"+e][this.id]=this},o.prototype.sortChildrens=function(){this.childrens.sort(function(e,t){return t.position.z==e.position.z?e.zindex-t.zindex:t.position.z-e.position.z})},o.prototype.addRenderer=function(e){return e.gameObject=this,this.renderers.push(e),e.sizes?(e.sizes.width>this.biggerOffset.width&&(this.biggerOffset.width=e.sizes.width),e.sizes.height>this.biggerOffset.height&&(this.biggerOffset.height=e.sizes.height)):e.radius&&(e.radius>this.biggerOffset.width&&(this.biggerOffset.width=e.radius),e.radius>this.biggerOffset.height&&(this.biggerOffset.height=e.radius)),this},o.prototype.moved=function(){var e=this;while(e.parent!==undefined)e=e.parent;return e.isMoved=!0,this},o.prototype.delete=function(e){if(this.childrens[e]){this.childrens[e].killMePlease(),delete this.childrens[e],this.childrens.splice(e,1);return}
var t=this.childrens.indexOf(e);if(t!==-1){e.killMePlease(),this.childrens[t]=null,this.childrens.splice(t,1);return}},o.prototype.onMouseDown=undefined,o.prototype.onMouseMove=undefined,o.prototype.onMouseEnter=undefined,o.prototype.onMouseLeave=undefined,o.prototype.onMouseClick=undefined,o.prototype.onMouseUp=undefined,o.prototype.askToKill=function(e){this.scene.cleanObjectBinding(this),this.enable=!1,this.flag="delete",this.killArgs=e||{},!this.killArgs.preventEvents&&!this.killArgs.preventKillEvent&&(this.onKill&&this.onKill(),this.trigger("kill",this))},o.prototype.onKill=undefined,o.prototype.onKilled=undefined,o.prototype.killMePlease=function(){!this.killArgs.preventEvents&&!this.killArgs.preventKilledEvent&&(this.onKilled&&this.onKilled(),this.trigger("killed",this));for(var e=0;e<this.renderers.length;++e)delete this.renderers[e],this.renderers.splice(e,1);delete this.collider;for(e=0;e<this.childrens.length;++e)this.childrens[e].killMePlease(),delete this.childrens[e],this.
childrens.splice(e,1)},o.prototype.render=t,o.prototype.update=n,o.prototype.addAutomatism=function(e,t,n){n=n||{};if(t.type)throw new Error("You use the old way to call addAutomatism, check the doc please");if(!this[t])return r.debug.log("%cCouldn't found the method "+t+" in your GameObject prototype",1,"color:red"),!1;n.interval&&(n.lastCall=Date.now()),n.methodName=t,n.value1=n.value1||undefined,n.value2=n.value2||undefined,n.persistent=n.persistent!=0?!0:!1,this.automatism[e]=n},o.prototype.removeAutomatism=function(e){if(!this.automatism[e]){r.debug.log("%c[RemoveAutomatism] Automatism "+e+" not found",1,"color:orange");return}delete this.automatism[e]},o.prototype.removeAutomatisms=function(){for(var e in this.automatism)delete this.automatism[e]},s.addEventCapabilities(o),o.prototype.DEName="GameObject",r.debug.log("GameObject loaded",3),o}),define("DE.Notifications",[],function(){var e=new function(){this.DEName="Notifications",this.notifs={},this.notifsHeight=0,this.selector="notifsContainer"
,this.container=null,this.templateName="notificationTemplate",this.template=null,this.defaultExpirationTime=3500,this.closeAnimationDuration=400,this.notificationClassName="notification",this.inited=!1;var e=this;this.init=function(e){e=e||{},this.selector=e.selector||this.selector,this.templateName=e.templateName||this.templateName,this.closeAnimationDuration=e.closeAnimationDuration||this.closeAnimationDuration,this.notificationClassName=e.notificationClassName||this.notificationClassName,this.container=e.container||document.getElementById(this.selector);var t=document.getElementById(this.templateName);this.template=e.template||t?t.innerHTML:null;if(!this.container||!this.template)throw new Error("Can't init Notifications without a container element AND a template -- container selector:: "+this.selector+" -- templateName:: "+this.templateName);this.inited=!0,this.notifsHeight=this.container.offsetHeight||0,t&&document.body.removeChild(t)},this.create=function(t,n){if(!this.inited){console
.log("You don't init Notifications, init it before call it");return}this.notifsHeight=this.notifsHeight<0?0:this.notifsHeight;var r=n||this.defaultExpirationTime,i=Date.now()+"-"+(Math.random()*100>>0),s=document.createElement("div");s.className=this.notificationClassName,s.innerHTML=this.template,s.getElementsByClassName("content")[0].innerHTML=t,s.id="notif"+i,this.container.appendChild(s),this.notifs[i]=s,this.notifs[i].getElementsByClassName("notifClose")[0].addEventListener("click",function(){e.remove(i)});var o=this.notifs[i].offsetHeight;this.notifsHeight+=o,this.container.style.height=this.notifsHeight+"px",this.bindRemove(i,r)},this.bindRemove=function(t,n){n=n||this.defaultExpirationTime,setTimeout(function(){e.triggerRemove(t)},n)},this.triggerRemove=function(t){if(!this.notifs[t])return;this.notifs[t].className=this.notifs[t].className+" disapear",setTimeout(function(){e.remove(t)},this.closeAnimationDuration)},this.remove=function(e){var t=this.notifs[e].offsetHeight;this.notifsHeight-=
t,this.container.style.height=this.notifsHeight+"px",this.container.removeChild(this.notifs[e]),delete this.notifs[e];return}};return e}),define("DE.LangSystem",["DE.CONFIG"],function(e){var t=new function(){this.DEName="LangSystem",this.currentLang="en",this.dictionary={},this.avalaibleLang=new Array,this.init=function(e){for(var t in e)this.dictionary[t]=e[t],this.avalaibleLang.push(t)},this.get=function(e){return this.dictionary[this.currentLang][e]||null},this.forceGet=function(e,t){return this.avalaibleLang.indexOf(e)==-1?null:this.dictionary[e][t]||null},this.getLang=function(e){this.currentLang=this.avalaibleLang[0],e||(e=navigator.language||navigator.browserLanguage||"en");for(var t in this.dictionary)if(e.match(t)){this.currentLang=t;break}}};return e.debug.log("LangSystem loaded",3),t}),define("DE.GamePad",["DE.CONFIG","DE.Event","DE.Notifications","DE.LangSystem"],function(e,t,n,r){var i=t.addEventCapabilities,s=function(e){var t=function(){if(/Firefox[\/\s](\d+\.\d+)/.test(navigator
.userAgent)){var e=new Number(RegExp.$1);return e}return!1},n=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("chrome")>-1&&e.indexOf("android")==-1&&e.indexOf("iphone")==-1&&e.indexOf("ipad")==-1&&e.indexOf("ipod")==-1},r={firefox:t,chrome:n};return r[e]()},o={},u=new function(){function u(e){l[e.gamepad.index]=e.gamepad,l.length++}this.DEName="GamePad";var a={},f={},l={};this.gamePadsInfos={};var c={},h=function(){},p=function(){};this.init=function(){s("chrome")?(e.notifications.gamepadEnable&&n.create(r.get("gamepadAvalaible")||e.notifications.gamepadAvalaible),h=function(e){var t=navigator.webkitGetGamepads&&navigator.webkitGetGamepads()||[];for(var n=0;n<t.length;++n)if(t[n]){if(!c[n]||c[n]!=t[n].timestamp)c[n]=t[n].timestamp,this.handleGamePad(t[n],e)}else this.disconnectGamePad(n)},p=function(e){var t=navigator.webkitGetGamepads&&navigator.webkitGetGamepads()||[];for(var n=0;n<t.length;++n){var r=t[n];if(r){this.handleGamePad(r,e);continue}this.disconnectGamePad
(n)}},this.updateByChange()):s("firefox")};var d=function(e){var t=["leftThumbX","leftThumbY","rightThumbX","rightThumbY"],n=["a","b","y","x","left_shoulder","right_shoulder","LeftTrigger","RightTrigger","back","start","left_thumb","right_thumb","dpad_up","dpad_down","dpad_left","dpad_right"],r={};r.index=e.controllerId,r.timestamp=e.packetNumber,r.buttons=[],r.axes=[];for(var i=0;i<n.length;++i){var s=n[i];if(s=="LeftTrigger"||s=="RightTrigger"){r.buttons[i]=e[s]/255;continue}if(e[s]){r.buttons[i]=1;continue}r.buttons[i]=0}for(var i=0;i<t.length;++i){var s=t[i];r.axes[i]=e[s]/32767;if(s=="leftThumbY"||s=="rightThumbY")r.axes[i]*=-1}return r};this.windowsControllers=[],this.adaptToWindowsLib=function(e,t){var n=t||4;e||console.error("gamepad::adaptToWindowsLib - windowsGamepadLib is null");for(var r=0;r<n;++r)this.windowsControllers[r]=new e.Controller(r);h=function(e){var t=this.windowsControllers;for(var n=0;n<t.length;++n){var r=t[n];if(r){r=r.getState();if(r.connected){if(!c[n]||c[n
]!=r.packetNumber){c[n]=r.packetNumber;var i=d(r);this.handleGamePad(i,e)}continue}this.disconnectGamePad(n)}}},p=function(e){var t=this.windowsControllers;for(var n=0;n<t.length;++n){var r=t[n];if(r){r=r.getState();if(r.connected){var i=d(r);this.handleGamePad(i,e);continue}this.disconnectGamePad(n)}}},this.update=p,this.handleDown=w},window.addEventListener("MozGamepadConnected",u,!1),this.connectToGameLoop=function(e){e.addNonStop("gamePad",this)},this.handleGamePad=function(i,s){var u=i.index;this.gamePadsInfos[u]=i,a[u]&&this.handleListeners(u,i.buttons,a,s),f[u]&&this.handleListeners(u,i.axes,f,s),o[u]||(e.debug.log("Gamepad connected "+u,2),e.notifications.gamepadChange&&(this.isGamepadConnected=!0,n.create(r.get("onGamepadConnect")||"Gamepad "+(u+1)+" connected")),t.emit("connectGamepad",u),o[u]=!0)},this.disconnectGamePad=function(i){c[i]=null,l[i]=null,this.gamePadsInfos[i]=null;if(o[i]){e.debug.log("Disconnect gamepad "+i,2);if(e.notifications.gamepadChange){this.isGamepadConnected=!1
;for(var s in o)if(o[s]){this.isGamepadConnected=!0;break}n.create(r.get("onGamepadDisconnect")||"Gamepad "+(i+1)+" disconnected")}t.emit("disconnectGamepad",i),o[i]=!1}};var v=.5,m=function(e){return e<-v&&e<0||e>v&&e>0?!0:!1},g=function(e,t,n,r){m(r)&&!n.active&&(t.emit("down"+e,r,e),n.active=!0)},y=500,b=150,w=function(e,t,n,r,i){if(m(r)){if(!n.active)return t.emit("down"+e,r,e),n.active=!0,n.timesTamp=i,n.diffTime=y,!0;if(n.noRate)return!0;if(n.timesTamp+n.diffTime<i)return t.emit("down"+e,r,e),n.timesTamp=i,n.diffTime=b,!0}return!1},E=function(e,t,n,r){for(var i in n[e].listeners){var s=t[i],o=n[e],u=n[e].listeners[i];if(s<.3&&s>0||s>-0.3&&s<0)s=0;s!=u.force&&o.emit("move"+i,s,i),u.force=s;if(this.handleDown(i,o,u,s,r))continue;!m(s)&&u.active&&(o.emit("up"+i,s,i),u.active=!1,u.count=0)}};this.handleListeners=E,this.handleGamePadAxes=function(e){for(var t in f[e.index].listeners)if(e.axes[t]>0&&!f[e.index].listeners[t]){a[e.index].emit("down"+t),a[e.index].listeners[t]=!0;continue}
};var S=function(e,t,n){e[t]||(e[t]={},e[t].listeners={},i(e[t])),typeof e[t].listeners[n]=="undefined"&&(e[t].listeners[n]={active:!0,force:0})},x=function(e,t,n,r,i,s){S(e,t,n),e[t].on(r+n,i),e[t].listeners[n].noRate=s},T=function(e,t,n,r){e[t]&&e[t].del(r+n)},N=function(e,t,n){if(!e[t])return;T(e,t,n,"down"),T(e,t,n,"up"),T(e,t,n,"move"),delete e[t].listeners[n]},C=function(e,t){if(!e[t])return;for(var n in e[t].listeners)N(e,t,n)},k=function(e){if(!e)return;for(var t in e)C(e,t)};this.onBtnDown=function(e,t,n,r){x(a,e,t,"down",n,r)},this.onBtnMove=function(e,t,n,r){x(a,e,t,"move",n,r)},this.onBtnUp=function(e,t,n,r){x(a,e,t,"up",n,r)},this.delBtnDown=function(e,t){T(a,e,t,"down")},this.delBtnMove=function(e,t){T(a,e,t,"move")},this.delBtnUp=function(e,t){T(a,e,t,"up")},this.delBtn=function(e,t){N(a,e,t)},this.delBtnsPad=function(e){C(a,e)},this.delBtnsListeners=function(){k(a)},this.onAxeStart=function(e,t,n,r){x(f,e,t,"down",n,r)},this.onAxeMove=function(e,t,n,r){x(f,e,t,"move",n,r
)},this.onAxeStop=function(e,t,n,r){x(f,e,t,"up",n,r)},this.delAxeStart=function(e,t){T(f,e,t,"down")},this.delAxeMove=function(e,t){T(f,e,t,"move")},this.delAxeStop=function(e,t){T(f,e,t,"up")},this.delAxe=function(e,t){N(f,e,t)},this.delAxesPad=function(e){C(f,e)},this.delAxesListeners=function(){k(f)},this.delListeners=function(){k(f),k(a)},this.plugBtnToInput=function(e,t,n,r){this.onBtnDown(n,r,function(n){e.usedInputs[t].isDown=!0,e.trigger("keyDown",t,n)},!1),this.onBtnUp(n,r,function(n){e.usedInputs[t].isDown=!1,e.trigger("keyUp",t,n)},!1),this.onBtnMove(n,r,function(n){e.trigger("btnMoved",t,n)},!1)},this.plugAxeToInput=function(e,t,n,r){this.onAxeStart(n,r,function(n){e.trigger("axeStart",t,n)},!1),this.onAxeStop(n,r,function(n){e.trigger("axeStop",t,n)},!1),this.onAxeMove(n,r,function(n){e.trigger("axeMoved",t,n)},!1)},this.updateByRate=function(){this.update=p,this.handleDown=w},this.updateByChange=function(){this.update=h,this.handleDown=g},this.update=function(){}};return e
.debug.log("gamepad loaded",3),u}),define("handjs",[],function(){function e(){C=!0,clearTimeout(k),k=setTimeout(function(){C=!1},700)}function t(e){var t=[];if(e){t.unshift(e);while(e.parentNode)t.unshift(e.parentNode),e=e.parentNode}return t}function n(e,n){var r=t(e),i=t(n),s=null;while(r.length>0&&r[0]==i.shift())s=r.shift();return s}function r(e,t,r){var i=n(e,t),s=e,o=[];while(s&&s!=i)g(s,"pointerenter")&&o.push(s),s=s.parentNode;while(o.length>0)r(o.pop())}function i(e,t,r){var i=n(e,t),s=e;while(s&&s!=i)g(s,"pointerleave")&&r(s),s=s.parentNode}function s(e,t){["pointerdown","pointermove","pointerup","pointerover","pointerout"].forEach(function(n){window.addEventListener(e(n),function(e){!C&&y(e.target,n)&&t(e,n,!0)})}),window["on"+e("pointerenter").toLowerCase()]===undefined&&window.addEventListener(e("pointerover"),function(e){if(C)return;var n=y(e.target,"pointerenter");if(!n||n===window)return;n.contains(e.relatedTarget)||r(n,e.relatedTarget,function(n){t(e,"pointerenter",!1,n
,e.relatedTarget)})}),window["on"+e("pointerleave").toLowerCase()]===undefined&&window.addEventListener(e("pointerout"),function(e){if(C)return;var n=y(e.target,"pointerleave");if(!n||n===window)return;n.contains(e.relatedTarget)||i(n,e.relatedTarget,function(n){t(e,"pointerleave",!1,n,e.relatedTarget)})})}var o=o||{};if(window.PointerEvent)return;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>0&&(r=Number(arguments[1]),r!=r?r=0:r!=0&&r!=Infinity&&r!=-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){if(!this||!(e instanceof Function))throw new TypeError;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")});var u=["pointerdown","pointerup"
,"pointermove","pointerover","pointerout","pointercancel","pointerenter","pointerleave"],a=["PointerDown","PointerUp","PointerMove","PointerOver","PointerOut","PointerCancel","PointerEnter","PointerLeave"],f="touch",l="pen",c="mouse",h={},p=function(e){while(e&&!e.handjs_forcePreventDefault)e=e.parentNode;return!!e||window.handjs_forcePreventDefault},d=function(e,t,n,r,i){var s;document.createEvent?(s=document.createEvent("MouseEvents"),s.initMouseEvent(t,n,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,i||e.relatedTarget)):(s=document.createEventObject(),s.screenX=e.screenX,s.screenY=e.screenY,s.clientX=e.clientX,s.clientY=e.clientY,s.ctrlKey=e.ctrlKey,s.altKey=e.altKey,s.shiftKey=e.shiftKey,s.metaKey=e.metaKey,s.button=e.button,s.relatedTarget=i||e.relatedTarget),s.offsetX===undefined&&(e.offsetX!==undefined?(Object&&Object.defineProperty!==undefined&&(Object.defineProperty(s,"offsetX",{writable:!0}),Object.defineProperty(s,"offsetY"
,{writable:!0})),s.offsetX=e.offsetX,s.offsetY=e.offsetY):Object&&Object.defineProperty!==undefined?(Object.defineProperty(s,"offsetX",{get:function(){return this.currentTarget&&this.currentTarget.offsetLeft?e.clientX-this.currentTarget.offsetLeft:e.clientX}}),Object.defineProperty(s,"offsetY",{get:function(){return this.currentTarget&&this.currentTarget.offsetTop?e.clientY-this.currentTarget.offsetTop:e.clientY}})):e.layerX!==undefined&&(s.offsetX=e.layerX-e.currentTarget.offsetLeft,s.offsetY=e.layerY-e.currentTarget.offsetTop)),e.isPrimary!==undefined?s.isPrimary=e.isPrimary:s.isPrimary=!0;if(e.pressure)s.pressure=e.pressure;else{var o=0;e.which!==undefined?o=e.which:e.button!==undefined&&(o=e.button),s.pressure=o==0?0:.5}e.rotation?s.rotation=e.rotation:s.rotation=0,e.hwTimestamp?s.hwTimestamp=e.hwTimestamp:s.hwTimestamp=0,e.tiltX?s.tiltX=e.tiltX:s.tiltX=0,e.tiltY?s.tiltY=e.tiltY:s.tiltY=0,e.height?s.height=e.height:s.height=0,e.width?s.width=e.width:s.width=0,s.preventDefault=function(
){e.preventDefault!==undefined&&e.preventDefault()};if(s.stopPropagation!==undefined){var u=s.stopPropagation;s.stopPropagation=function(){e.stopPropagation!==undefined&&e.stopPropagation(),u.call(this)}}s.pointerId=e.pointerId,s.pointerType=e.pointerType;switch(s.pointerType){case 2:s.pointerType=f;break;case 3:s.pointerType=l;break;case 4:s.pointerType=c}r?r.dispatchEvent(s):e.target?e.target.dispatchEvent(s):e.srcElement.fireEvent("on"+w(t),s)},v=function(e,t,n,r,i){e.pointerId=1,e.pointerType=c,d(e,t,n,r,i)},m=function(e,t,n,r,i,s){var o=t.identifier+2;t.pointerId=o,t.pointerType=f,t.currentTarget=n,r.preventDefault!==undefined&&(t.preventDefault=function(){r.preventDefault()}),d(t,e,i,n,s)},g=function(e,t){return e.__handjsGlobalRegisteredEvents&&e.__handjsGlobalRegisteredEvents[t]},y=function(e,t){while(e&&!g(e,t))e=e.parentNode;if(e)return e;if(g(window,t))return window},b=function(e,t,n,r,i,s){y(n,e)&&m(e,t,n,r,i,s)},w=function(e){return e.toLowerCase().replace("pointer","mouse"
)},E=function(e,t){var n=u.indexOf(t),r=e+a[n];return r},S=function(e,t,n,r){e.__handjsRegisteredEvents===undefined&&(e.__handjsRegisteredEvents=[]);if(r){if(e.__handjsRegisteredEvents[t]!==undefined){e.__handjsRegisteredEvents[t]++;return}e.__handjsRegisteredEvents[t]=1,e.addEventListener(t,n,!1)}else{if(e.__handjsRegisteredEvents.indexOf(t)!==-1){e.__handjsRegisteredEvents[t]--;if(e.__handjsRegisteredEvents[t]!=0)return}e.removeEventListener(t,n),e.__handjsRegisteredEvents[t]=0}},x=function(e,t,n){e.__handjsGlobalRegisteredEvents||(e.__handjsGlobalRegisteredEvents=[]);if(n){if(e.__handjsGlobalRegisteredEvents[t]!==undefined){e.__handjsGlobalRegisteredEvents[t]++;return}e.__handjsGlobalRegisteredEvents[t]=1}else e.__handjsGlobalRegisteredEvents[t]!==undefined&&(e.__handjsGlobalRegisteredEvents[t]--,e.__handjsGlobalRegisteredEvents[t]<0&&(e.__handjsGlobalRegisteredEvents[t]=0));var r,i;window.MSPointerEvent?(r=function(e){return E("MS",e)},i=d):(r=w,i=v);switch(t){case"pointerenter":case"pointerleave"
:var s=r(t);e["on"+s.toLowerCase()]!==undefined&&S(e,s,function(e){i(e,t)},n)}},T=function(e){var t=e.prototype?e.prototype.addEventListener:e.addEventListener,n=function(e,n,r){u.indexOf(e)!=-1&&x(this,e,!0),t===undefined?this.attachEvent("on"+w(e),n):t.call(this,e,n,r)};e.prototype?e.prototype.addEventListener=n:e.addEventListener=n},N=function(e){var t=e.prototype?e.prototype.removeEventListener:e.removeEventListener,n=function(e,n,r){u.indexOf(e)!=-1&&x(this,e,!1),t===undefined?this.detachEvent(w(e),n):t.call(this,e,n,r)};e.prototype?e.prototype.removeEventListener=n:e.removeEventListener=n};T(window),T(window.HTMLElement||window.Element),T(document),T(HTMLBodyElement),T(HTMLDivElement),T(HTMLImageElement),T(HTMLUListElement),T(HTMLAnchorElement),T(HTMLLIElement),T(HTMLTableElement),window.HTMLSpanElement&&T(HTMLSpanElement),window.HTMLCanvasElement&&T(HTMLCanvasElement),window.SVGElement&&T(SVGElement),N(window),N(window.HTMLElement||window.Element),N(document),N(HTMLBodyElement),N
(HTMLDivElement),N(HTMLImageElement),N(HTMLUListElement),N(HTMLAnchorElement),N(HTMLLIElement),N(HTMLTableElement),window.HTMLSpanElement&&N(HTMLSpanElement),window.HTMLCanvasElement&&N(HTMLCanvasElement),window.SVGElement&&N(SVGElement);var C=!1,k=-1;return function(){window.MSPointerEvent?s(function(e){return E("MS",e)},d):(s(w,v),window.ontouchstart!==undefined&&(window.addEventListener("touchstart",function(t){for(var n=0;n<t.changedTouches.length;++n){var i=t.changedTouches[n];h[i.identifier]=i.target,b("pointerover",i,i.target,t,!0),r(i.target,null,function(e){m("pointerenter",i,e,t,!1)}),b("pointerdown",i,i.target,t,!0)}e()}),window.addEventListener("touchend",function(t){for(var n=0;n<t.changedTouches.length;++n){var r=t.changedTouches[n],s=h[r.identifier];b("pointerup",r,s,t,!0),b("pointerout",r,s,t,!0),i(s,null,function(e){m("pointerleave",r,e,t,!1)})}e()}),window.addEventListener("touchmove",function(t){for(var n=0;n<t.changedTouches.length;++n){var s=t.changedTouches[n],o=document
.elementFromPoint(s.clientX,s.clientY),u=h[s.identifier];u&&p(u)===!0&&t.preventDefault(),b("pointermove",s,u,t,!0);if(u===o)continue;u&&(b("pointerout",s,u,t,!0,o),u.contains(o)||i(u,o,function(e){m("pointerleave",s,e,t,!1,o)})),o&&(b("pointerover",s,o,t,!0,u),o.contains(u)||r(o,u,function(e){m("pointerenter",s,e,t,!1,u)})),h[s.identifier]=o}e()}),window.addEventListener("touchcancel",function(e){for(var t=0;t<e.changedTouches.length;++t){var n=e.changedTouches[t];b("pointercancel",n,h[n.identifier],e,!0)}})))}(),navigator.pointerEnabled===undefined&&(navigator.pointerEnabled=!0,navigator.msPointerEnabled&&(navigator.maxTouchPoints=navigator.msMaxTouchPoints)),document.styleSheets&&document.addEventListener&&document.addEventListener("DOMContentLoaded",function(){if(o.doNotProcessCSS||document.body.style.touchAction!==undefined)return;var e=new RegExp(".+?{.*?}","m"),t=new RegExp(".+?{","m"),n=function(n){var r=e.exec(n);if(!r)return;var i=r[0];n=n.replace(i,"").trim();var s=t.exec(i)[0
].replace("{","").trim();if(i.replace(/\s/g,"").indexOf("touch-action:none")!=-1){var o=document.querySelectorAll(s);for(var u=0;u<o.length;u++){var a=o[u];a.style.msTouchAction!==undefined?a.style.msTouchAction="none":a.handjs_forcePreventDefault=!0}}return n},r=function(e){if(window.setImmediate)e&&setImmediate(r,n(e));else while(e)e=n(e)};try{for(var i=0;i<document.styleSheets.length;i++){var s=document.styleSheets[i];if(s.href==undefined)continue;var u=new XMLHttpRequest;u.open("get",s.href),u.send();var a=u.responseText.replace(/(\n|\r)/g,"");r(a)}}catch(f){}var l=document.getElementsByTagName("style");for(var i=0;i<l.length;i++){var c=l[i],h=c.innerHTML.replace(/(\n|\r)/g,"").trim();r(h)}},!1),""}),define("DE.Inputs",["DE.CONFIG","DE.GamePad","handjs"],function(e,t){var n=new function(){function r(e){return e.pointerId=e.pointerId||0,n.mouse[e.pointerId]||(n.mouse[e.pointerId]={isDown:!1,x:0,y:0,index:e.pointerId}),n.mouse[e.pointerId].isDown=!0,n.mouse[e.pointerId].x=e.clientX,n.
mouse[e.pointerId].y=e.clientY,n.mouse[e.pointerId]}this.DEName="Inputs",this.isListening=!1,this.usedInputs={};var i={};this.keyLocked=!1,this.mouse=[{x:0,y:0,isDown:!1,index:0}],this.dbInputs={MOUSE:{leftClick:1000000001,rightClick:1000000002,wheelTop:1000000003,wheelDown:1000000004},KEYBOARD:{up:38,down:40,left:37,right:39,space:32,shift:16,caps:20,tab:9,escape:27,d:68,q:81,z:90,s:83,a:65,e:69,r:82,t:84,y:89,u:85,i:73,o:79,p:80,f:70,g:71,h:72,j:74,k:75,l:76,m:77,w:87,x:88,c:67,v:86,b:66,n:78,enter:13,"return":8,"PAD+":107,"PAD-":109,"PAD*":106,"PAD/":111,PAD0:96,PAD1:97,PAD2:98,PAD3:99,PAD4:100,PAD5:101,PAD6:102,PAD7:103,PAD8:104,PAD9:105},GAMEPADBUTTONS:{A:0,B:1,Y:3,X:2,"D-Up":12,"D-Right":15,"D-Left":14,"D-Bot":13,select:8,start:9,RBS:7,RTS:5,LBS:6,LTS:4,power:16},GAMEPADAXES:{LHorizontal:0,LVertical:1,RHorizontal:2,RVertical:3}},this.queue={keyDown:{},keyUp:{},mouseDown:{},mouseUp:{},btnMoved:{},axeMoved:{},axeStart:{},axeStop:{}},this.on=function(e,t,n){if(!this.queue[e][t]){console
.log("%cWARN:: Try to bind on a non existant input ::: "+e+" - "+t,"color:red");return}this.queue[e][t].push(n)},this.init=function(e){var n={};for(var r in e){n[r]={},n[r].inputs=new Array;for(var i=0,s;s=e[r].keycodes[i];i++){var o=s[0]=="K"||s[0]=="k"?"KEYBOARD":"MOUSE",u=s.split("."),a=0,f;u[0][0]=="G"?(u[0][1]&&(a=parseInt(u[0][1])),u[1]=="A"?o="GAMEPADAXES":o="GAMEPADBUTTONS",f=u[2]):f=s.slice(2,s.length);if(typeof this.dbInputs[o][f]=="undefined"){console.log("%cAn input couldn't be found in the database, did you respect the caseSensitive ?:"+o+"."+f+"\n Ignoring it and continue...","color:red");continue}o=="GAMEPADBUTTONS"?t.plugBtnToInput(this,r,a,this.dbInputs[o][f]):o=="GAMEPADAXES"&&t.plugAxeToInput(this,r,a,this.dbInputs[o][f]),n[r].inputs.push({code:this.dbInputs[o][f],type:o})}n[r].interval=e[r].interval||0,n[r].lastCall=Date.now(),n[r].actions={},n[r].isDown=!1,n[r].isLongPress=e[r].isLongPress||!1,n[r].stayOn=e[r].stayOn||!1,n[r].numberCall=0,n[r].numberPress=0,n[r].stayOn&&
(n[r].lastCall=Date.now()+n[r].interval),this.queue.keyDown[r]=new Array,this.queue.keyUp[r]=new Array,this.queue.mouseDown[r]=new Array,this.queue.mouseUp[r]=new Array,this.queue.btnMoved[r]=new Array,this.queue.axeMoved[r]=new Array,this.queue.axeStart[r]=new Array,this.queue.axeStop[r]=new Array}this.usedInputs=n,this.toggleListeners()},this.get=function(e){return this.usedInputs[e]?this.usedInputs[e]:!1},this.trigger=function(e,t,r){if(n.keyLocked&&e.search("mouse")==-1)return;for(var i in n.queue[e][t])n.queue[e][t][i](r)},this.key=function(e){if(n.keyLocked)return;return this.usedInputs[e]&&this.usedInputs[e].isDown&&(!this.usedInputs[e].interval||Date.now()-this.usedInputs[e].lastCall>=this.usedInputs[e].interval)?(n.usedInputs[e].stayOn||(n.usedInputs[e].lastCall=Date.now()),n.usedInputs[e].numberCall++,!0):!1},this.toggleListeners=function(e,t){var r=e||window;this.isListening&&!t?r.removeEventListener?(r.removeEventListener("keydown",n.keyDown,!1),r.removeEventListener("keyup"
,n.keyUp,!1),r.removeEventListener("keypress",n.keyPress,!1)):r.detachEvent&&(r.detachEvent("onkeydown",n.keyDown),r.detachEvent("onkeyup",n.keyUp),r.detachEvent("onkeypress",n.keyPress)):r.addEventListener?(r.addEventListener("keydown",n.keyDown,!1),r.addEventListener("keyup",n.keyUp,!1),r.addEventListener("keypress",n.keyPress,!1)):r.attachEvent&&(r.attachEvent("onkeydown",n.keyDown),r.attachEvent("onkeyup",n.keyUp),r.attachEvent("onkeypress",n.keyPress))},this.findInput=function(e,t){for(var r in n.usedInputs)for(var i in n.usedInputs[r].inputs){var s=n.usedInputs[r].inputs[i].code,o=n.usedInputs[r].inputs[i].type;if(s==e&&o==t)return r}return!1},this.keyDown=function(e){if(n.keyLocked)return!1;var t=e||window.event,r=t.which||t.keyCode,i=n.findInput(r,"KEYBOARD");i!==!1&&(!n.usedInputs[i].isDown&&Date.now()-n.usedInputs[i].lastCall>=n.usedInputs[i].interval&&(n.usedInputs[i].isLongPress&&!n.usedInputs[i].stayOn&&(n.usedInputs[i].lastCall=Date.now()),n.usedInputs[i].isDown||n.trigger
("keyDown",i,1),n.usedInputs[i].isDown=!0),n.usedInputs[i].numberPress++)},this.keyUp=function(e){if(n.keyLocked)return!1;var t=e||window.event,r=t.which||t.keyCode,i=n.findInput(r,"KEYBOARD");i!==!1&&(n.usedInputs[i].isDown&&n.trigger("keyUp",i),n.usedInputs[i].stayOn&&(n.usedInputs[i].lastCall=Date.now()),n.usedInputs[i].isDown=!1)},this.keyPress=function(e){var t=e||window.event,r=t.which||t.keyCode,i=t.keyCode,s=n.findInput(i,"KEYBOARD");s!==!1&&n.usedInputs[s].isDown},this.mouseDown=function(e){i[e.target.id]&&i[e.target.id].oOnMouseDown(r(e));var t=n.findInput(1000000001,"MOUSE");return t!==!1&&(n.usedInputs[t].isDown||n.trigger("mouseDown",t),n.usedInputs[t].isDown=!0),!1},this.mouseUp=function(e){i[e.target.id]&&i[e.target.id].oOnMouseUp(r(e));var t=n.findInput(1000000001,"MOUSE");return t!==!1&&(n.usedInputs[t].isDown&&n.trigger("mouseUp",t),n.usedInputs[t].isDown=!1),e.preventDefault(),!1},this.mouseMove=function(e){return i[e.target.id]&&i[e.target.id].oOnMouseMove(r(e)),e.preventDefault
(),!1},this.mouseClick=function(e){},this.mouseDbClick=function(){},this.rightClick=function(e){e.preventDefault(),e.stopPropagation()},this.addEvent=function(e){},this.addActionInput=function(t,n,r){if(!this.checkInputExist(n))return;e.DEBUG&&e.DEBUG_LEVEL>=3&&this.usedInputs[n].actions[r]&&e.debug.log("Replace the action "+r+" on input "+n,3)},this.removeActionInput=function(t,n){if(!this.checkInputExist(t))return;if(!this.usedInputs[t].actions[n])throw new Error("Try to remove a not founded action by id:: "+n);e.debug.log("Remove the action "+n+" on input "+t,3),delete this.usedInputs[t].actions[n]},this.checkInputExist=function(t){return this.usedInputs[t]?!0:(e.debug.log("Try to access an input not defined:: "+t,1),!1)},this.addRender=function(e){i[e.id]=e;var t=e.canvas;t.addEventListener("pointerdown",n.mouseDown,!1),t.addEventListener("pointerup",n.mouseUp,!1),t.addEventListener("pointerout",n.mouseMove,!1),t.addEventListener("pointermove",n.mouseMove,!1),t.addEventListener("contextmenu"
,n.rightClick,!1),t.addEventListener("DOMMouseScroll",n.mouseWheel,!1),t.addEventListener("mousewheel",n.mouseWheel,!1),t.onmousewheel=n.mouseWheel,window.attachEvent&&t.attachEvent("onmousewheel",n.mouseWheel)},this.removeRender=function(t){if(!i[t].canvas){e.debug.log("[INPUTS] Try to remove a renders but not found :: "+t,1);return}i[t].canvas.removeEventListener("pointerdown",n.mouseDown,!1),i[t].canvas.removeEventListener("pointerup",n.mouseUp,!1),i[t].canvas.removeEventListener("pointerout",n.mouseUp,!1),i[t].canvas.removeEventListener("pointermove",n.mouseMove,!1),i[t].canvas.removeEventListener("contextmenu",n.rightClick,!1),i[t].canvas.removeEventListener("DOMMouseScroll",n.mouseWheel,!1),delete i[t]},this.mouseWheel=function(e){var t=e.wheelDelta>0?1:-1;e.detail&&(t=e.detail<0?1:-1),t==1?n.trigger("axeMoved","wheelTop"):n.trigger("axeMoved","wheelDown")}};return e.debug.log("Inputs loaded",3),n}),define("DE.SystemDetection",["DE.CONFIG","DE.LangSystem"],function(e,t){var n=new 
function(){this.DEName="SystemDetection",this.touchPlatform=!1,this.init=function(e){ua=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(ua)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i
.test(ua.substr(0,4)))this.touchPlatform=!0;if(e.touchPlatform||window.ENGINE_SETTING&&window.ENGINE_SETTING.touchPlatform)this.touchPlatform=!0;t.getLang()},this.render=null,this.scene=null,this.camera=null,this.isOverridingMainLoop=!1,this.askToRateIf="playedOnce",this.askToRate=function(){},this.initSystem=function(e,t){if(e)for(var n in e)this[n]=e[n];this.init(t)}};return e.debug.log("SystemDetection loaded",3),n}),define("stash",[],function(){function e(e,t){return t!==undefined&&t!==null&&t.constructor===e}function t(e){return"'"+String(e).replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")+"'"}function n(e){var t=l.createElement("_");return t.innerHTML=e,t.firstChild}function r(e){if(e.outerHTML)return e.outerHTML;var t=l.createElement("_");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function i(n){var i=arguments.callee,s=[],o,u=-1,f;if(e(String,n))return t(n);if(n===undefined||n===null||e(Boolean,n)||e(Number,n)||e(RegExp
,n)||e(Function,n)&&!/^function[^\{]+\{\s*\[native code\]/.test(String(n)))return String(n);if(e(Date,n))return"new Date("+n.getTime()+")";if(e(Array,n)){o=n.length;while(++u<o)s.push(i(n[u]));return"["+s+"]"}if(e(Object,n)){for(f in n)s.push(t(f)+":"+i(n[f]));return"{"+s+"}"}if(n===a)return"window";for(f in a)if(n===a[f])return"window."+f;for(f in l)if(n===l[f])return"document."+f;if(n.nodeName)return"h("+t(r(n))+")"}function s(e){return(new Function("var a=arguments;h=a[0];return "+e)).apply(a,[n])}function o(){var t={},n=arguments,r=n.length,i=-1,s;while(++i<r)if(e(Object,n[i]))for(s in n[i])t[s]=e(Object,t[s])&&e(Object,n[i][s])?n.callee(t[s],n[i][s]):n[i][s];return t}function u(t,n,r){var u=f[t],a;if(r){a=s(u);if(e(Array,a))n=a.concat(n);else if(e(Boolean,a))n=a&&!!n;else if(e(Date,a)&&!isNaN(n*1))n=new Date(a.getTime()+n*1);else if(e(Function,a)&&e(Function,n))n=new Function("return("+String(a)+").apply(this, arguments)&&("+String(n)+").apply(this, arguments)");else if(e(Number,a)&&!
isNaN(n*1))n=a+n*1;else if(e(Object,a)&&e(Object,n))n=o(a,n);else if(e(RegExp,a)&&e(RegExp,n)){var l=/^\/([\W\w]*)\/([a-z]*?)$/,c=String(a).match(l),h=String(n).match(l);n=new RegExp(c[1]+h[1],c[2]+h[2])}else{if(!e(String,a))return 2;n=a+String(n)}}return n=i(n),u===n?2:(f[t]=n)&&1}var a=window,f=window.document.localStorage||window.localStorage,l=document,c={has:function(){var e=[].concat.apply([],arguments),t,n=-1;while(t=e[++n])if(f[t]===undefined)return!1;return!0},get:function(e){var t=[].concat.apply([],arguments),n,r=-1,i={};if(t.length===1)return s(f[e]);while(n=t[++r])i[n]=s(f[n]);return i},getAll:function(){var e,t={};for(e in f)t[e]=f[e];return t},set:function(t,n){var r=[].concat.apply([],arguments),i,s=-1,o,a=2;if(e(String,t))return u(t,n);while(i=r[++s])for(o in i)a=Math.min(a,u(o,i[o]));return a},add:function(t,n){var r=[].concat.apply([],arguments),i,s=-1,o,a=2;if(e(String,t))return u(t,n,!0);while(i=r[++s])for(o in i)a=Math.min(a,u(o,i[o],!0));return a},cut:function(e){
var t=[].concat.apply([],arguments),n,r=-1;while(n=t[++r])delete f[n];return!0},cutAll:function(){for(var e in f)delete f[e];return!0}};return c}),define("DE.about",["DE.CONFIG"],function(e){var t={};return t.DEName="about",t.version="0.1.0",t.gameName="DreamGame",t.gameVersion="0.1.0",t.gameAuthor="Dreamirl",t.set=function(e){e=e||{},t.gameName=e.gameName||t.gameName,t.gameVersion=e.gameVersion||t.gameVersion,t.gameAuthor=e.gameAuthor||t.gameAuthor},e.debug.log("about loaded",3),t}),define("DE.SaveSystem",["stash","DE.CONFIG","DE.about"],function(e,t,n){var r=new function(){this.DEName="SaveSystem",this.saveModel={},this.namespace="DreamGame",this.init=function(t,r){t=t||{},t.settings||(t.settings={}),this.namespace=n.gameName,this.version=n.version,r&&(this.version=e.get(this.namespace)),this.saveModel=t;for(var i in this.saveModel)this.saveModel[i]=e.get(this.namespace+this.version+i)||this.saveModel[i],e.cut(this.namespace+this.version+i);this.version=n.version,e.set(this.namespace,
this.version);for(var i in this.saveModel)e.set(this.namespace+this.version+i,this.saveModel[i])},this.get=function(t){return t in this.saveModel||(this.saveModel[t]=e.get(this.namespace+this.version+t)||this.saveModel[t]),this.saveModel[t]},this.save=function(n,r){n in this.saveModel||t.debug.log("%c[WARN] You save a key doesn't exist in your saveModel ! add it to your saveModel but engine wont be able to get it later",0,"color:orange"),r||(r=this.get(n)),e.set(this.namespace+this.version+n,r),this.saveModel[n]=r},this.saveAll=function(){for(var t in this.saveModel)e.set(this.gameName+this.version+t,this.saveModel[t])}};return t.debug.log("SaveSystem loaded",3),r}),define("DE.Screen",["DE.CONFIG","DE.SaveSystem","DE.Event"],function(e,t,n){var r=new function(){this.DEName="Screen",this.screenSizes={},this.conceptionSizeIndex=0,this.ratioToConception=1,this.currentSizeIndex=0,this.screenSize={w:0,h:0},this.screenSizeRatio={w:0,h:0},this.dpi=1,this.init=function(e){e||console.log("%cFATAL ERROR %cyou need to pass the file containing all images datas when call DreamEngine.init"
,"color:red;background:black","color: red"),this.screenSizes=e.screenSizes||[{w:1920,h:1080,path:""}],this.conceptionSizeIndex=e.conceptionSizeIndex||0},this.udpateScreenSizes=function(r){this.dpi=1;var i=i||1;i&&(this.dpi=i);var s=t.get("settings").quality||undefined,o=this.screenSizes;this.currentSizeIndex=0,this.screenSize.w=window.innerWidth||document.documentElement.clientWidth,this.screenSize.h=window.innerHeight||document.documentElement.clientHeight,this.screenSizeRatio.w=(window.innerWidth||document.documentElement.clientWidth)/this.dpi>>0,this.screenSizeRatio.h=(window.innerHeight||document.documentElement.clientHeight)/this.dpi>>0;if(o[r]||!isNaN(s)&&o[s])o[r]?(this.currentSizeIndex=r,t.get("settings").quality=r,t.save("settings",t.get("settings"))):this.currentSizeIndex=s||r;else{var u=0;for(var a=0;a<o.length;++a){this.currentSizeIndex=a;if(o[a].w<=this.screenSize.w&&o[a].h<=this.screenSize.h){if(a>0){var f=Math.abs(o[a].w-this.screenSize.w),l=Math.abs(o[a].h-this.screenSize
.h),c=Math.abs(o[a-1].w-this.screenSize.w),h=Math.abs(o[a-1].h-this.screenSize.h);c<f&&h<l&&(this.currentSizeIndex=a-1)}break}}t.get("settings").quality=r,t.save("settings",t.get("settings"))}e.debug.log("Choosen screen size index is "+this.currentSizeIndex+" - screenSize: "+JSON.stringify(this.screenSize)+" - choosedSize: "+JSON.stringify(o[this.currentSizeIndex])+" - dpi: "+this.dpi,2),this.ratioToConception=o[this.currentSizeIndex].w/o[this.conceptionSizeIndex].w,e.debug.log("Physical ratio is :: "+this.ratioToConception,2),n.emit("udpateScreenSizes",this.ratioToConception,o[this.currentSizeIndex])}};return e.debug.log("Screens loaded",3),r}),define("DE.MainLoop",["DE.Time","DE.CONFIG","DE.States","DE.Inputs","DE.GamePad","DE.SystemDetection","DE.Screen","DE.Event"],function(e,t,n,r,i,s,o,u){var a=new function(){this.DEName="MainLoop",this.launched=!1,this.renders=new Array,this.scenes=new Array,this.maxRenders=1,this.loader=null,this.loop=function(){if(!a.launched)return;requestAnimationFrame
(a.loop);if(!e.update())return;if(n.get("isLoading")){if(!a.loader)return;for(var t=0,r;r=a.renders[t];t++)r.ctx.translate(r.sizes.width*.5,r.sizes.height*.5),a.loader.render(r.ctx,1,1),r.ctx.translate(-r.sizes.width*.5,-r.sizes.height*.5);return}if(s.isOverridingMainLoop){if(!s.render)return;s.render.render(),s.scene.update(e.currentTime)}else if(n.get("isReady")){for(var t=0,r;r=a.renders[t];t++)r.render();while(e.missedFrame>=0){i.update(e.currentTime),a.customLoop(e.currentTime);for(var t=0,r;r=a.scenes[t];t++)!r.freeze&&!r.sleep&&r.update();e.deltaTime=1,--e.missedFrame}}},this.addRender=function(e){e.id=this.maxRenders++,this.renders.push(e),e.fullScreenMode=="ratioStretch"&&e.screenChangedSizeIndex(o.ratioToConception,o.screenSizes[o.currentSizeIndex])},this.screenChangedSizeIndex=function(e,t){for(var n=0,r;r=this.renders[n];++n)r.screenChangedSizeIndex(e,t)},this.addScene=function(e){this.scenes.push(e)},this.customLoop=function(e){}};return t.debug.log("MainLoop loaded",3),a})
,define("DE.Scene",["DE.CONFIG","DE.COLORS","DE.GameObject","DE.Time","DE.MainLoop","DE.Event"],function(e,t,n,r,i,s){function o(t){this.name=t||"NoName-"+(Date.now()+Math.random()*Date.now()>>0),this.gameObjects=new Array,this.sleep=!1,this.maxObjects=0,this.tickers=new Array,this.onGlobalMouseDown={},this.onLastGlobalMouseDown={},this.onGlobalMouseMove={},this.onLastGlobalMouseMove={},this.onGlobalMouseUp={},this.onLastGlobalMouseUp={},this.onGlobalMouseClick={},this.onLastGlobalMouseClick={},this.init=function(){i.addScene(this)},this.update=function(){if(this.sleep)return;for(var e=0,t=this.gameObjects.length,n;e<t;++e){n=this.gameObjects[e];if(!n)continue;if(n.flag!==null)switch(n.flag){case"delete":this.delete(e),--t;continue}n.update(r.currentTime)}for(var e=0,t=this.tickers.length;e<t;++tk)this.tickers[e].update();this.waitSortGameObjects&&this.sortGameObjects()},this.sortGameObjects=function(){this.gameObjects.sort(function(e,t){return t.position.z==e.position.z?e.zindex-t.zindex
:t.position.z-e.position.z});for(var e=0,t;t=this.gameObjects[e];++e)t.sortChildrens();this.waitSortGameObjects=!1},this.add=function(t){if(!(t instanceof n)){e.debug.log("%cIt's not or not herits from a GameObjects",1,"color:red");return}t.scene=this,this.gameObjects.push(t),++this.maxObjects,this.waitSortGameObjects=!0},s.addEventComponents(this),this.init()}return o.prototype=o.prototype||{},s.addEventCapabilities(o),o.prototype.cleanObjectBinding=function(e){delete this.onGlobalMouseDown[e.id],delete this.onLastGlobalMouseDown[e.id],delete this.onGlobalMouseMove[e.id],delete this.onLastGlobalMouseMove[e.id],delete this.onGlobalMouseUp[e.id],delete this.onLastGlobalMouseUp[e.id]},o.prototype.remove=function(t){this.cleanObjectBinding(t);if(this.gameObjects[t])this.gameObjects.splice(t,1);else{var n=this.gameObjects.indexOf(t);if(n==-1){e.debug.log("%cRemove gameObject not found",1,"color:orange",t);return}this.gameObjects.splice(n,1)}this.maxObjects--},o.prototype.delete=function(e){
this.gameObjects[e]?this.gameObjects[e].killMePlease():e.killMePlease(),this.remove(e)},o.prototype.deleteAll=function(){var e=this.gameObjects;while(e.length>0)this.delete(0);this.maxObjects=0},o.prototype.DEName="Scene",e.debug.log("Scene loaded",3),o}),define("DE.Rigidbody",["DE.Vector2","DE.CONFIG"],function(e,t){function n(t,n){n=n||{},this.gameObject=t,this.velocity=n.velocity||new e(n.initialVelocityX||0,n.initialVelocityY||0),this.mass=n.mass||0,this.isKinetic=!1,this.isTrigger=!1,this.addForce=function(){},this.addForceTo=function(){}}return n.prototype=n.prototype||{},n.prototype.update=function(){},n.prototype.DEName="Rigidbody",t.debug.log("Rigidbody loaded",3),n}),define("DE.FixedBoxCollider",["DE.Collider","DE.COLORS","DE.CONFIG","DE.CanvasBuffer"],function(e,t,n,r){function i(i,s,o){o=o||{},o.type=n.COLLISION_TYPE.FIXED_BOX,e.call(this,o);var u=new Array,a=new Array,f=new Array;this.width=i||1,this.height=s||1,this.localPosition.x-=this.width*.5,this.localPosition.y-=this
.height*.5,this.createDebugRenderer=function(){this.debugBuffer=new r(this.width,this.height),this.debugBuffer.ctx.lineWidth=2,this.debugBuffer.ctx.strokeStyle=t.DEBUG.COLLIDER,this.debugBuffer.ctx.strokeRect(0,0,this.width,this.height)},this.getColliderPoints=function(){var e=this.gameObject.getPos();return{top:e.y+this.localPosition.y,left:e.x+this.localPosition.x,right:e.x+this.localPosition.x+this.width,bottom:e.y+this.localPosition.y+this.height}},n.DEBUG_LEVEL>1&&this.createDebugRenderer()}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="FixedBoxCollider",n.debug.log("FixedBoxCollider loaded",3),i}),define("DE.OrientedBoxCollider",["DE.Collider","DE.CONFIG","DE.CanvasBuffer","DE.COLORS"],function(e,t,n,r){function i(i,s,o){o=o||{},o.type=t.COLLISION_TYPE.ORIENTED_BOX,e.call(this,o);var u=new Array,a=new Array,f={x:this.localPosition.x,y:this.localPosition.y,radius:undefined};this.width=i||1,this.height=s||1;var l=-this.width*.5,c=
this.width*.5,h=-this.height*.5,p=this.height*.5;this.init=function(){u.push({x:l,y:h}),u.push({x:l,y:p}),u.push({x:c,y:p}),u.push({x:c,y:h});for(var e=0,n;n=u[e];e++)n.ox=n.x,n.oy=n.y;var r=this.localPosition.x-(this.localPosition.x+u[0].x);r*=r;var i=this.localPosition.y-(this.localPosition.y+u[0].y);i*=i,f.radius=Math.sqrt(r+i);var s=this.width*.5;a.push({x:0,y:0,radius:s,isColliding:!1}),this.height<this.width&&(s=this.height*.5,a[0]={x:0,y:0,radius:s,isColliding:!1});var o=(this.width-s*2)/(s*2)/2,d=!0;o<=0&&(o=(this.height-s*2)/(s*2)/2,d=!1);if(o>0){o>>=0,o++;while(o>0)d?(a.push({x:-s+l+s*2*o,y:0,radius:s,isColliding:!1}),a.push({x:s-l-s*2*o,y:0,radius:s,isColliding:!1})):(a.push({x:0,y:-s+h+s*2*o,radius:s,isColliding:!1}),a.push({x:0,y:s-h-s*2*o,radius:s,isColliding:!1})),o--}t.DEBUG_LEVEL>1&&this.createDebugRenderer()},this.createDebugRenderer=function(){this.debugBuffer=new n(f.radius,f.radius),this.debugBuffer.ctx.lineWidth=2,this.debugBuffer.ctx.strokeStyle=r.DEBUG.COLLIDER,this
.debugBuffer.ctx.strokeRect(0,0,this.width,this.height),this.debugBuffer.ctx.strokeStyle="blue",this.debugBuffer.ctx.beginPath(),this.debugBuffer.ctx.arc(this.localPosition.x,this.localPosition.y,f.radius,0,Math.PI*2,!0),this.debugBuffer.ctx.stroke(),this.debugBuffer.ctx.closePath();for(var e=0,t;t=a[e];e++)this.debugBuffer.ctx.strokeStyle="blue",this.isColliding&&(this.debugBuffer.ctx.strokeStyle="green"),this.debugBuffer.ctx.beginPath(),this.debugBuffer.ctx.arc(this.localPosition.x+t.x,this.localPosition.y+t.y,t.radius,0,Math.PI*2,!0),this.debugBuffer.ctx.stroke(),this.debugBuffer.ctx.closePath();for(var e=0,i;i=u[e];e++)this.debugBuffer.ctx.strokeStyle="red",this.debugBuffer.ctx.fillRect(i.x-1,i.y-1,2,2)},this.debugRender=function(e){e.rotate(-this.gameObject.position.rotation),e.drawImage(this.debugBuffer.canvas,this.localPosition.x-this.debugBuffer.canvas.width*.5>>0,this.localPosition.y-this.debugBuffer.canvas.height*.5>>0),e.rotate(this.gameObject.position.rotation)},this.getExternCircle=
function(){return f},this.getInternCircles=function(){return a},this.init()}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="OrientedBoxCollider",t.debug.log("OrientedBoxCollider loaded",3),i}),define("DE.CircleCollider",["DE.Collider","DE.CONFIG","DE.CanvasBuffer","DE.COLORS"],function(e,t,n,r){function i(i,s){s=s||{},s.type=t.COLLISION_TYPE.CIRCLE,e.call(this,s),this.radius=i||1,this.createDebugRenderer=function(){this.debugBuffer=new n(this.radius*2,this.radius*2),this.debugBuffer.ctx.lineWidth=2,this.debugBuffer.ctx.strokeStyle=r.DEBUG.CIRCLE_COLLIDER,this.debugBuffer.ctx.beginPath(),this.debugBuffer.ctx.arc(this.radius,this.radius,this.radius,0,Math.PI*2,!0),this.debugBuffer.ctx.stroke(),this.debugBuffer.ctx.closePath()},this.debugRender=function(e,t,n){if(!this.debugBuffer)return;e.drawImage(this.debugBuffer.canvas,this.localPosition.x-this.debugBuffer.canvas.width*.5*t*n>>0,this.localPosition.y-this.debugBuffer.canvas.height*.5*t*
n>>0,this.debugBuffer.canvas.width*t*n>>0,this.debugBuffer.canvas.height*t*n>>0)},t.DEBUG_LEVEL>1&&this.createDebugRenderer()}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="CircleCollider",t.debug.log("CircleCollider loaded",3),i}),define("DE.BoxRenderer.render",["DE.CONFIG"],function(e){function t(e,t,n){var r=e.globalAlpha;e.globalAlpha=this.alpha;switch(this.method){case"fill":this.fillIt(e,t,n);break;case"fillAndStroke":this.fillIt(e,t,n),this.strokeIt(e,t,n);break;case"stroke":this.strokeIt(e,t,n);break;default:this.strokeIt(e,t,n)}e.globalAlpha=r}return e.debug.log("BoxRenderer.render loaded",3),t}),define("DE.BoxRenderer",["DE.Renderer","DE.BoxRenderer.render","DE.CONFIG","DE.Sizes"],function(e,t,n,r){function i(t,n,i){e.call(this,t),this.sizes=new r(n,i,1,1,this),this.sizes._center(),this.fillIt=function(e,t,n){e.fillStyle=this.fillColor,e.fillRect(this.localPosition.x*t>>0,this.localPosition.y*t>>0,this.sizes.width*t*n>>0,this
.sizes.height*t*n>>0)},this.strokeIt=function(e,t,n){e.strokeStyle=this.strokeColor,e.strokeRect(this.localPosition.x*t>>0,this.localPosition.y*t>>0,this.sizes.width*t*n>>0,this.sizes.height*t*n>>0)},this.setWidth=function(e){this.sizes.setSizes(e,this.sizes.height)},this.setHeight=function(e){this.sizes.setSizes(this.sizes.width,e)},this.setSizes=function(e,t){this.sizes.setSizes(e,t)}}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="BoxRenderer",i.prototype.render=t,n.debug.log("BoxRenderer loaded",3),i}),define("DE.CircleRenderer.render",["DE.CONFIG"],function(e){function t(e,t,n){var r=e.globalAlpha;e.drawImage(this.buffer.canvas,this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.radius*2*t*n>>0,this.radius*2*t*n>>0),e.globalAlpha=r}return e.debug.log("CircleRenderer.render loaded",3),t}),define("DE.CircleRenderer",["DE.Renderer","DE.CircleRenderer.render","DE.CONFIG","DE.CanvasBuffer"],function(e,t,n,r){function i(t,n,i,s
,o){e.call(this,t),this.radius=n||1,this.angleStart=i||0,this.angleEnd=s||Math.PI*2,this.clockRotation=o||!1,this.buffer=null,this.localPosition.x-=this.radius,this.localPosition.y-=this.radius,this.initCircle=function(){this.buffer=new r(this.radius*2,this.radius*2);var e=this.buffer.ctx;e.fillStyle=this.fillColor,e.strokeStyle=this.strokeColor,e.globalAlpha=this.alpha,e.beginPath(),e.arc(this.radius,this.radius,this.radius,this.angleStart,this.angleEnd,this.clockRotation);switch(this.method){case"fill":e.fill();break;case"fillAndStroke":e.fill(),e.stroke();break;case"stroke":e.stroke();break;default:e.stroke()}e.closePath()},this.initCircle()}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="CircleRenderer",i.prototype.render=t,n.debug.log("CircleRenderer loaded",3),i}),define("DE.SpriteRenderer.render",["DE.ImageManager","DE.CONFIG","DE.Time"],function(e,t,n){function r(t,r,i){if(this.isAnimated&&!this.isPaused&&!this.isOver&&n.currentTime-
this.lastAnim>this.eachAnim){var s=(n.currentTime-this.lastAnim)/this.eachAnim>>0;this.lastAnim=n.currentTime;while(s>0)this.isReversed?!this.isLoop&&this.currentFrame-1<this.startFrame?(this.isOver=!0,this.onAnimEnd()):this.currentFrame=this.currentFrame-1<this.startFrame?this.endFrame-1:this.currentFrame-1:!this.isLoop&&this.currentFrame+1>=this.endFrame?(this.isOver=!0,this.onAnimEnd()):this.currentFrame=this.currentFrame+1>=this.endFrame?this.startFrame:this.currentFrame+1,s--}t.globalAlpha=this.alpha,t.drawImage(e.images[this.spriteName],this.frameSizes.width*this.currentFrame,this.frameSizes.height*this.currentLine,this.frameSizes.width,this.frameSizes.height,this.localPosition.x*i>>0,this.localPosition.y*i>>0,this.sizes.width*this.sizes.scaleX*i>>0,this.sizes.height*this.sizes.scaleY*i>>0),t.globalAlpha=1}return t.debug.log("SpriteRender.render loaded",3),r}),define("DE.SpriteRenderer",["DE.Renderer","DE.ImageManager","DE.Sizes","DE.SpriteRenderer.render","DE.CONFIG","DE.Time","DE.Event"
],function(e,t,n,r,i,s,o){function u(r){if(!r)throw new Error("SpriteRenderer :: You have to pass arguments object to instantiate -- see the doc");e.call(this,r),this.spriteName=r.spriteName||undefined;if(!this.spriteName)throw new Error("SpriteRenderer :: No spriteName defined -- declaration canceled");if(!t.images[this.spriteName])throw new Error("SpriteRenderer :: Can't find image "+this.spriteName+" in imagesDatas");this.startFrame=r.startFrame||0,this.endFrame=r.endFrame||t.images[this.spriteName].totalFrame||0,this.totalFrame=t.images[this.spriteName].totalFrame||0,this.totalLine=r.totalLine||t.images[this.spriteName].totalLine||0,this.eachAnim=r.eachAnim||t.images[this.spriteName].eachAnim||0,this.lastAnim=Date.now(),this.frameSizes=new n(t.images[this.spriteName].widthFrame,t.images[this.spriteName].heightFrame,1,1),r.scaleX=r.scale||r.scaleX||r.scalex||1,r.scaleY=r.scale||r.scaleY||r.scaley||1,this.sizes=new n(r.width||r.w||t.images[this.spriteName].widthFrame,r.height||r.h||t.
images[this.spriteName].heightFrame,r.scaleX,r.scaleY,this),this.isAnimated=r.isAnimated||t.images[this.spriteName].isAnimated,this.isPaused=r.paused||r.isPaused,t.images[this.spriteName].isPaused||!1,this.isReversed=r.reversed||r.isreversed||r.isReversed||t.images[this.spriteName].isReversed||!1,this.isOver=!1,this.isLoop=r.isLoop!=undefined?r.isLoop:t.images[this.spriteName].isLoop,this.currentFrame=this.startFrame||0,this.currentLine=r.startLine||0,this.sizes._center(),this.onAnimEnd=function(){},o.on("imageLoaded",function(e,n,r){if(r!=this.spriteName)return;this.frameSizes.width=t.images[this.spriteName].widthFrame,this.frameSizes.height=t.images[this.spriteName].heightFrame,this.sizes.setSizes(this.frameSizes)},this)}return u.prototype=new e,u.prototype.constructor=u,u.prototype.supr=e.prototype,u.prototype.DEName="SpriteRenderer",u.prototype.render=r,u.prototype.setFrame=function(e){e+1>=this.endFrame?this.currentFrame=this.endFrame-1:e<this.startFrame?this.currentFrame=this.startFrame
:this.currentFrame=e},u.prototype.setLine=function(e){e+1>=this.totalLine?this.currentLine=this.totalLine-1:this.currentLine=e},u.prototype.restartAnim=function(){this.isOver=!1,this.isReversed?this.currentFrame=this.endFrame-1:this.currentFrame=this.startFrame,this.lastAnim=s.currentTime},u.prototype.setPause=function(e,t){this.isPaused=e,!e&&!this.isAnimated&&(this.isAnimated=!0,this.lastAnim=Date.now())},u.prototype.setEndFrame=function(e){this.totalFrame<=e?this.endFrame=this.totalFrame-1:this.endFrame=e},u.prototype.setDelay=function(e){this.eachAnim=e},u.prototype.setLoop=function(e){this.isLoop=e},i.debug.log("SpriteRenderer loaded",3),u}),define("DE.Render",["DE.CONFIG","DE.Sizes","DE.Time","DE.MainLoop","DE.CollisionSystem","DE.Inputs","DE.CanvasBuffer"],function(e,t,n,r,i,s,o){function u(u,a){function f(){return{x:document.scrollLeft||window.pageXOffset,y:document.scrollTop||window.pageYOffset}}function l(e,t,n){var r={x:e,y:t},i=this.canvas,s=0,o=0;while(i)s+=i.offsetLeft,o+=
i.offsetTop,i=i.parentElement;return r.x-=s,r.y-=o,{x:r.x/c+f().x>>0,y:r.y/c+f().y>>0,index:n}}a=a||{},this.id=0,this.divId=u||undefined,this.canvas=null,this.ctx=null,this.sizes=new t(a.width||e.defaultRenderWidth||100,a.height||e.defaultRenderHeight||100,a.scaleX||1,a.scaleY||1),this.savedSizes=new t(a.width||e.defaultRenderWidth||100,a.height||e.defaultRenderHeight||100,a.scaleX||1,a.scaleY||1);var c=1;this.physicRatio=1,this.conserveSizes=a.conserveSizes||!1,this.fullScreenMode=a.fullScreen||null,this.cameras=new Array,this.maxCameras=0,this.freeze=!1,this.init=function(){if(this.inited)return;r.addRender(this);if(!this.divId)this.div=window.document.body,e.debug.log("%cWARN: you not specified a DOM Object where push the render, it will push in the body *hiiik*",1,"color:orange");else{this.div=document.getElementById(this.divId);if(!this.div)throw new Error("Can't found the div by the given id")}this.canvas=document.createElement("canvas"),this.div.appendChild(this.canvas),s.addRender
(this),this.ctx=this.canvas.getContext("2d"),this.buffer=new o(this.sizes.width,this.sizes.height),this.inited=!0,this.updateSizes()},this.updateSizes=function(){if(!this.inited)return;this.conserveSizes?(this.sizes.width=this.div.offsetWidth.valueOf(),this.sizes.height=this.div.offsetHeight.valueOf()):(this.div.style.width=this.sizes.width+"px",this.div.style.height=this.sizes.height+"px"),this.canvas.width=this.sizes.width.valueOf(),this.canvas.height=this.sizes.height.valueOf(),this.canvas.id=this.id,this.fullScreenMode&&(this.fullScreen(this.fullScreenMode),this.resizeOnEventResize()),this.buffer.resize(this.sizes.width,this.sizes.height)},this.screenChangedSizeIndex=function(e,t){this.savedSizes.width=t.w,this.savedSizes.height=t.h,this.physicRatio=e,this.updateSizes();for(var n=0,r;r=this.cameras[n];++n)r.screenChangedSizeIndex(e,t)},this.resize=function(e,t,n){this.div!=window.document.body&&(this.div.style.width=e+"px",this.div.style.height=t+"px"),this.canvas.width=e,this.canvas
.height=t,this.sizes.width=e,this.sizes.height=t},this.resizeOnEventResize=function(){if(!this.fullScreenMode)return;var e=this,t=undefined,n=function(){e.fullScreenMethod.call(e)};window.addEventListener?window.addEventListener("resize",function(){t&&window.clearTimeout(t),t=window.setTimeout(n,200)},!1):window.attachEvent&&window.attachEvent("onresize",function(){t&&window.clearTimeout(t),t=window.setTimeout(n,200)})},this.resizeRatio=function(e,t,n){var r=this.savedSizes.width,i=this.savedSizes.height,s=e/r;s*i>t&&(s=t/i);var o=s*r>>0,u=s*i>>0;this.resize(o,u,n),this.div.style.marginLeft=(e-o)/2+"px",this.div.style.marginTop=(t-u)/2+"px",this.canvas.style.top=0,c=o/this.savedSizes.width};var h;this.changeFullScreenMode=function(e){this.fullScreenMode=e;switch(e){case"ratioStretch":h=function(e,t){this.resizeRatio(e,t,!0)};break;case"fullStretch":h=function(e,t){this.resize(e,t,!0)};break;case"ratio":h=function(e,t){this.resizeRatio(e,t,!1)};break;default:h=function(e,t){}}},this.fullScreenMethod=
function(){var e=window.innerWidth||document.documentElement.clientWidth,t=window.innerHeight||document.documentElement.clientHeight,n=window.getComputedStyle(this.div.parentElement,null).getPropertyValue("height");if(this.div.parentElement!=null&&n&&t<document.body.clientHeight){var r=this.div.parentElement.innerWidth||this.div.parentElement.clientWidth,i=this.div.parentElement.innerHeight||this.div.parentElement.clientHeight;i<t&&(t=i),r<e&&(e=r)}if(!h)throw"Render.js : fullScreenMethod need a fullScreenMode, maybe you never used changeFullScreenMode";h.call(this,e,t)},this.fullScreen=function(e,t){e&&this.changeFullScreenMode(e),t,this.fullScreenMethod()},this.render=function(){if(this.freeze)return;this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.sizes.width,this.sizes.height);for(var t=0,r;r=this.cameras[t];++t)r.render(this.ctx,c,this.physicRatio);e.DEBUG_LEVEL>0&&(this.ctx.font="24px Arial",this.ctx.fillStyle="white",this.ctx.fillText("DeltaTime: "+n.deltaTime,(this.sizes.width>>0
)-220,30),this.ctx.fillText("MissedFrame: "+n.missedFrame,(this.sizes.width>>0)-220,60),this.ctx.fillText("FPS: "+n.fps,(this.sizes.width>>0)-220,90))},this.add=function(e){this.cameras.push(e),this.maxScenes++,e.screenChangedSizeIndex(this.physicRatio,this.savedSizes)},this.remove=function(t){var n=this.cameras.indexOf(t);if(n==-1){e.debug.log("Remove camera not found ",1,t);return}this.cameras.splice(n,1),this.maxScenes--},this.camerasMouseCollide=function(e,t,n,r){var s=l.call(this,t,n,r);if(this["on"+e](s)||s.stopPropagation)return s;for(var o=0,u,a;o<this.cameras.length;o++){u=this.cameras[o];if(u.sleep)continue;a={x:u.renderPosition.x-u.renderSizes.width*.5*u.renderSizes.scaleX,y:u.renderPosition.y-u.renderSizes.height*.5*u.renderSizes.scaleY,width:u.renderSizes.width*u.renderSizes.scaleX,height:u.renderSizes.height*u.renderSizes.scaleY};if(i.pointFixedBoxCollision(s,a)){if(!u.indexMouseOver[r]&&u.oOnMouseEnter(s,this.physicRatio))break;if(u["oOn"+e](s,this.physicRatio))break}else if(
u.indexMouseOver[r]&&u.oOnMouseLeave(s,this.physicRatio))break}return s.stopPropagation||this["lastOn"+e](s),s},this.onMouseMove=function(){},this.onMouseDown=function(){},this.onMouseUp=function(){},this.lastOnMouseMove=function(){},this.lastOnMouseDown=function(){},this.lastOnMouseUp=function(){},this.oOnMouseDown=function(e){this.camerasMouseCollide("MouseDown",e.x,e.y,e.index)},this.oOnMouseUp=function(e){this.camerasMouseCollide("MouseUp",e.x,e.y,e.index)},this.oOnMouseMove=function(e){this.camerasMouseCollide("MouseMove",e.x,e.y,e.index)}}return u.prototype.DEName="Render",e.debug.log("Render loaded",3),u}),define("DE.Camera",["DE.CONFIG","DE.Sizes","DE.Vector2","DE.CanvasBuffer","DE.CollisionSystem","DE.ImageManager","DE.Event"],function(e,t,n,r,i,s,o){function u(e,i,s,u,a){a=a||{},this.name=a.name||"",this.tag=a.tag||"",this.scene=a.scene||null,this.gui=undefined,this.renderSizes=new t(e,i,a.scale||a.scaleX||1,a.scale||a.scaleY||1),this.fieldSizes=new t(e,i,a.scale||a.scaleX||1,
a.scale||a.scaleY||1),this.renderPosition=new n(s+e*.5,u+i*.5,a.z||-10),this.savedPosition=new n(s+e*.5,u+i*.5,a.z||-10),this.scenePosition=new n(a.realx||s,a.realy||u,a.realz||a.z||-10),this.limits={minX:a.minX!=undefined?a.minX:undefined,maxX:a.maxX!=undefined?a.maxX:undefined,minY:a.minY!=undefined?a.minY:undefined,maxY:a.maxY!=undefined?a.maxY:undefined},this.opacity=a.opacity||1,this.backgroundColor=a.backgroundColor||null,this.backgroundImage=a.backgroundImage||null,this.cameras=new Array,this.maxCameras=0,this.freeze=!1,this.sleep=!1,this.startX=0,this.startY=0,this._buffer=new r(this.renderSizes.width,this.renderSizes.height),this._visibleGameObjects=[],this.indexMouseOver=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.lastPointersPos={},this._propagationEvent=[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],o.addEventComponents(this)}function a(e,t,n,r){if(!t.enable)return!1;if(t.collider&&(t["onMouse"+e]||t.onMouseLeave||t.onMouseEnter)){var s=t.indexMouseOver[n.index];if(
i.checkCollisionWith(n,t.collider)){t.indexMouseOver[n.index]=!0;if(!s&&t.onMouseEnter&&t.onMouseEnter(n,r))return!0;if(t["onMouse"+e]&&t["onMouse"+e](n,r))return!0}else if(s&&t.onMouseLeave){t.indexMouseOver[n.index]=!1;if(t.onMouseLeave(n,r))return!0}}for(var o=t.childrens.length-1,u;o>=0;--o)if(a(e,t.childrens[o],n,r))return!0}return u.prototype.getBuffer=function(){return this._buffer},u.prototype.render=function(t,n,r){if(this.sleep)return;var i=this._buffer;if(!this.freeze){i.ctx.globalAlpha=this.opacity,this.backgroundColor!=null&&(i.ctx.fillStyle=this.backgroundColor,i.ctx.fillRect(0,0,this.renderSizes.width,this.renderSizes.height)),this.backgroundImage!=null&&i.ctx.drawImage(s.images[this.backgroundImage],0,0,this.renderSizes.width,this.renderSizes.height),i.ctx.save();if(this.scene){var o=this.scene.gameObjects;this._visibleGameObjects=[];for(var u=0,a=o.length,f,l;u<a;u++)f=o[u],f&&f.enable&&f.position.z>this.scenePosition.z&&f.position.x+f.biggerOffset.width>=this.scenePosition
.x&&f.position.x-f.biggerOffset.width<=this.scenePosition.x+this.fieldSizes.width&&f.position.y+f.biggerOffset.height>=this.scenePosition.y&&f.position.y-f.biggerOffset.height<=this.scenePosition.y+this.fieldSizes.height&&(this._visibleGameObjects.push(f),l=10/(f.position.z-this.scenePosition.z),f.render(i.ctx,r,l,this.scenePosition,this.renderSizes))}else i.ctx.textAlign="center",i.ctx.fillStyle="white",i.ctx.fillText("No scene affiliated :(",this.renderSizes.width*.5,this.renderSizes.height*.5);i.ctx.restore(),i.ctx.globalAlpha=this.opacity,e.DEBUG&&(i.ctx.fillStyle="white",i.ctx.textAlign="left",i.ctx.fillText("Camera "+this.name,10,20),i.ctx.strokeStyle="red",i.ctx.strokeRect(0,0,this.renderSizes.width>>0,this.renderSizes.height>>0),i.ctx.fillStyle="yellow",i.ctx.fillRect(this.renderSizes.width-10,this.renderSizes.height-10,10,10),i.ctx.fillRect(this.renderSizes.width-10,0,10,10),i.ctx.fillRect(0,this.renderSizes.height-10,10,10),i.ctx.fillRect(0,0,10,10),i.ctx.fillRect(this.renderSizes
.width*.5,this.renderSizes.height*.5,20,5),i.ctx.fillRect(this.renderSizes.width*.5,this.renderSizes.height*.5,5,20)),this.getFocus(),this.checkLimits(),this.applyShake()}t.translate(this.renderPosition.x*n>>0,this.renderPosition.y*n>>0),t.rotate(this.renderPosition.rotation),t.drawImage(i.canvas,-this.renderSizes.width*this.renderSizes.scaleX*n*.5>>0,-this.renderSizes.height*this.renderSizes.scaleY*n*.5>>0,this.renderSizes.width*this.renderSizes.scaleX*n>>0,this.renderSizes.height*this.renderSizes.scaleY*n>>0),this.gui&&this.gui.render(t,this.renderPosition,this.renderSizes,n,r),t.rotate(-this.renderPosition.rotation),t.translate(-this.renderPosition.x*n>>0,-this.renderPosition.y*n>>0)},u.prototype.checkLimits=function(){var e=this.limits;e.minX!=undefined&&this.scenePosition.x<e.minX?this.scenePosition.x=e.minX:e.maxX!=undefined&&this.scenePosition.x+this.renderSizes.width>e.maxX&&(this.scenePosition.x=e.maxX-this.renderSizes.width),e.minY!=undefined&&this.scenePosition.y<e.minY?this.
scenePosition.y=e.minY:e.maxY!=undefined&&this.scenePosition.y+this.renderSizes.height>e.maxY&&(this.scenePosition.y=e.maxY-this.renderSizes.height)},u.prototype.screenChangedSizeIndex=function(e,t){this.renderSizes.width=this.fieldSizes.width*e>>0,this.renderSizes.height=this.fieldSizes.height*e>>0,this.renderPosition.x=this.savedPosition.x*e>>0,this.renderPosition.y=this.savedPosition.y*e>>0,this._buffer.canvas.width=this.renderSizes.width,this._buffer.canvas.height=this.renderSizes.height},u.prototype.add=function(e){this.cameras.push(e),++this.maxCameras},u.prototype.remove=function(t){var n=this.cameras.indexOf(t);if(n==-1){e.debug.log("%cRemove camera not found ",1,"color:orange",t);return}this.cameras.splice(n,1),this.maxCameras--},u.prototype.shake=function(e,t,n){this.shakeData={startedAt:Date.now(),duration:n,xRange:e,yRange:t,prevX:this.shakeData?this.shakeData.prevX:0,prevY:this.shakeData?this.shakeData.prevY:0}},u.prototype.applyShake=function(){if(!this.shakeData)return;var e=
this.shakeData;this.scenePosition.x-=e.prevX,this.scenePosition.y-=e.prevY;if(Date.now()-this.shakeData.startedAt>this.shakeData.duration){delete this.shakeData;return}e.prevX=-(Math.random()*e.xRange)+Math.random()*e.xRange>>0,e.prevY=-(Math.random()*e.yRange)+Math.random()*e.yRange>>0,this.scenePosition.x+=e.prevX,this.scenePosition.y+=e.prevY},u.prototype.focus=function(e,t){this.target=e,this.focusLocks=t},u.prototype.getFocus=function(){if(!this.target)return;var e=this.target.getPos(),t=(Math.abs(this.scenePosition.z+e.z)-10)*.1+1;this.focusLocks.x||(this.scenePosition.x=e.x-this.fieldSizes.width*.5/t),this.focusLocks.y||(this.scenePosition.y=e.y-this.fieldSizes.height*.5/t)},u.prototype.convertMousePos=function(e,t){var n=this.renderPosition.getHarmonics();if(n.sin==0&&n.cos==0)return this.renderSizes.scaleX!=1||this.renderSizes.scaleY!=1?{x:(e.x/t-(this.renderSizes.width-this.renderSizes.width*this.renderSizes.scaleX)/2)/this.renderSizes.scaleX>>0,y:(e.y/t-(this.renderSizes.height-
this.renderSizes.height*this.renderSizes.scaleY)/2)/this.renderSizes.scaleY>>0,index:e.index}:{x:e.x/t>>0,y:e.y/t>>0,index:e.index};var r=this.renderSizes.width/2-e.x,i=this.renderSizes.height/2-e.y;return this.renderSizes.scaleX!=1||this.renderSizes.scaleY!=1?{x:((-(r*n.cos+i*n.sin)+this.renderSizes.width/2)/t-(this.renderSizes.width-this.renderSizes.width*this.renderSizes.scaleX)/2)/this.renderSizes.scaleX>>0,y:((r*n.sin+i*-n.cos+this.renderSizes.height/2)/t-(this.renderSizes.height-this.renderSizes.height*this.renderSizes.scaleY)/2)/this.renderSizes.scaleY>>0,index:e.index,isDown:e.isDown}:{x:(-(r*n.cos+i*n.sin)+this.renderSizes.width/2)/t>>0,y:(r*n.sin+i*-n.cos+this.renderSizes.height/2)/t>>0,index:e.index,isDown:e.isDown}},u.prototype.onMouseDown=function(){},u.prototype.onMouseUp=function(){},u.prototype.onMouseMove=function(){},u.prototype.onMouseEnter=function(){},u.prototype.onMouseLeave=function(){},u.prototype.onMouseClick=function(){},u.prototype.onLastMouseMove=function(){}
,u.prototype.onLastMouseDown=function(){},u.prototype.onLastMouseUp=function(){},u.prototype.onLastMouseClick=function(){},u.prototype.oOnMouseDown=function(e,t){e.isDown=!0,e.date=Date.now(),this._propagationEvent[e.index]=e,this.mouseDetectorHandler("Down",e,t)},u.prototype.oOnMouseUp=function(t,n){Date.now()<this._propagationEvent[t.index].date+e.CLICK_DELAY&&this.mouseDetectorHandler("Click",t,n),this.mouseDetectorHandler("Up",t,n),this._propagationEvent[t.index]={}},u.prototype.oOnMouseMove=function(e,t){this._propagationEvent[e.index].index||(this._propagationEvent[e.index]=e),this.lastPointersPos[e.index]=e,this.indexMouseOver[e.index]=!0,this.mouseDetectorHandler("Move",e,t)},u.prototype.oOnMouseEnter=function(e,t){e=this.convertMousePos(e,t),this.onMouseEnter(e)},u.prototype.oOnMouseLeave=function(e,t){this.indexMouseOver[e.index]=!1,e=this.convertMousePos(e,t),this.onMouseLeave(e)},u.prototype.mouseDetectorHandler=function(e,t,n){if(this.freeze||this.sleep||this._propagationEvent
[t.index]["prevent"+e])return;t=this.convertMousePos(t,n);for(var r in this.scene["onGlobalMouse"+e])if(this.scene["onGlobalMouse"+e][r].enable&&this.scene["onGlobalMouse"+e][r]["onGlobalMouse"+e](t,this._propagationEvent[t.index]))return;this.trigger("mouse"+e,t);if(this["onMouse"+e](t,this._propagationEvent[t.index])||t.stopPropagation)return;if(this.gui&&this.gui["onMouse"+e](t,this._propagationEvent[t.index])||t.stopPropagation)return;t.x+=this.scenePosition.x,t.y+=this.scenePosition.y;for(var r=this._visibleGameObjects.length-1,i;r>=0;--r){i=this._visibleGameObjects[r];if(a(e,i,t,this._propagationEvent[t.index]))return}if(!t.stopPropagation&&!this._propagationEvent[t.index]["preventLast"+e]){this.trigger("onLastMouse"+e,t,this._propagationEvent[t.index]),this["onLastMouse"+e](t,this._propagationEvent[t.index]);for(var r in this.scene["onLastGlobalMouse"+e])this.scene["onLastGlobalMouse"+e][r].enable&&this.scene["onLastGlobalMouse"+e][r]["onLastGlobalMouse"+e](t,this._propagationEvent
[t.index])}},o.addEventCapabilities(u),u.prototype.DEName="Camera",e.debug.log("Camera loaded",3),u}),define("DE.TextRenderer.render",["DE.CONFIG"],function(e){function t(e,t,n){var r=e.globalAlpha;e.globalAlpha=this.alpha,e.drawImage(this.buffer.canvas,this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.sizes.width*this.sizes.scaleX*t*n>>0,this.sizes.height*this.sizes.scaleY*t*n>>0),e.globalAlpha=r}return e.debug.log("TextRenderer.render loaded",3),t}),define("DE.TextRenderer",["DE.Renderer","DE.TextRenderer.render","DE.CONFIG","DE.Sizes","DE.CanvasBuffer","DE.ImageManager"],function(e,t,n,r,i,s){function o(t,n,o,u){e.call(this,t);if(!t||!n||!o||u==undefined)throw new Error("TextRenderer :: Can't instantiate without params, width, height, text");this.text=u,this.textAlign=t.textAlign||"center",this.textBaseline=t.textBaseline||"middle",this.fontSize=t.fontSize||20,this.font=t.font||"Calibri",this.sizes=new r(n,o,1,1,this),this.sizes._center(),this.paddingX=t.padding||t.paddingX||0
,this.paddingY=t.padding||t.paddingY||0,this.backgroundColor=t.backgroundColor,this.borderColor=t.borderColor,this.borderSize=t.borderSize||1,this.backgroundImage=t.backgroundImage,this.backgroundImage&&!s.images[this.backgroundImage]&&(console.log("TextRenderer :: %cCant find given backgroundImage - "+this.backgroundImage+" check your imagesDatas - ignore background","color: red"),this.backgroundImage=undefined);if(this.backgroundImage||this.backgroundColor||this.borderColor)this.background=!0;this.init=function(){this.buffer=new i(this.sizes.width,this.sizes.height),this.clearBuffer()},this.clearBuffer=function(){this.buffer.ctx.clearRect(0,0,this.sizes.width,this.sizes.height),this.buffer.ctx.font=this.fontSize+"pt "+this.font,this.buffer.ctx.textAlign=this.textAlign,this.buffer.ctx.textBaseline=this.textBaseline,this.background&&(this.backgroundImage?this.buffer.ctx.drawImage(s.images[this.backgroundImage],0,0,this.sizes.width,this.sizes.height):this.backgroundColor&&(this.buffer.ctx
.fillStyle=this.backgroundColor,this.buffer.ctx.fillRect(0,0,this.sizes.width,this.sizes.height)),this.borderColor&&(this.buffer.ctx.lineWidth=this.borderSize,this.buffer.ctx.strokeStyle=this.borderColor,this.buffer.ctx.strokeRect(0,0,this.sizes.width,this.sizes.height),this.buffer.ctx.lineWidth=1));var e=this.textAlign=="right"?this.sizes.width-this.paddingX:this.textAlign=="left"?this.paddingX:this.sizes.width*.5+this.paddingX>>0,t=this.textBaseline=="bottom"?this.sizes.height-this.paddingY:this.textBaseline=="top"?this.paddingY:this.sizes.height*.5+this.paddingY>>0;this.fillColor&&(this.buffer.ctx.fillStyle=this.fillColor,this.forceWidth?this.buffer.ctx.fillText(this.text,e,t,this.sizes.width):this.buffer.ctx.fillText(this.text,e,t)),this.strokeColor&&(this.fillColor&&(this.buffer.ctx.globalAlpha=.8),this.buffer.ctx.strokeStyle=this.strokeColor,this.forceWidth?this.buffer.ctx.strokeText(this.text,e,t,this.sizes.width):this.buffer.ctx.fillText(this.text,e,t))},this.setText=function(e)
{this.text=e,this.clearBuffer(),this.onSetText(e)},this.onSetText=function(e){},this.setSizes=function(e,t){this.sizes.setSizes(e,t)},this.init(t)}return o.prototype=new e,o.prototype.constructor=o,o.prototype.supr=e.prototype,o.prototype.DEName="TextRenderer",o.prototype.render=t,n.debug.log("TextRenderer loaded",3),o}),define("DE.TileRenderer.render",["DE.ImageManager","DE.CONFIG","DE.Time"],function(e,t,n){function r(t,n,r){t.globalAlpha=this.alpha,e.imageNotRatio?t.drawImage(e.images[this.imageName],this.tileposition.x*n>>0,this.tileposition.y*n>>0,this.tilesizes.width*n+1>>0,this.tilesizes.height*n+1>>0,this.localPosition.x*n*r>>0,this.localPosition.y*n*r>>0,this.sizes.width*this.sizes.scaleX*n*r+2>>0,this.sizes.height*this.sizes.scaleY*n*r+1>>0):t.drawImage(e.images[this.imageName],this.tileposition.x,this.tileposition.y,this.tilesizes.width,this.tilesizes.height,this.localPosition.x*r>>0,this.localPosition.y*r>>0,this.sizes.width*this.sizes.scaleX*r>>0,this.sizes.height*this.sizes
.scaleY*r>>0),t.globalAlpha=1}return t.debug.log("TileRenderer.render loaded",3),r}),define("DE.TileRenderer",["DE.Renderer","DE.ImageManager","DE.Vector2","DE.Sizes","DE.TileRenderer.render","DE.CONFIG"],function(e,t,n,r,i,s){function o(i){if(!i)throw new Error("TileRenderer :: You have to pass arguments object to instantiate -- see the doc");e.call(this,i),this.imageName=i.imageName||undefined;if(!this.imageName)throw new Error("TileRenderer :: No imageName defined -- declaration canceled");if(!t.images[this.imageName])throw new Error("TileRenderer :: Can't find image "+this.imageName+" in imagesDatas");i.tilesizes=i.tilesizes||i.tileSizes||{},this.tilesizes=new r(i.tilesizes.width||i.tilesizes.w||i.width||10,i.tilesizes.height||i.tilesizes.h||i.height||10,1,1),i.tileposition=i.tileposition||i.tilePosition||{},this.tileposition=new n(i.tileposition.x||i.x||0,i.tileposition.y||i.y||0),this.tileposition||console.error("Tile position must be defined"),i.scaleX=i.scale||i.scaleX||i.scalex||1
,i.scaleY=i.scale||i.scaleY||i.scaley||1,i.sizes=i.sizes||{},this.sizes=new r(i.sizes.width||i.width||i.w||i.tilesizes.width||10,i.sizes.height||i.height||i.h||i.tilesizes.height||10,i.scaleX,i.scaleY),this.localPosition.x-=this.sizes.width*this.sizes.scaleX*.5,this.localPosition.y-=this.sizes.height*this.sizes.scaleY*.5}return o.prototype=new e,o.prototype.constructor=o,o.prototype.supr=e.prototype,o.prototype.DEName="TileRenderer",o.prototype.render=i,s.debug.log("TileRenderer loaded",3),o}),define("buzz",[],function(){var e={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80,document:document},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(t,n){function r(e){var t=[],n=e.length-1;for(var r=0;r<=n;r++)t.push({start:e.start(r),end:e.end(r)});return t}function i(e){return e.split(".").pop()}function s(t,n){var r=o.createElement("source"
);r.src=n,e.types[i(n)]&&(r.type=e.types[i(n)]),t.appendChild(r)}n=n||{};var o=n.document||e.defaults.document,u=0,a=[],f={},l=e.isSupported();this.load=function(){return l?(this.sound.load(),this):this},this.play=function(){return l?(this.sound.play(),this):this},this.togglePlay=function(){return l?(this.sound.paused?this.sound.play():this.sound.pause(),this):this},this.pause=function(){return l?(this.sound.pause(),this):this},this.isPaused=function(){return l?this.sound.paused:null},this.stop=function(){return l?(this.setTime(0),this.sound.pause(),this):this},this.isEnded=function(){return l?this.sound.ended:null},this.loop=function(){return l?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return l?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return l?(this.sound.muted=!0,this):this},this.unmute=function(){return l?(this.sound.muted=!1,this):this},this
.toggleMute=function(){return l?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return l?this.sound.muted:null},this.setVolume=function(e){return l?(e<0&&(e=0),e>100&&(e=100),this.volume=e,this.sound.volume=e/100,this):this},this.getVolume=function(){return l?this.volume:this},this.increaseVolume=function(e){return this.setVolume(this.volume+(e||1))},this.decreaseVolume=function(e){return this.setVolume(this.volume-(e||1))},this.setTime=function(e){if(!l)return this;var t=!0;return this.whenReady(function(){t===!0&&(t=!1,this.sound.currentTime=e)}),this},this.getTime=function(){if(!l)return null;var t=Math.round(this.sound.currentTime*100)/100;return isNaN(t)?e.defaults.placeholder:t},this.setPercent=function(t){return l?this.setTime(e.fromPercent(t,this.sound.duration)):this},this.getPercent=function(){if(!l)return null;var t=Math.round(e.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(t)?e.defaults.placeholder:t},this.setSpeed=function(e){return l?
(this.sound.playbackRate=e,this):this},this.getSpeed=function(){return l?this.sound.playbackRate:null},this.getDuration=function(){if(!l)return null;var t=Math.round(this.sound.duration*100)/100;return isNaN(t)?e.defaults.placeholder:t},this.getPlayed=function(){return l?r(this.sound.played):null},this.getBuffered=function(){return l?r(this.sound.buffered):null},this.getSeekable=function(){return l?r(this.sound.seekable):null},this.getErrorCode=function(){return l&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!l)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return l?this.sound.readyState:null},this.getStateMessage=function(){if(!l)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA"
;case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return l?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!l)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(e,t){return l?(this.sound[e]=t,this):this},this.get=function(e){return l?e?this.sound[e]:this.sound:null},this.bind=function(e,t){if(!l)return this;e=e.split(" ");var n=this,r=function(e){t.call(n,e)};for(var i=0;i<e.length;i++){var s=e[i],o=s;s=o.split(".")[0],a.push({idx:o,func:r}),this.sound.addEventListener(s,r,!0)}return this},this.unbind=function(e){if(!l)return this;e=e.split(" ");for(var t=0;t<e.length;t++){var n=e[t],r=n.split(".")[0];for(var i=0;i<a.length;i++){var s=a[i].idx.split(".");if(a[i].idx==n||s[1]&&s[1]==n.replace(".",""))this.sound.removeEventListener(r,a[i].func,!0),a.splice(i,1)}}return this
},this.bindOnce=function(e,t){if(!l)return this;var n=this;return f[u++]=!1,this.bind(e+"."+u,function(){f[u]||(f[u]=!0,t.call(n)),n.unbind(e+"."+u)}),this},this.trigger=function(e){if(!l)return this;e=e.split(" ");for(var t=0;t<e.length;t++){var n=e[t];for(var r=0;r<a.length;r++){var i=a[r].idx.split(".");if(a[r].idx==n||i[0]&&i[0]==n.replace(".","")){var s=o.createEvent("HTMLEvents");s.initEvent(i[0],!1,!0),this.sound.dispatchEvent(s)}}}return this},this.fadeTo=function(t,n,r){function i(){setTimeout(function(){s<t&&u.volume<t?(u.setVolume(u.volume+=1),i()):s>t&&u.volume>t?(u.setVolume(u.volume-=1),i()):r instanceof Function&&r.apply(u)},o)}if(!l)return this;n instanceof Function?(r=n,n=e.defaults.duration):n=n||e.defaults.duration;var s=this.volume,o=n/Math.abs(s-t),u=this;return this.play(),this.whenReady(function(){i()}),this},this.fadeIn=function(e,t){return l?this.setVolume(0).fadeTo(100,e,t):this},this.fadeOut=function(e,t){return l?this.fadeTo(0,e,t):this},this.fadeWith=function(
e,t){return l?(this.fadeOut(t,function(){this.stop()}),e.play().fadeIn(t),this):this},this.whenReady=function(e){if(!l)return null;var t=this;this.sound.readyState===0?this.bind("canplay.buzzwhenready",function(){e.call(t)}):e.call(t)};if(l&&t){for(var c in e.defaults)e.defaults.hasOwnProperty(c)&&(n[c]=n[c]||e.defaults[c]);this.sound=o.createElement("audio");if(t instanceof Array)for(var h in t)t.hasOwnProperty(h)&&s(this.sound,t[h]);else if(n.formats.length)for(var p in n.formats)n.formats.hasOwnProperty(p)&&s(this.sound,t+"."+n.formats[p]);else s(this.sound,t);n.loop&&this.loop(),n.autoplay&&(this.sound.autoplay="autoplay"),n.preload===!0?this.sound.preload="auto":n.preload===!1?this.sound.preload="none":this.sound.preload=n.preload,this.setVolume(n.volume),e.sounds.push(this)}},group:function(e){function t(){var t=n(null,arguments),r=t.shift();for(var i=0;i<e.length;i++)e[i][r].apply(e[i],t)}function n(e,t){return e instanceof Array?e:Array.prototype.slice.call(t)}e=n(e,arguments),this
.getSounds=function(){return e},this.add=function(t){t=n(t,arguments);for(var r=0;r<t.length;r++)e.push(t[r])},this.remove=function(t){t=n(t,arguments);for(var r=0;r<t.length;r++)for(var i=0;i<e.length;i++)if(e[i]==t[r]){e.splice(i,1);break}},this.load=function(){return t("load"),this},this.play=function(){return t("play"),this},this.togglePlay=function(){return t("togglePlay"),this},this.pause=function(e){return t("pause",e),this},this.stop=function(){return t("stop"),this},this.mute=function(){return t("mute"),this},this.unmute=function(){return t("unmute"),this},this.toggleMute=function(){return t("toggleMute"),this},this.setVolume=function(e){return t("setVolume",e),this},this.increaseVolume=function(e){return t("increaseVolume",e),this},this.decreaseVolume=function(e){return t("decreaseVolume",e),this},this.loop=function(){return t("loop"),this},this.unloop=function(){return t("unloop"),this},this.setTime=function(e){return t("setTime",e),this},this.set=function(e,n){return t("set"
,e,n),this},this.bind=function(e,n){return t("bind",e,n),this},this.unbind=function(e){return t("unbind",e),this},this.bindOnce=function(e,n){return t("bindOnce",e,n),this},this.trigger=function(e){return t("trigger",e),this},this.fade=function(e,n,r,i){return t("fade",e,n,r,i),this},this.fadeIn=function(e,n){return t("fadeIn",e,n),this},this.fadeOut=function(e,n){return t("fadeOut",e,n),this}},all:function(){return new e.group(e.sounds)},isSupported:function(){return!!e.el.canPlayType},isOGGSupported:function(){return!!e.el.canPlayType&&e.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!e.el.canPlayType&&e.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!e.el.canPlayType&&e.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!e.el.canPlayType&&(e.el.canPlayType("audio/x-m4a;")||e.el.canPlayType("audio/aac;"))},toTimer:function(e,t){var n,r,i;return n=Math.floor(e/3600),n=isNaN(n)?"--":n>=10?n:"0"+n,r=t?Math.floor(e/60%60
):Math.floor(e/60),r=isNaN(r)?"--":r>=10?r:"0"+r,i=Math.floor(e%60),i=isNaN(i)?"--":i>=10?i:"0"+i,t?n+":"+r+":"+i:r+":"+i},fromTimer:function(e){var t=e.toString().split(":");return t&&t.length==3&&(e=parseInt(t[0],10)*3600+parseInt(t[1],10)*60+parseInt(t[2],10)),t&&t.length==2&&(e=parseInt(t[0],10)*60+parseInt(t[1],10)),e},toPercent:function(e,t,n){var r=Math.pow(10,n||0);return Math.round(e*100/t*r)/r},fromPercent:function(e,t,n){var r=Math.pow(10,n||0);return Math.round(t/100*e*r)/r}};return e}),define("DE.AudioManager",["DE.CONFIG","buzz"],function(e,t){var n=new function(){this.DEName="AudioManager",this.muted=!1,this.volume=40,this.loadAudios=function(e){this.music.volume=this.volume,this.fx.volume=this.volume*.75;for(var n=0;n<e.length;++n){var r=e[n],i={};i.name=r[0],i.preload=r[3].preload,i.loop=r[3].loop,i.formats=r[2].formats,i.sound=new t.sound(r[1],{formats:r[2],preload:r[3].preload||!1,loop:r[3].loop||!1}),r[3].isMusic?this.music.add(i):this.fx.add(i)}this.setVolume(this.volume
)},this.mute=function(){this.music.mute(),this.fx.mute(),this.muted=!0},this.unmute=function(){this.music.unmute(),this.fx.unmute(),this.muted=!1},this.toggle=function(){this.muted?this.unmute():this.mute()},this.setVolume=function(e,t){t=="+"?this.volume+=e:t=="-"?this.volume-=e:this.volume=e,this.checkVolume();var n=this.volume;this.music.setVolume(n);var r=this.volume*.75;this.fx.setVolume(r)},this.checkVolume=function(){this.volume=(this.volume>100?100:this.volume)>>0,this.volume=(this.volume<0?0:this.volume)>>0},this.music=new function(){var e={};this.volume=80,this.muted=!1,this.currentPlayed="",this.get=function(t){return e[t]},this.add=function(t){e[t.name]=t},this.stopAllAndPlay=function(t,n){if(!n)var n=!1;if(!e[t]||!e[t].sound)return;for(var r in e){if(!this.muted&&(r==t||r==n))continue;e[r].sound.stop()}if(this.muted)return;if(!e[t].sound.isPaused())return;this.currentPlayed=t,e[t].sound.setTime(0),e[t].sound.play(),e[t].sound.setVolume(this.volume),e[t].sound.loop()},this.pauseAllAndPlay=
function(t){for(var n in e)e[n].sound.isPaused()||e[n].sound.pause();if(this.muted)return;this.currentPlayed=t,e[t].sound.play(),e[t].sound.setVolume(this.volume)},this.mute=function(){this.muted=!0;for(var t in e)e[t].sound.stop()},this.unmute=function(){this.muted=!1,this.stopAllAndPlay(this.currentPlayed)},this.setVolume=function(t){this.volume=t||0;for(var n in e)e[n].sound.setVolume(this.volume)}},this.fx=new function(){var e={};this.volume=80,this.muted=!1,this.get=function(t){return e[t]},this.add=function(t){e[t.name]=t},this.play=function(t){if(this.muted)return;e[t].sound.isPaused()||e[t].sound.stop(),e[t].sound.play()},this.mute=function(){this.muted=!0;for(var t in e)e[t].sound.stop()},this.unmute=function(){this.muted=!1},this.setVolume=function(t){this.volume=t||0;for(var n in e)e[n].sound.setVolume(this.volume)}}};return e.debug.log("AudioManager loaded",3),n}),define("DE.Gui",["DE.CONFIG","DE.COLORS","DE.Inputs","DE.CanvasBuffer"],function(e,t,n,r){function i(s,o){if(!s)
throw new Error("Gui :: You have to pass at least a camera to instantiate -- see the doc");o=o||{},this.id=o.id||undefined,this.isVisible=o.isVisible||!0,this.opacity=o.opacity||1,this.components=o.components||{};var u=new r(s.renderSizes.width,s.renderSizes.height);this.needUpdate=!0,this.update=function(e){if(this.needUpdate)for(var t in i.components){var n=i.components[t];typeof n.update!="undefined"&&n.update(e)}},this.render=function(n,r,i,s,o){if(this.needUpdate){for(var a in this.components){if(!this.components[a].enable){this.components[a].isDisable||this.components[a].clearMe(u.ctx);continue}this.components[a].oRender(u.ctx,i)}e.DEBUG&&(u.ctx.fillStyle=t.DEBUG.GUI,u.ctx.fillText("GUI "+this.id,20,u.canvas.height-20)),this.needUpdate=!1}var f=n.globalAlpha;n.globalAlpha=this.opacity,n.drawImage(u.canvas,-i.width*i.scaleX*s*.5>>0,-i.height*i.scaleY*s*.5>>0,i.width*i.scaleX*s>>0,i.height*i.scaleY*s>>0),n.globalAlpha=f},this.add=function(t){this.components[t.id]&&(e.debug.log("%cComponent override an older:: "+
t.id,1,"color:orange"),delete this.components[t.id]),this.components[t.id]=t,this.components[t.id].gui=this},this.remove=function(t){if(!this.components[t]){e.debug.log("%cComponent "+t+" couldn't be found",1,"color:orange");return}this.components[t].gui=null,delete this.components[t]},this.onMouseMove=function(e){for(var t in this.components){if(!this.components[t].enable)continue;var n=this.components[t];if(n.checkState&&n.checkState(e))return n.onMouseMove(e),!0}return!1},this.onMouseDown=function(e){for(var t in this.components){if(!this.components[t].enable)continue;var n=this.components[t];if(n.checkState&&n.checkState(e))return n.onMouseDown(e),n.isClicked=!0,!0}return!1},this.onMouseUp=function(e){for(var t in this.components){if(!this.components[t].enable)continue;var n=this.components[t];if(n.checkState&&n.checkState(e))return n.isClicked=!1,n.onMouseUp(e),!0}return!1},this.onMouseClick=function(e){for(var t in this.components){if(!this.components[t].enable)continue;var r=this
.components[t];typeof r.checkState!="undefined"&&(this.isFocus=r.checkState(n.mouse,!0))}},this.onKeyDown=function(e){for(var t in i.components){if(!i.components[t].enable)continue;var n=i.components[t];typeof n.onKeyDown!="undefined"&&n.onKeyDown(e)}}}return i.isFocus=!1,i.components={},i.prototype.DEName="Gui",e.debug.log("Gui loaded",3),i}),define("DE.BaseGui",["DE.CONFIG","DE.COLORS","DE.Vector2","DE.Sizes"],function(e,t,n,r){function i(i){if(!i)throw new Error("BaseGui :: You have to pass arguments object to instantiate -- see the doc");if(i.ignore)return;this.gui=null,this.id=i.id||i.name||Date.now()+Math.random()*Date.now()>>0,this.name=i.name||null,this.enable=i.enable===!1?!1:!0,this.isDisable=!1,i.scaleX=i.scale||i.scaleX||i.scalex||1,i.scaleY=i.scale||i.scaleY||i.scaley||1,this.position=new n(i.x||i.posX||i.posx||i.X||0,i.y||i.posY||i.posy||i.Y||0),this.sizes=new r(i.width||i.w||e.DEFAULT_SIZES.GUI.WIDTH,i.height||i.h||e.DEFAULT_SIZES.GUI.HEIGHT,i.scaleX,i.scaleY),this.isOver=!1
,this.isClicked=!1,this.onMouseUp=function(){},this.onMouseMove=function(){},this.onMouseDown=function(){},this.oRender=function(n){this.isDisable=!1,n.clearRect(this.position.x,this.position.y,this.sizes.width*this.sizes.scaleX,this.sizes.height*this.sizes.scaleY),this.render(n),e.DEBUG&&(n.fillStyle=t.DEBUG.X_AXIS,n.fillRect(this.position.x,this.position.y,20,2),n.fillStyle=t.DEBUG.Y_AXIS,n.fillRect(this.position.x,this.position.y,2,20),n.strokeStyle=t.DEBUG.GUI,n.strokeRect(this.position.x+1,this.position.y+1,this.sizes.width*this.sizes.scaleX-2,this.sizes.height*this.sizes.scaleY-2))},this.clearMe=function(e){this.isDisable=!0,e.clearRect(this.position.x,this.position.y,this.sizes.width*this.sizes.scaleX,this.sizes.height*this.sizes.scaleY)},this.render=function(e,t,n){},this.checkState=function(e,t){return e.x>=this.position.x&&e.x<=this.position.x+this.sizes.width&&e.y>=this.position.y&&e.y<=this.position.y+this.sizes.height?(this.isOver=!0,this.gui.needUpdate=!0,!0):(this.isOver&&
(this.isOver=!1,this.gui.needUpdate=!0),this.isClicked=0,!1)},this.hide=function(){this.enable&&(this.gui.needUpdate=!0),this.enable=!1},this.show=function(){this.enable||(this.gui.needUpdate=!0),this.enable=!0},this.toggle=function(){this.enable=Game.camera.gui.components["Click me plz"].enable^1,this.gui.needUpdate=!0}}return i.prototype.DEName="BaseGui",i}),define("DE.GuiButton",["DE.CONFIG","DE.COLORS","DE.BaseGui","DE.Vector2","DE.TextRenderer","DE.SpriteRenderer"],function(e,t,n,r,i,s){function o(t){if(!t)throw new Error("GuiButton :: You have to pass arguments object to instantiate -- see the doc");n.call(this,t),this.sizes.width==e.DEFAULT_SIZES.GUI.WIDTH&&(this.sizes.width=e.DEFAULT_SIZES.BUTTON.WIDTH),this.sizes.height==e.DEFAULT_SIZES.GUI.HEIGHT&&(this.sizes.height=e.DEFAULT_SIZES.BUTTON.HEIGHT),this.noChangeOnRelease=t.noChangeOnRelease||!1,this.buffer=null,this.padding=new r(t.padding||t.paddingX||5,t.padding||t.paddingY||5),this.text=t.text||undefined,this.fontSize=t.fontSize||
e.DEFAULT_SIZES.BUTTON.FONT_SIZE,this.textOffsets=new r(t.width*.5||e.DEFAULT_SIZES.BUTTON.WIDTH*.5,t.height*.5+e.DEFAULT_SIZES.BUTTON.OFFSET_TOP||e.DEFAULT_SIZES.BUTTON.HEIGHT*.5+e.DEFAULT_SIZES.BUTTON.OFFSET_TOP),this.currentState=0,this.maxState=3,this.init=function(e){this.buffer=document.createElement("canvas"),this.buffer.width=this.sizes.width*this.maxState,this.buffer.height=this.sizes.height,this.buffer.context=this.buffer.getContext("2d"),this.buffer.context.clearRect(0,0,this.buffer.width,this.buffer.height);var t;if(e.spriteName){t=new s({spriteName:e.spriteName,width:this.sizes.width,height:this.sizes.height}),t.localPosition.x+=this.sizes.width*.5,t.localPosition.y+=this.sizes.height*.5;var n=t.endFrame>this.maxState?this.maxState:t.endFrame;for(var r=0;r<this.maxState;r++)r<n&&t.setFrame(r),t.render(this.buffer.context,1),t.localPosition.x+=this.sizes.width}else for(var r=0,o=0;r<this.maxState;r++)this.buffer.context.fillStyle="rgb(100,"+(70+70*r)+",100)",this.buffer.context
.fillRect(o,0,this.sizes.width,this.sizes.height),o+=this.sizes.width;if(this.text!=undefined){e.textRenderer||(e.textRenderer=new i({fillColor:e.fillColor||undefined,strokeColor:e.strokeColor||undefined,fontSize:this.fontSize,x:this.padding.x,y:this.padding.y,offsetX:0,offsetY:0},this.sizes.width-this.padding.x*2,this.sizes.height-this.padding.x*2,this.text)),e.textOverRenderer||(e.textOverRenderer=e.textRenderer),e.textClickRenderer||(e.textClickRenderer=e.textRenderer);var o=this.sizes.width;e.textRenderer.render(this.buffer.context,1),e.textOverRenderer.localPosition.x+=o,e.textOverRenderer.render(this.buffer.context,1),e.textClickRenderer.localPosition.x+=o,e.textClickRenderer.render(this.buffer.context,1)}},this.render=function(e){this.currentState=0,this.isClicked?this.currentState=2:this.isOver&&(this.currentState=1),e.clearRect(this.position.x,this.position.y,this.sizes.width,this.sizes.height),e.drawImage(this.buffer,this.currentState*this.sizes.width,0,this.sizes.width,this.sizes
.height,this.position.x,this.position.y,this.sizes.width,this.sizes.height)},this.init(t)}return o.prototype=new n({ignore:!0}),o.prototype.constructor=n,o.prototype.supr=n.prototype,o.prototype.DEName="GuiButton",o}),define("DE.GuiLabel",["DE.CONFIG","DE.BaseGui","DE.TextRenderer"],function(e,t,n){function r(e,r){if(!e)throw new Error("GuiLabel :: You have to pass arguments object to instantiate -- see the doc");t.call(this,e),this.text=r,!e.fillColor&&!e.strokeColor&&(e.fillColor="white"),e.x=this.sizes.width*.5,e.y=this.sizes.height*.5,this.renderer=new n(e,this.sizes.width,this.sizes.height,r),this.render=function(e){e.translate(this.position.x,this.position.y),e.rotate(this.position.rotation),e.clearRect(0,0,this.sizes.width*this.sizes.scaleX,this.sizes.height*this.sizes.scaleY),this.renderer.render(e,1,1),e.rotate(this.position.rotation),e.translate(-this.position.x,-this.position.y)},this.clearMe=function(e){this.isDisable=!0,e.translate(this.position.x,this.position.y),e.rotate(
this.position.rotation),e.clearRect(0,0,this.sizes.width*this.sizes.scaleX,this.sizes.height*this.sizes.scaleY),e.rotate(-this.position.rotation),e.translate(-this.position.x,-this.position.y)},this.setText=function(e){this.renderer.text=e,this.text=e,this.renderer.clearBuffer(),this.gui&&(this.gui.needUpdate=!0),this.onSetText&&this.onSetText(e)},this.onSetText=!1}return r.prototype=new t({ignore:!0}),r.prototype.constructor=t,r.prototype.supr=t.prototype,r.prototype.DEName="GuiLabel",r}),define("DE.GuiImage",["DE.CONFIG","DE.BaseGui","DE.TileRenderer","DE.SpriteRenderer"],function(e,t,n,r){function i(e,i){if(!e)throw new Error("Image :: You have to pass arguments object to instantiate -- see the doc");t.call(this,e),delete e.x,delete e.y;if(e.spriteName)this.renderer=new r(e);else{if(!e.imageName)throw new Error("[GUI IMAGE] Declaring a Gui image but can't find spriteName or imageName");this.renderer=new n(e)}this.renderer.localPosition.x=0,this.renderer.localPosition.y=0,this.render=
function(e){e.translate(this.position.x,this.position.y),this.renderer.render(e,1,1),e.translate(-this.position.x,-this.position.y)}}return i.prototype=new t({ignore:!0}),i.prototype.constructor=t,i.prototype.supr=t.prototype,i.prototype.DEName="GuiImage",i}),define("DREAM_ENGINE",["DE.CONFIG","DE.COLORS","DE.Time","DE.Vector2","DE.Sizes","DE.ImageManager","DE.CollisionSystem","DE.Collider","DE.Renderer","DE.Scene","DE.Rigidbody","DE.CanvasBuffer","DE.GameObject","DE.FixedBoxCollider","DE.OrientedBoxCollider","DE.CircleCollider","DE.BoxRenderer","DE.CircleRenderer","DE.SpriteRenderer","DE.Render","DE.MainLoop","DE.Event","DE.States","DE.Inputs","DE.Camera","DE.TextRenderer","DE.TileRenderer","DE.AudioManager","DE.Gui","DE.BaseGui","DE.GuiButton","DE.GuiLabel","DE.GuiImage","DE.LangSystem","DE.SystemDetection","DE.GamePad","DE.Screen","DE.about","DE.SaveSystem","DE.Notifications"],function(){var e={},t=Date.now();for(var n in arguments){var r=arguments[n],i=r.DEName;!i&&r.prototype&&(i=r
.prototype.DEName);if(!i){console.log("%cNo name for "+n,"color:red",arguments[n]);continue}e[i]=arguments[n],delete e[i].DEName}return e.init=function(n){window.ENGINE_SETTING=window.ENGINE_SETTING||{},e.about.set(n.about),e.SaveSystem.init(n.saveModel,n.saveIgnoreVersion),e.LangSystem.init(n.dictionary),e.SystemDetection.initSystem(n.system,n.paramsSystem||{}),e.on("udpateScreenSizes",function(e,t){this.ImageManager.pathPrefix=t.path,this.ImageManager.imageNotRatio=t.notRatio||!1,this.ImageManager.ratioToConception=e,this.ImageManager.arrayLoader(n.images.imagesList),this.MainLoop.screenChangedSizeIndex(e,t)},e),e.Screen.init(n.images),e.Screen.udpateScreenSizes(ENGINE_SETTING.quality),n.ignoreNotification||e.Notifications.init(n),e.GamePad.init(),n=n||{},n.loader=n.loader||{},n.loader.name=n.loader.name||"loader",n.loader.url=n.loader.url||"loader",n.loader.totalFrame=n.loader.totalFrame||16,n.loader.eachAnim=n.loader.eachAnim||45,n.loader.ext=n.loader.ext||"png",n.loader.isAnimated=!0
,n.loader.scale=n.loader.scale||1,e.Event.on("notisLoadingImages",function(){e.MainLoop.loader=new e.SpriteRenderer({spriteName:"loader",scale:n.loader.scale}),n.onReady?n.onReady():console.log("%cNo initialisation function given","color:red"),n.onStart?e.Event.on("isReady",function(){var r=Date.now()-t;r>=5e3?(n.onStart(),e.SystemDetection.askToRate()):(e.CONFIG.debug.log("start in ",1e3-r,"ms"),setTimeout(function(){n.onStart(),e.SystemDetection.askToRate()},1e3-r))},e,!1):console.log("%cNo start function given","color:red"),e.ImageManager.arrayLoader(n.images.imagesList),e.AudioManager.loadAudios(n.audios),e.Inputs.init(n.inputs),n.customLoop&&(e.MainLoop.customLoop=n.customLoop)},e,!1),this.ImageManager.folderName=n.images.folderName,this.ImageManager.pushImage(n.loader.name,n.loader.url,n.loader.ext,n.loader)},e.start=function(){e.States.up("isInited"),this.MainLoop.launched=!0,this.MainLoop.loop()},e.on=e.Event.on,e.deltaTime=e.Time.getDelta(),window.requestAnimationFrame||(window
.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}()),e}),require(["DREAM_ENGINE","main"],function(e,t){return t(e),e}),define("Game",["DREAM_ENGINE"],function(e){function o(r,i,s){var o=new e.GameObject({tag:"Ball",x:i,y:s,renderer:new e.CircleRenderer({method:"fillAndStroke",strokeColor:"white",fillColor:"rgb("+(Math.random()*255>>0)+","+(Math.random()*255>>0)+","+(Math.random()*255>>0)+")"},70,0,Math.PI*2,!0),collider:new e.CircleCollider(80)});o.speedx=(Math.random()*5+Math.random()*-5)*2>>0,o.speedy=(Math.random()*5+Math.random()*-5)*2>>0,o.move=function(){this.translateX(this.speedx),this.translateY(this.speedy),this.position.x>1250&&(this.speedx=-this.speedx,this.position.x=1250),this.position.x<30&&(this.speedx=-this.speedx,this.position.x=30),this.position.y>680&&(this.speedy=-this.speedy,this.position.y=680),this.
position.y<30&&(this.speedy=-this.speedy,this.position.y=30)},o.addAutomatism("move","move"),o.onMouseDown=function(t){this.askToKill(),e.SaveSystem.save("ballKilled",e.SaveSystem.get("ballKilled")+1),t.stopPropagation=!0},o.onMouseMove=function(e){},o.onKill=function(){t.enemies--,n.setText(t.enemies)},t.enemies++,n.setText(t.enemies),r.scene.add(o)}var t={};t.render=null,t.scene=null;var n=null,r=null,i=1280,s=720;return t.init=function(){console.log("init Engine"),e.CONFIG.DEBUG=1,e.CONFIG.DEBUG_LEVEL=5,t.render=new e.Render("render",{width:i,height:s,fullScreen:"ratioStretch"}),t.render.init(),e.start()},t.start=function(){console.log("hello, you killed a total of "+(e.SaveSystem.get("ballKilled")||0)+" balls"),t.scene=new e.Scene("Test"),t.camera=new e.Camera(i,s,0,0,{name:"Test zoom 100%",backgroundColor:"rgb(50,50,200)"}),t.camera.scene=t.scene,t.camera.gui=new e.Gui(t.camera,{id:"Test"}),t.render.add(t.camera),t.camera.onLastMouseDown=function(e){o(t,e.x,e.y)},t.enemies=0,n=new 
e.GuiLabel({id:"counter",x:50,y:100,w:200,h:50},"Balls"),n.onSetText=function(e){e==0&&console.log("winner")},t.camera.gui.add(n);var r=25;for(var u=0;u<r;++u)o(t,Math.random()*i,Math.random()*s);setTimeout(function(){e.States.down("isLoading")},200)},window.Game=t,t}),define("gameLoop",["DREAM_ENGINE","Game"],function(e,t){function n(e){}return n}),define("DE.imagesDatas",["DE.CONFIG"],function(e){var t={screenSizes:[{w:1280,h:720,path:""}],conceptionSizeIndex:0,folderName:"img",imagesList:[]};return e.debug.log("imagesDatas loaded",3),t}),define("DE.audiosList",["DE.CONFIG"],function(e){var t=[];return e.debug.log("audioList loaded",3),t}),define("DE.inputsList",["DE.CONFIG"],function(e){var t={};return e.debug.log("inputsList loaded",3),t}),define("DE.dictionary",["DE.CONFIG"],function(e){var t={en:{},fr:{}};return e.debug.log("dictionary loaded",3),t}),define("customizeW8",["Game"],function(e){function t(e){e.onSettings=function(){},e.elem=document.getElementById("snapped"),e.appLinkKey="_your_link_key_here_"
}return t}),define("W8",["DREAM_ENGINE","customizeW8"],function(e,t){var n=new function(){var n=null;this.appLinkKey="no_link_key",this.init=function(r){n=this;if(!WinJS)throw new Error("WinJS is not defined, a Windows8App need it !");var i=Windows.UI.ApplicationSettings.SettingsPane.getForCurrentView();i.addEventListener("commandsrequested",function(t){var r=new Windows.UI.ApplicationSettings.SettingsCommand("Options",e.LangSystem.get("settings")||"Settings",function(e){n.onSettings()});t.request.applicationCommands.append(r)}),WinJS.Application.onsettings=function(e){n.onSettingsPanel(e)},WinJS.Application.onunload=function(e){n.onUnload(e)},WinJS.Application.start(),e.LangSystem.getLang(Windows.Globalization.Language.currentInputMethodLanguageTag),window.addEventListener("resize",function(){n.checkResize()},!1),t(this)},this.onSettingsPanel=function(e){},this.onSettings=function(e){},this.onUnload=function(e){},this.onResize=function(e){},this.checkResize=function(){if(document.documentElement
.offsetWidth<330){for(var t=0,n;n=e.MainLoop.renders[t];t++)n.canvas.parentElement.previousState=n.canvas.parentElement.style.display,n.canvas.parentElement.style.display="none",n.canvas.previousState=n.canvas.style.display,n.canvas.style.display="none";this.render&&(this.render.canvas.parentElement.style.display="block",this.render.canvas.style.display="inline-block"),this.elem&&(this.elem.style.display="block"),this.onResize(!0),this.isOverridingMainLoop=!0}else if(this.isOverridingMainLoop){this.render&&(this.render.canvas.parentElement.style.display="none",this.render.canvas.style.display="none"),this.elem&&(this.elem.style.display="none");for(var t=0,n;n=e.MainLoop.renders[t];t++)n.canvas.parentElement.style.display=n.canvas.parentElement.previousState,n.canvas.style.display=n.canvas.previousState;this.onResize(!1),this.isOverridingMainLoop=!1}},this.plugToGamePadLib=function(){if(!e.GamePad)return;if(!window.GameController){console.log("%c[WARNING] Can't find W8 Gamepad component, gamepad configuration aborted"
,"color:orange");return}e.GamePad.adaptToWindowsLib(GameController,4),e.CONFIG.notifications.gamepadEnable&&e.Notifications.create(e.LangSystem.get("gamepadAvalaible")||e.CONFIG.notifications.gamepadAvalaible)},this.askToRateIf="playedOnce",this.askToRate=function(){var t=e.LangSystem.currentLang,r=this.askToRateIf!=null?e.SaveSystem.get(this.askToRateIf):!0;if(r&&!e.SaveSystem.get("rated")){var i=new Windows.UI.Popups.MessageDialog(e.LangSystem.get("askToRate")||"Don't forget rate this game if you like it !"),s,o=[e.LangSystem.get("rateYep")||"Yes",e.LangSystem.get("rateLater")||"Later",e.LangSystem.get("rateNop")||"No, never"];for(var u=0,a;u<o.length;++u)a=new Windows.UI.Popups.UICommand,a.label=o[u],a.id=u,a.invoked=function(e){s=e.id},i.commands.append(a);i.showAsync().then(function(t){if(s==1)return;s==0&&Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri("ms-windows-store:REVIEW?PFN="+n.appLinkKey)),e.SaveSystem.save("rated",!0)})}}};return n}),define("main",["gameLoop"
,"Game","DE.imagesDatas","DE.audiosList","DE.inputsList","DE.dictionary","W8"],function(e,t,n,r,i,s,o){function u(o){o.init({customLoop:e,onReady:t.init,onStart:t.start,loader:{scale:2},images:n,audios:r,inputs:i,dictionary:s})}return u});