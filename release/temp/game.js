/*
 ___ ___ ___ ___ ___ ____ ___ ___ ___ ___ ___ ____ ___ ___ ___ ___ ___ _____ ___ ___ ___ ___ ___ ____ ___ ___
/    ____    ____    ____   _____   _      _     ____   __    _   ______   _   __    _   ____                \
|   |    \  |  _ \  |  __| /  _  \ | \    / |   |  __| |  \  | | /  ____| |_| |  \  | | |  __|      <|>      |
|   | |\  | | |_\ | | |__  | |_| | |  \  /  |   | |__  |   \ | | | |  __   _  |   \ | | | |__    /|_/|\_|\   |
|   | | | | |  _ /  |  __| |  _  | |   \/   |   |  __| | |\ \| | | | |_ | | | | |\ \| | |  __|  <<---X--->>  |
|   | |/  | | | |\  | |__  | | | | | |\__/| |   | |__  | | \   | | |___|| | | | | \   | | |__    \| \|/ |/   |
|   |____/  |_| |_\ |____| |_| |_| |_|    |_|   |____| |_|  \__| \______/ |_| |_|  \__| |____|      <|>      |
\___________________________________________________________________________________________________________/

-- by Inateno aka Rogliano Antoine for Dreamirl and all HTML5 lovers --
@DreamirlGames - http://dreamirl.com
@Inateno - http://inateno.com

The Dreamengine is released under the MIT License : http://opensource.org/licenses/MIT
You can't sell the engine, but game made with could be.

The Dreamengine use:
- RequireJS (module loader)                 -->    requirejs.org
- stashJS (localStorage)    by Rezitech     -->    rezitech.github.io/stash
- buzz (audio lib)          by Jay Salvat   -->    buzz.jaysalvat.com
- hand (mouse & touch)      by David Catuhe -->    handjs.codeplex.com

DreamEngine version 0.2.1

*/

/*! Stash v1.2.4 MIT/GPL2 @rezitech */

// Licensed under the MIT license.

// Copyright (C) 2010-2013 Jay Salvat

define("DE.CONFIG",[],function(){var e={};return e.DEName="CONFIG",e.DEBUG=0,e.DEBUG_LEVEL=0,e.CLICK_DELAY=200,e.COLLISION_TYPE={ORIENTED_BOX:1,FIXED_BOX:2,CIRCLE:3},e.DEFAULT_SIZES={BUTTON:{WIDTH:120,HEIGHT:50,OFFSET_TOP:10,FONT_SIZE:25},GUI:{WIDTH:100,HEIGHT:100}},e.debug={log:function(t,n){if(e.DEBUG&&(!n||e.DEBUG_LEVEL>=n)){var r=[];for(var i in arguments)r.push(arguments[i]);r.splice(1,1),console.log.apply(console,r)}}},e.notifications={gamepadEnable:!0,gamepadAvalaible:"Gamepad avalaible !",gamepadChange:!0,achievementUnlockDuration:8e3},e.debug.log("CONFIG loaded",3),e}),define("DE.COLORS",["DE.CONFIG"],function(e){var t={};return t.DEName="COLORS",t.defaultColor="white",t.DEBUG={},t.DEBUG.GAME_OBJECT="white",t.DEBUG.GUI="purple",t.DEBUG.X_AXIS="red",t.DEBUG.Y_AXIS="rgb(0,205,0)",t.DEBUG.COLLIDER="rgb(205,20,100)",t.DEBUG.CIRCLE_COLLIDER="rgb(205,50,100)",e.debug.log("COLORS loaded",3),t}),define("DE.Event",["DE.CONFIG"],function(e){var t=new function(){this.DEName="Event"};t.callbacks=
{},t.contexts={},t.persistents={},t.on=function(e,n,r,i){t.callbacks[e]||(t.callbacks[e]=new Array,t.contexts[e]=new Array,t.persistents[e]=new Array),t.callbacks[e].push(n),t.contexts[e].push(r||window),t.persistents[e].push(i!==undefined?i:!0)},t.trigger=function(){var e=Array.prototype.slice.call(arguments),n=e.shift(),r=t.callbacks[n]||[],i=t.contexts[n]||[],s=t.persistents[n]||[];for(var o=0;o<r.length;o++)r[o].apply(i[o],e),s[o]||(delete r[o],delete i[o],delete s[o],r.splice(o,1),i.splice(o,1),s.splice(o,1),--o)},t.stopListen=function(e,t){if(!t)return delete this.callbacks[e],delete this.contexts[e],delete this.persistents[e],!0;for(var n in this.callbacks[e])if(this.callbacks[e][n]==t)return this.callbacks[e].splice(n,1),this.contexts[e].splice(n,1),this.persistents[e].splice(n,1),!0;return!1},e.debug.log("Event loaded",3),t.addEventComponents=function(e){e.callbacks={},e.contexts={}},t.addEventCapabilities=function(e){e.prototype?(e.prototype.on=n,e.prototype.trigger=r,e.prototype
.stopListen=i):(e.callbacks={},e.contexts={},e.on=n,e.trigger=r,e.stopListen=i)};var n=function(e,t,n){this.callbacks[e]||(this.callbacks[e]=[],this.contexts[e]=[]),this.callbacks[e].push(t),this.contexts[e].push(n||this)},r=function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=this.callbacks[t]||[];for(var r=0;r<n.length;++r)n[r].apply(this.contexts[t][r],e)},i=function(e,t){if(!t)return delete this.callbacks[e],delete this.contexts[e],!0;for(var n in this.callbacks[e])if(this.callbacks[e][n]==t)return this.callbacks[e].splice(n,1),this.contexts[e].splice(n,1),!0;return!1};return e.debug.log("Event classes loaded",3),t}),define("DE.Time",["DE.CONFIG","DE.Event"],function(e,t){function n(){document[i]?r.locked=!0:(r.lastCalcul=Date.now(),r.locked=!1)}var r=new function(){this.DEName="Time",this.deltaTime=1,this.missedFrame=0,this.lastCalcul=Date.now(),this.scaleDelta=1,this.currentTime=Date.now(),this.fps=0,this.FPS=30,this.frameDelay=14,this.update=function(){return this
.locked?!1:(this.currentTime=Date.now(),this.timeSinceLastFrame=this.currentTime-this.lastCalcul,this.timeSinceLastFrame<14?!1:(this.fps=Math.floor(1e3/this.timeSinceLastFrame),this.deltaTime=this.timeSinceLastFrame/14*this.scaleDelta,this.missedFrame=this.deltaTime,this.deltaTime>2&&(this.deltaTime=this.deltaTime%1,this.deltaTime<1&&(this.deltaTime+=1)),this.deltaTime<0&&(this.deltaTime+=1),this.missedFrame=this.missedFrame-this.deltaTime,this.timeSinceLastFrameScaled=(this.currentTime-this.lastCalcul)*this.scaleDelta,this.lastCalcul=this.currentTime,!0))},this.getDelta=function(){return this.deltaTime}};t.on("isInited",function(){r.deltaTime=0,r.lastCalcul=Date.now()});var i,s;return typeof document.hidden!="undefined"?(i="hidden",s="visibilitychange"):typeof document.mozHidden!="undefined"?(i="mozHidden",s="mozvisibilitychange"):typeof document.msHidden!="undefined"?(i="msHidden",s="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(i="webkitHidden",s="webkitvisibilitychange"
),typeof document.addEventListener!="undefined"&&typeof i!="undefined"&&document.addEventListener(s,n,!1),e.debug.log("Time loaded",3),r}),define("DE.Vector2",["DE.Time","DE.CONFIG"],function(e,t){function n(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0,this.rotation=0;var o=1,u=0;return this.setRotation=function(e){return this.rotation=e%(r*2),this.rotation==0?(u=0,o=1):(u=Math.sin(this.rotation),o=Math.cos(this.rotation)),this.rotation},this.setPosition=function(e,t,n){return e.x!==undefined||e.y!==undefined?(this.x=e.x!=undefined?e.x:this.x,this.y=e.y!=undefined?e.y:this.y,this.z=e.z!=undefined?e.z:this.z,this):(this.x=e!=undefined?e:this.x,this.y=t!=undefined?t:this.y,this.z=n!=undefined?n:this.z,this)},this.rotate=function(t,n){return n?this.setRotation(this.rotation+t):this.setRotation(this.rotation+t*e.deltaTime)},this.multiply=function(e){return this.x*=e,this.y*=e,this},this.translate=function(t,n,r){if(!t.x&&t.x!=0||!t.y&&t.y!=0)throw new Error(t+" is not a Vector2");return r||(t=
{x:t.x*e.deltaTime,y:t.y*e.deltaTime}),n?(this.x+=t.x,this.y+=t.y):this.rotation==0?(this.x+=t.x,this.y+=t.y):(this.x-=-t.x*o+t.y*u,this.y-=-t.x*u+t.y*-o),this},this.normalize=function(){if(this.x==0&&this.y==0)return this.x=0,this.y=0,this;var e=Math.sqrt(this.x*this.x+this.y*this.y);return this.x=this.x/e,this.y=this.y/e,this},this.getVector=function(e,t){if(!e.x&&e.x!=0||!e.y&&e.y!=0||!t.x&&t.x!=0||!t.y&&t.y!=0)throw new Error("Vector2 need two Vector2 to return getVector");return this.x=t.x-e.x,this.y=t.y-e.y,this},this.dotProduct=function(e,t){if(!e.x||!e.y)throw new Error("Vector2 need two Vector2 to return dotProduct");return t&&t.x?e.x*t.x+e.y*t.y:this.x*e.x+this.y*e.y},this.getAngle=function(e,t){return t||(t=this),Math.atan2(e.y-t.y,e.x-t.x)},this.wtfAngle=function(e,t){var r=null;t&&t.x?r=(new n(t.x,t.y)).normalize():r=(new n(this.x,this.y)).normalize();var i=(new n(e.x,e.y)).normalize();return Math.acos(i.dotProduct(r))},this.getDistance=function(e){var t=this.x-e.x;t*=t;var n=
this.y-e.y;return n*=n,Math.sqrt(t+n)>>0},this.isInRangeFrom=function(e,t){t*=t;var n=this.x-e.x;n*=n;var r=this.y-e.y;r*=r;var i=n+r;return i<=t?!0:!1},this.getHarmonics=function(e){return e?{cos:Math.cos(e+this.rotation),sin:Math.sin(e+this.rotation)}:{cos:o,sin:u}},this}var r=Math.PI;return n.prototype.DEName="Vector2",t.debug.log("Vector2 loaded",3),n}),define("DE.Sizes",["DE.CONFIG"],function(e){function t(e,t,n,r,i){if(!e||!t)throw new Error("Sizes :: You have to pass a width and height when instantiate -- see the doc");this.width=e,this.height=t,this.scaleX=n||1,this.scaleY=r||1,this.parent=i,this.setScale=function(e,t){return this._uncenter(),e.x&&e.y?(this.scaleX=e.x,this.scaleY=e.y):t?(this.scaleX=e,this.scaleY=t):(this.scaleX=e,this.scaleY=e),this._center(),this},this._center=function(){return this.parent&&!this.parent.preventCenter&&(this.parent.localPosition.x-=this.width*this.scaleX*.5>>0,this.parent.localPosition.y-=this.height*this.scaleY*.5>>0),this},this._uncenter=function(
){return this.parent&&!this.parent.preventCenter&&(this.parent.localPosition.x+=this.width*this.scaleX*.5>>0,this.parent.localPosition.y+=this.height*this.scaleY*.5>>0),this},this.scaleTo=function(e,t){return this._uncenter(),e.x&&e.y?(this.scaleX=e.x,this.scaleY=e.y):(this.scaleX=e,this.scaleY=e),this._center(),this},this.scaleXTo=function(e,t){return this._uncenter(),this.scaleX=valX,this._center(),this},this.scaleYTo=function(e){return this._uncenter(),this.scaleY=valY,this._center(),this},this.setSizes=function(e,t){return this._uncenter(),e.width?(this.width=e.width,this.height=e.height||this.height):e&&!t?(this.width=e,this.height=e):(this.width=e,this.height=t),this._center(),this}}return t.prototype.DEName="Sizes",e.debug.log("Sizes loaded",3),t}),define("DE.States",["DE.Event","DE.CONFIG"],function(e,t){var n={isLoadingImages:!1,isReady:!1,isInited:!1,isLoading:!0},r=new function(){this.DEName="States",this.up=function(r){t.debug.log("State up "+r,3),i(r,!0),e.trigger(r,!0),n[r
]=!0},this.down=function(r){t.debug.log("State down "+r,3),i(r,!1),e.trigger("not"+r,!1),n[r]=!1},this.get=function(e){return n[e]}},i=function(e,t){if(e=="isReady"||e=="isLoading")return;var i=n;(!i.isLoadingImages||e=="isLoadingImages"&&t===!1)&&(i.isInited||e=="isInited"&&t===!0)&&r.up("isReady")};return t.debug.log("states loaded",3),r}),define("DE.CanvasBuffer",["DE.CONFIG"],function(e){function t(e,t){if(!e||!t)throw new Error("CanvasBuffer :: can't instantiate a buffer with a width or a height 0 -- see the doc");this.canvas=document.createElement("canvas"),this.canvas.width=e,this.canvas.height=t,this.ctx=this.canvas.getContext("2d"),this.ctx.mozImageSmoothingEnabled=!0,this.ctx.webkitImageSmoothingEnabled=!0,this.resize=function(e,t){return this.canvas.width=e,this.canvas.height=t,this},this.clear=function(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this}}return t.prototype.DEName="CanvasBuffer",e.debug.log("CanvasBuffer loaded",3),t}),define("DE.ImageManager"
,["DE.CONFIG","DE.States","DE.Event","DE.CanvasBuffer"],function(e,t,n,r){var i=new function(){this.DEName="ImageManager",this.images={},this.imagesLoaded=0,this.imagesRequested=0,this.defaultImages=[],this.pathPrefix="",this.imageNotRatio=!1,this.ratioToConception=1,this.folderName="img",this.arrayLoader=function(n){if(!n){e.debug.log("%cno images loaded",1,"color:red");return}var r=n;for(var i=0,s;i<r.length;++i){s=r[i];if(!s||(s[3]||{}).load===!1)continue;this.pushImage(s[0],s[1],s[2],s[3])}n.length==0&&setTimeout(function(){t.down("isLoadingImages")},10)},this.pushImage=function(n,r,s,o){o=o||{},this.images[n]=new Image;var u=this.images[n];u.src=this.folderName+"/"+this.pathPrefix+r+"."+s,u.name=n,u.totalFrame=o.totalFrame||1,u.startFrame=o.startFrame||undefined,u.endFrame=o.endFrame||undefined,u.totalLine=o.totalLine||1,u.eachAnim=o.eachAnim||0,u.isReversed=o.isReversed||!1,u.isAnimated=o.isAnimated||!1,u.isPaused=o.isPaused||!1,u.isLoop=o.isLoop!=undefined?o.isLoop:!0,u.notRatio=
o.notRatio||!1,u.totalFrame<=1&&(u.isAnimated=!1),u.onload=function(){i.imageLoaded(this)},this.imagesRequested++,t.up("isLoadingImages"),e.debug.log("LoadImage "+n,3)},this.imageLoaded=function(i){e.debug.log("Image:"+i.name+" correctly loaded",3);var s=new r(i.width,i.height),o=s.canvas,u=s.ctx;if(this.imageNotRatio||i.notRatio)o.width=o.width*this.ratioToConception,o.height=o.height*this.ratioToConception;o.name=i.name,o.totalFrame=i.totalFrame,o.totalLine=i.totalLine,o.startFrame=i.startFrame||undefined,o.endFrame=i.endFrame||undefined,o.eachAnim=i.eachAnim,o.isReversed=i.isReversed,o.isAnimated=i.isAnimated,o.isPaused=i.isPaused,o.isLoop=i.isLoop,o.widthFrame=o.width/o.totalFrame>>0,o.heightFrame=o.height/o.totalLine>>0,u.drawImage(i,0,0,o.width,o.height),this.images[i.name]=o,this.imagesLoaded++,this.imagesLoaded==this.imagesRequested&&t.down("isLoadingImages"),n.trigger("imageLoaded",this.imagesLoaded,this.imagesRequested,i.name)}};return e.debug.log("ImageManager loaded",3),i}),
define("DE.CollisionSystem",["DE.CONFIG"],function(e){var t=new function(){this.DEName="CollisionSystem",this.pointFixedBoxCollision=function(e,t,n){if(!t.enable)return!1;var r=t.getRealPosition?t.getRealPosition():{x:t.x,y:t.y,z:0},i=1;return e.scenePosition!==undefined&&(!n||!n.prevent3D)&&e.scenePosition.z!=r.z&&(i=10/(r.z-e.scenePosition.z),i!=1&&(r.x=(r.x-(e.scenePosition.x+e.fieldSizes.width*.5))*i+(e.scenePosition.x+e.fieldSizes.width*.5),r.y=(r.y-(e.scenePosition.y+e.fieldSizes.height*.5))*i+(e.scenePosition.y+e.fieldSizes.height*.5))),e.x>=r.x&&e.x<r.x+t.width*i&&e.y>=r.y&&e.y<r.y+t.height*i?!0:!1},this.fixedBoxCollision=function(e,t,n){if(!e.enable||!t.enable)return!1;var r=e.getRealPosition?e.getRealPosition():{x:e.x,y:e.y},i=t.getRealPosition?t.getRealPosition():{x:t.x,y:t.y};if(n&&n.convert3D&&r.z!=i.z){if(!n.camera)return console.log("Error: you have to pass a camera to convert 3D position to 2D position - fixedBoxCollision"),!1;var s=10/(r.z-n.camera.scenePosition.z);s!=1&&
(r.x=(r.x-(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5))*s+(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5),r.y=(r.y-(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5))*s+(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5)),s=10/(i.z-n.camera.scenePosition.z),s!=1&&(i.x=(i.x-(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5))*s+(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5),i.y=(i.y-(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5))*s+(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5))}else if((!n||!n.prevent3D)&&r.z>>0!=i.z>>0)return!1;return i.x>=r.x+e.width||i.x+t.width<=r.x||i.y>=r.y+e.height||i.y+t.height<=r.y?!1:!0},this.pointCircleCollision=function(e,t,n){if(!t.enable)return!1;var r=t.getRealPosition(),i=1;e.scenePosition!==undefined&&(!n||!n.prevent3D)&&e.scenePosition.z!=r.z&&(i=10/(r.z-e.scenePosition.z),i!=1&&(r.x=(r.x-(e.scenePosition.x+e.fieldSizes.width*.5))*i+(e.scenePosition.x+e.fieldSizes.width*.5),r.y=(r.y-(e.scenePosition
.y+e.fieldSizes.height*.5))*i+(e.scenePosition.y+e.fieldSizes.height*.5)));var s=(e.x-r.x)*(e.x-r.x)+(e.y-r.y)*(e.y-r.y);return s>t.radius*i*t.radius*i?!1:!0},this.circleCollision=function(e,t,n){if(!e.enable||!t.enable)return!1;var r=e.getRealPosition(),i=t.getRealPosition();if(n&&n.convert3D&&r.z!=i.z){if(!n.camera)return console.log("Error: you have to pass a camera to convert 3D position to 2D position - fixedBoxCollision"),!1;var s=10/(r.z-n.camera.scenePosition.z);s!=1&&(r.x=(r.x-(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5))*s+(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5),r.y=(r.y-(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5))*s+(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5)),s=10/(i.z-n.camera.scenePosition.z),s!=1&&(i.x=(i.x-(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5))*s+(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5),i.y=(i.y-(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5))*s+(n.camera.scenePosition.y+n.camera
.fieldSizes.height*.5))}else if((!n||!n.prevent3D)&&r.z>>0!=i.z>>0)return!1;var o=(t.radius+e.radius)*(t.radius+e.radius),u=(i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y);return u<o?!0:!1},this.orientedBoxCollision=function(e,t,n){if(!e.enable||!t.enable)return!1;var r=e.getRealPosition(),i=t.getRealPosition();if(n&&n.convert3D&&r.z!=i.z){if(!n.camera)return console.log("Error: you have to pass a camera to convert 3D position to 2D position - fixedBoxCollision"),!1;var s=10/(r.z-n.camera.scenePosition.z);s!=1&&(r.x=(r.x-(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5))*s+(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5),r.y=(r.y-(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5))*s+(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5)),s=10/(i.z-n.camera.scenePosition.z),s!=1&&(i.x=(i.x-(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5))*s+(n.camera.scenePosition.x+n.camera.fieldSizes.width*.5),i.y=(i.y-(n.camera.scenePosition.y+n.camera.fieldSizes.height*.5))*s+(n.camera
.scenePosition.y+n.camera.fieldSizes.height*.5))}else if((!n||!n.prevent3D)&&r.z>>0!=i.z>>0)return!1;var o=e.getExternCircle(),u=t.getExternCircle(),a=o.radius+u.radius;a*=a;var f=(i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y);return f>a?!1:!0},this.fixedBoxWithOrientedBoxCollision=function(e,t){},this.orientedBoxWithCircleCollision=function(e,t){},this.fixedBoxWithCircleCollision=function(e,t){},this.checkCollisionWith=function(t,n,r){if(n.type==t.type){switch(t.type){case e.COLLISION_TYPE.FIXED_BOX:return this.fixedBoxCollision(t,n,r);case e.COLLISION_TYPE.CIRCLES:return this.circleCollision(t,n,r);case e.COLLISION_TYPE.ORIENTED_BOX:return this.orientedBoxCollision(t,n,r)}return null}if(!t.type||!n.type){var i=t,s=n;n.type||(i=n,s=t);switch(s.type){case e.COLLISION_TYPE.CIRCLE:return this.pointCircleCollision(i,s,r);case e.COLLISION_TYPE.FIXED_BOX:return this.pointFixedBoxCollision(i,s,r)}return null}return n.type==e.COLLISION_TYPE.ORIENTED_BOX&&t.type==e.COLLISION_TYPE.FIXED_BOX?this.fixedBoxWithOrientedBoxCollision
(t,n,r):n.type==e.COLLISION_TYPE.FIXED_BOX&&t.type==e.COLLISION_TYPE.ORIENTED_BOX?this.fixedBoxWithOrientedBoxCollision(n,t,r):n.type==e.COLLISION_TYPE.CIRCLE&&t.type==e.COLLISION_TYPE.ORIENTED_BOX?this.orientedBoxWithCircleCollision(t,n,r):n.type==e.COLLISION_TYPE.ORIENTED_BOX&&t.type==e.COLLISION_TYPE.CIRCLE?this.orientedBoxWithCircleCollision(n,t,r):n.type==e.COLLISION_TYPE.CIRCLE&&t.type==e.COLLISION_TYPE.FIXED_BOX?this.fixedBoxWithCircleCollision(t,n,r):n.type==e.COLLISION_TYPE.FIXED_BOX&&t.type==e.COLLISION_TYPE.CIRCLE?this.fixedBoxWithCircleCollision(n,t,r):null}};return e.debug.log("CollisionSystem loaded",3),t}),define("DE.Collider",["DE.Vector2","DE.CONFIG"],function(e,t){function n(t){t=t||{},this.type=t.type||undefined,this.enable=!0,this.gameObject=t.gameObject||undefined,this.localPosition=t.localPosition||new e(t.offsetX||t.offsetLeft||0,t.offsetY||t.offsetTop||0),this.isColliding=!1,this.isTrigger=t.isTrigger||!1,this.collideWith=new Array,this.getRealPosition=function()
{var e=this.gameObject.getPos(),t=this.gameObject.getHarmonics();return{x:-(-this.localPosition.x*t.cos+this.localPosition.y*t.sin)+e.x,y:-(-this.localPosition.x*t.sin+this.localPosition.y*-t.cos)+e.y,z:e.z}},this.debugRender=function(e,t,n){if(!this.debugBuffer)return;e.drawImage(this.debugBuffer.canvas,this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.debugBuffer.canvas.width*t*n>>0,this.debugBuffer.canvas.height*t*n>>0)}}return n.prototype.DEName="Collider",t.debug.log("Collider loaded",3),n}),define("DE.Renderer",["DE.COLORS","DE.Vector2","DE.CONFIG","DE.Time"],function(e,t,n,r){function i(n){n=n||{},this.gameObject=n.gameObject||undefined,this.alpha=n.alpha!==undefined?n.alpha:1,this.fillColor=n.fillColor||e.defaultColor,this.strokeColor=n.strokeColor||e.defaultColor,this.method=n.method||"fill",this.lineWidth=n.lineWidth||1,this.fillColor!=e.defaultColor&&this.strokeColor!=e.defaultColor&&!n.method&&(this.method="fillAndStroke"),this.fillColor==e.defaultColor&&this.strokeColor!=
e.defaultColor&&!n.method&&(this.method="stroke"),this.localPosition=n.localPosition||new t(n.offsetx||n.offsetX||n.left||n.x||n.offsetLeft||0,n.offsety||n.offsetY||n.top||n.y||n.offsetTop||0),this.sleep=!1,this.fadeData={from:1,to:0,duration:1e3,done:!0},this.setScale=function(e,t){if(!this.sizes)return;t=t||e,this.sizes.setScale(e,t)},this.scale=function(e,t){if(!this.sizes)return;this.setScale(this.sizes.scaleX+(e||0),this.sizes.scaleY+(t||0))}}return i.prototype={constructor:i},i.prototype.translate=function(e){this.localPosition.translate(e,!0,!0)},i.prototype.translateX=function(e){this.translate({x:e,y:0})},i.prototype.translateY=function(e){this.translate({x:0,y:e})},i.prototype.applyFade=function(){if(!this.fadeData.done){this.fadeData.stepVal=r.timeSinceLastFrame/this.fadeData.oDuration*this.fadeData.dir*this.fadeData.fadeScale,this.alpha+=this.fadeData.stepVal*r.scaleDelta,this.fadeData.duration-=r.timeSinceLastFrame*r.scaleDelta;if(this.fadeData.dir<0&&this.alpha<=this.fadeData
.to||this.fadeData.dir>0&&this.alpha>=this.fadeData.to||this.alpha<0||this.alpha>1)this.alpha=this.fadeData.to;this.fadeData.duration<=0&&(this.fadeData.done=!0,(this.alpha==1||this.alpha==0)&&this.alpha==0&&(this.sleep=!0),this.gameObject&&this.gameObject.trigger("fadeEnd",this))}},i.prototype.fade=function(e,t,n){if(t==this.alpha)return;this.sleep=!1;var r={from:e||1,to:t!=undefined?t:0,duration:n||500,oDuration:n||500,fadeScale:Math.abs(e-t),done:!1};r.dir=r.from>t?-1:1,this.alpha=e,this.fadeData=r},i.prototype.fadeTo=function(e,t){this.sleep=!1,this.fade(this.alpha,e,t)},i.prototype.fadeOut=function(e,t){this.sleep=!1,t&&(this.alpha=1),this.fade(this.alpha,0,e)},i.prototype.fadeIn=function(e,t){this.sleep=!1,t&&(this.alpha=0),this.fade(this.alpha,1,e)},i.prototype.render=function(e,t,n){},i.prototype.DEName="Renderer",n.debug.log("Renderer loaded",3),i}),define("DE.GameObject.render",["DE.CONFIG","DE.COLORS","DE.Time"],function(e,t,n){function r(n,r,i,s,o){if(!this.enable)return;var u=
o||10/(this.position.z-i.z),a=0,f=0;if(this.renderers.length==0&&this.childrens.length==0&&!e.DEBUG)return;this.parent?n.translate(this.position.x*r*u>>0,this.position.y*r*u>>0):(a=(this.position.x-(i.x+s.width*.5))*u,f=(this.position.y-(i.y+s.height*.5))*u,n.translate((a+s.width*.5)*r>>0,(f+s.height*.5)*r>>0)),n.rotate(this.position.rotation);for(var l=0,c;c=this.renderers[l];++l){if(c.sleep)continue;c.render(n,r,u),c.applyFade()}e.DEBUG_LEVEL>1&&(n.fillStyle=t.DEBUG.GAME_OBJECT,n.fillRect(0,0,1,1),n.fillStyle=t.DEBUG.X_AXIS,n.fillRect(0,0,20*r,2),n.fillStyle=t.DEBUG.Y_AXIS,n.fillRect(0,0,2,20*r),this.collider!==null&&this.collider.debugRender(n,r,u));var h;for(l=0;h=this.childrens[l];++l)h.render(n,r,i,s,u);n.rotate(-this.position.rotation),this.parent?n.translate(-this.position.x*r*u>>0,-this.position.y*r*u>>0):n.translate(-(a+s.width*.5)*r>>0,-(f+s.height*.5)*r>>0)}return e.debug.log("GameObject.render loaded",3),r}),define("DE.GameObject.update",["DE.CollisionSystem","DE.CONFIG","DE.Time"
],function(e,t,n){function r(e){if(!this.enable)return;for(var t in this.automatism){var r=this.automatism[t];if(r.interval&&e-r.lastCall<r.interval/n.scaleDelta)continue;r.lastCall=e,this[r.methodName](r.value1,r.value2),r.persistent||delete this.automatism[t]}for(var i=0;child=this.childrens[i];i++)child.update(e);this.applyFocus(),this.applyShake(),this.applyMove();if(!this.isMoved||!this.collider)return}return t.debug.log("GameObject.update loaded",3),r}),define("DE.GameObject",["DE.Vector2","DE.GameObject.render","DE.GameObject.update","DE.CONFIG","DE.Sizes","DE.Event","DE.Time"],function(e,t,n,r,i,s,o){function u(t){t=t||{},this.id=t.id||Math.random()*999999999>>0,this.name=t.name,this.tag=t.tag,this.enable=!0,this.scene=null,this.killArgs={},this.sceneIndex=0,this.parent=t.parent||undefined,this.zindex=t.zindex||0,this.cursorOnOver=t.cursorOnOver||!1,this.childrens=t.childrens||new Array,this.position=t.position||new e(t.x||0,t.y||0,t.z||0),this.automatism={},this.flag=null,this.
indexMouseOver=[0,0,0,0,0,0,0,0,0,0,0,0],this.isMoved=!1,this.biggerOffset=new i(1,1,1,1),this.renderer=undefined,this.renderers=new Array;if(t.renderers&&t.renderers.length>0)for(var n=0,r;r=t.renderers[n];++n)this.addRenderer(r);t.renderer&&this.addRenderer(t.renderer),this.collider=null,t.collider&&this.setCollider(t.collider),this.rigidbody=t.rigidbody||undefined,this.rigidbody&&this.rigidbody.gameObject!=this&&(this.rigidbody.gameObject=this),this.shakeData={done:!0,prevX:0,prevY:0},this.moveData={done:!0};if(t.create)for(var n in t.create)this[n]||(this[n]=t.create[n]);s.addEventComponents(this)}var a=Math.PI;return u.prototype={constructor:u},u.prototype.shake=function(e,t,n,r){this.shakeData={duration:n||500,xRange:e,yRange:t,prevX:this.shakeData?this.shakeData.prevX:0,prevY:this.shakeData?this.shakeData.prevY:0,callback:r}},u.prototype.applyShake=function(){if(this.shakeData.done)return;var e=this.shakeData;this.position.x-=e.prevX,this.position.y-=e.prevY,e.duration-=o.timeSinceLastFrame*
o.scaleDelta;if(e.duration<=0){e.callback&&e.callback.call(this,e.callback),e.done=!0,e.prevX=0,e.prevY=0,this.trigger("shakeEnd");return}e.prevX=-(Math.random()*e.xRange)+Math.random()*e.xRange>>0,e.prevY=-(Math.random()*e.yRange)+Math.random()*e.yRange>>0,this.position.x+=e.prevX,this.position.y+=e.prevY},u.prototype.moveTo=function(e,t,n,r){var i=this.position;this.moveData={distX:-(i.x-(e.x!==undefined?e.x:i.x)),distY:-(i.y-(e.y!==undefined?e.y:i.y)),distZ:-(i.z-(e.z!==undefined?e.z:i.z)),dirX:i.x>e.x?1:-1,dirY:i.y>e.y?1:-1,dirZ:i.z>e.z?1:-1,duration:t||500,oDuration:t||500,curveName:r||"linear",done:!1,stepValX:0,stepValY:0,stepValZ:0,destX:e.x,destY:e.y,destZ:e.z,callback:n},this.moveData.leftX=this.moveData.distX,this.moveData.leftY=this.moveData.distY,this.moveData.leftZ=this.moveData.distZ},u.prototype.applyMove=function(){if(this.moveData.done)return;var e=this.moveData;e.distX!=0&&(e.stepValX=o.timeSinceLastFrame/e.oDuration*e.distX*o.scaleDelta,e.leftX-=e.stepValX,this.position
.x+=e.stepValX),e.distY!=0&&(e.stepValY=o.timeSinceLastFrame/e.oDuration*e.distY*o.scaleDelta,e.leftY-=e.stepValY*e.dirY,this.position.y+=e.stepValY),e.distZ!=0&&(e.stepValZ=o.timeSinceLastFrame/e.oDuration*e.distZ*o.scaleDelta,e.leftZ-=e.stepValZ*e.dirZ,this.position.z+=e.stepValZ),e.duration-=o.timeSinceLastFrame*o.scaleDelta,e.dirX<0&&e.leftX<0?this.position.x+=e.leftX:e.dirX>0&&e.leftX>0&&(this.position.x-=e.leftX),e.dirY<0&&e.leftY<0?this.position.y+=e.leftY:e.dirY>0&&e.leftY>0&&(this.position.y-=e.leftY),e.dirZ<0&&e.leftZ<0?this.position.z+=e.leftZ:e.dirZ>0&&e.leftZ>0&&(this.position.z-=e.leftZ);if(e.duration<=0){this.moveData.done=!0,this.position.setPosition(e.destX||this.position.x,e.destY||this.position.y,e.destZ||this.position.z),e.callback&&e.callback.call(this,e.callback),this.trigger("moveEnd");return}},u.prototype.focus=function(e,t){t=t||{},this.target=e,this.focusLock=t.lock||{},this.focusOffset=t.offsets||{x:0,y:0}},u.prototype.applyFocus=function(){if(!this.target)return;
var e=this.target.position;this.target.getPos&&(e=this.target.getPos()),e||(e=this.target.scenePosition),this.focusLock.x||(this.position.x=e.x+(this.focusOffset.x||0)),this.focusLock.y||(this.position.y=e.y+(this.focusOffset.y||0))},u.prototype.translate=function(e,t){this.moved(),t=t||!1,this.position.translate(e,t)},u.prototype.translateX=function(e,t){t=t||!1,this.translate({x:e,y:0},t)},u.prototype.translateY=function(e,t){t=t||!1,this.translate({x:0,y:e},t)},u.prototype.getPos=function(){if(this.parent){var e=this.parent.getPos(),t=this.parent.getHarmonics();return{x:-(-this.position.x*t.cos+this.position.y*t.sin)+e.x,y:-(-this.position.x*t.sin+this.position.y*-t.cos)+e.y,z:this.position.z+e.z}}return{x:this.position.x,y:this.position.y,z:this.position.z}},u.prototype.getHarmonics=function(){return this.parent?this.position.getHarmonics(this.parent.getRotation()):this.position.getHarmonics()},u.prototype.getRotation=function(){return this.parent?(this.position.rotation+this.parent
.getRotation())%(a*2):this.position.rotation%(a*2)},u.prototype.rotate=function(e){this.moved(),this.position.rotate(e)},u.prototype.lookAt=function(e){this.moved();if(this.parent){var t=this.getPos();this.position.setRotation(-Math.atan2(e.x-t.x,e.y-t.y)-(this.parent.getRotation()-Math.PI));return}this.position.setRotation(-Math.atan2(e.x-this.position.x,e.y-this.position.y)+a)},u.prototype.add=function(){var e=Array.prototype.slice.call(arguments);for(var t=0;t<e.length;++t)if(e[t].length!==undefined)for(var n=0,r=e[t].length||0;n<r;++n)this.addOne(e[t][n]);else this.addOne(e[t])},u.prototype.addOne=function(e){if(!(e instanceof u))throw new Error("DREAM_ENGINE.GameObject.add: this not inherit from GameObject, do it well please");e.parent!==undefined&&e.parent.remove(e),e.parent=this,this.childrens.push(e);if(e.renderers.length>0){var t=e.position.x,n=e.position.y;for(var r=0,i;i=e.renderers[r];++r)i.sizes?(t+i.sizes.width>this.biggerOffset.width?this.biggerOffset.width=t+i.sizes.width
:t-i.sizes.width>this.biggerOffset.width&&(this.biggerOffset.width=t-i.sizes.width),n+i.sizes.height>this.biggerOffset.height?this.biggerOffset.height=n+i.sizes.height:n-i.sizes.height>this.biggerOffset.height&&(this.biggerOffset.height=n-i.sizes.height)):i.radius&&(t+i.radius>this.biggerOffset.width?this.biggerOffset.width=t+i.radius:t-i.radius>this.biggerOffset.width&&(this.biggerOffset.width=t-i.radius),n+i.radius>this.biggerOffset.height?this.biggerOffset.height=n+i.radius:n-i.radius>this.biggerOffset.height&&(this.biggerOffset.height=n-i.radius))}},u.prototype.remove=function(e){var t=this.childrens.indexOf(e);t!==-1&&(e.parent=undefined,this.childrens.splice(t,1))},u.prototype.getChildByName=function(e,t){var n,r;for(n=0;r=this.childrens[n];n++){if(r.name===e)return r;if(t){r=r.getChildByName(e,t);if(r!==undefined)return r}}return undefined},u.prototype.bindGlobalEvent=function(e,t){if(!this.scene){console.log("%cCall bindGlobalEvent without adding the object in a scene","color:red"
);return}this.scene["on"+(t?"Last":"")+"GlobalMouse"+e][this.id]=this},u.prototype.sortChildrens=function(){this.childrens.sort(function(e,t){return t.position.z==e.position.z?e.zindex-t.zindex:t.position.z-e.position.z})},u.prototype.addRenderer=function(e){return e.gameObject=this,this.renderers.push(e),this.renderers.length==1&&(this.renderer=e),e.sizes?(e.sizes.width*e.sizes.scaleX+e.localPosition.x>this.biggerOffset.width&&(this.biggerOffset.width=e.sizes.width*e.sizes.scaleX+e.localPosition.x),e.sizes.height*e.sizes.scaleY+e.localPosition.y>this.biggerOffset.height&&(this.biggerOffset.height=e.sizes.height*e.sizes.scaleY+e.localPosition.y)):e.radius&&(e.radius+e.localPosition.x>this.biggerOffset.width&&(this.biggerOffset.width=e.radius+e.localPosition.x),e.radius+e.localPosition.y>this.biggerOffset.height&&(this.biggerOffset.height=e.radius+e.localPosition.y)),this},u.prototype.setCollider=function(e){return e.gameObject=this,this.collider=e,e.radius?(e.radius>this.biggerOffset.width&&
(this.biggerOffset.width=e.radius+e.localPosition.x),e.radius>this.biggerOffset.height&&(this.biggerOffset.height=e.radius+e.localPosition.y)):e.width&&e.height&&(e.width+e.localPosition.x>this.biggerOffset.width&&(this.biggerOffset.width=e.width+e.localPosition.x),e.height+e.localPosition.y>this.biggerOffset.height&&(this.biggerOffset.height=e.height+e.localPosition.y)),this},u.prototype.moved=function(){var e=this;while(e.parent!==undefined)e=e.parent;return e.isMoved=!0,this},u.prototype.delete=function(e){if(this.childrens[e]){this.childrens[e].killMePlease(),delete this.childrens[e],this.childrens.splice(e,1);return}var t=this.childrens.indexOf(e);if(t!==-1){e.killMePlease(),this.childrens[t]=null,this.childrens.splice(t,1);return}},u.prototype.onMouseDown=undefined,u.prototype.onMouseEnter=undefined,u.prototype.onMouseMove=undefined,u.prototype.onMouseLeave=undefined,u.prototype.onMouseClick=undefined,u.prototype.onMouseUp=undefined,u.prototype.askToKill=function(e){this.scene.cleanObjectBinding
(this),this.enable=!1,this.flag="delete",this.killArgs=e||{},!this.killArgs.preventEvents&&!this.killArgs.preventKillEvent&&(this.onKill&&this.onKill(),this.trigger("kill",this))},u.prototype.onKill=undefined,u.prototype.onKilled=undefined,u.prototype.killMePlease=function(){!this.killArgs.preventEvents&&!this.killArgs.preventKilledEvent&&(this.onKilled&&this.onKilled(),this.trigger("killed",this)),delete this.renderer;for(var e=0;e<this.renderers.length;++e)delete this.renderers[e],this.renderers.splice(e,1);delete this.collider;for(e=0;e<this.childrens.length;++e)this.childrens[e].killMePlease(),delete this.childrens[e],this.childrens.splice(e,1)},u.prototype.render=t,u.prototype.update=n,u.prototype.addAutomatism=function(e,t,n){n=n||{},t.type&&(console.error("You use the old way to call addAutomatism, check the doc please"),n=t,t=n.type);if(!this[t])return r.debug.log("%cCouldn't found the method "+t+" in your GameObject prototype",1,"color:red"),!1;n.interval&&(n.lastCall=Date.now(
)),n.methodName=t,n.value1=n.value1||undefined,n.value2=n.value2||undefined,n.persistent=n.persistent!=0?!0:!1,this.automatism[e]=n},u.prototype.removeAutomatism=function(e){if(!this.automatism[e]){r.debug.log("%c[RemoveAutomatism] Automatism "+e+" not found",1,"color:orange");return}delete this.automatism[e]},u.prototype.removeAutomatisms=function(){for(var e in this.automatism)delete this.automatism[e]},s.addEventCapabilities(u),u.prototype.fade=function(e,t,n){for(var r=0,i,s;i=this.renderers[r];++r)i.fade(e,t,n);for(r=0;s=this.childrens[r];++r)s.fade(e,t,n)},u.prototype.fadeTo=function(e,t){for(var n=0,r,i;r=this.renderers[n];++n)r.fadeTo(e,t);for(n=0;i=this.childrens[n];++n)i.fadeTo(e,t)},u.prototype.fadeOut=function(e,t){for(var n=0,r,i;r=this.renderers[n];++n)r.fadeOut(e,t);for(n=0;i=this.childrens[n];++n)i.fadeOut(e,t)},u.prototype.fadeIn=function(e,t){t&&this.enable==0&&(this.enable=!0);for(var n=0,r,i;r=this.renderers[n];++n)r.fadeIn(e,t);for(n=0;i=this.childrens[n];++n)i.fadeIn
(e,t)},u.prototype.DEName="GameObject",r.debug.log("GameObject loaded",3),u}),define("DE.Notifications",[],function(){var e=new function(){this.DEName="Notifications",this.notifs={},this.notifsHeight=0,this.selector="notifsContainer",this.container=null,this.templateName="notificationTemplate",this.template=null,this.defaultExpirationTime=3500,this.closeAnimationDuration=400,this.notificationClassName="notification",this.inited=!1;var e=this;this.init=function(e){e=e||{},this.selector=e.selector||this.selector,this.templateName=e.templateName||this.templateName,this.closeAnimationDuration=e.closeAnimationDuration||this.closeAnimationDuration,this.notificationClassName=e.notificationClassName||this.notificationClassName,this.container=e.container||document.getElementById(this.selector);var t=document.getElementById(this.templateName);this.template=e.template||t?t.innerHTML:null;if(!this.container||!this.template)throw new Error("Can't init Notifications without a container element AND a template -- container selector:: "+
this.selector+" -- templateName:: "+this.templateName);this.inited=!0,this.notifsHeight=this.container.offsetHeight||0,t&&document.body.removeChild(t)},this.create=function(t,n){if(!this.inited){console.log("You don't init Notifications, init it before call it");return}this.notifsHeight=this.notifsHeight<0?0:this.notifsHeight;var r=n||this.defaultExpirationTime,i=Date.now()+"-"+(Math.random()*100>>0),s=document.createElement("div");s.className=this.notificationClassName,s.innerHTML=this.template,s.getElementsByClassName("content")[0].innerHTML=t,s.id="notif"+i,this.container.appendChild(s),this.notifs[i]=s,this.notifs[i].getElementsByClassName("notifClose")[0].addEventListener("click",function(){e.remove(i)});var o=this.notifs[i].offsetHeight;this.notifsHeight+=o,this.container.style.height=this.notifsHeight+"px",this.bindRemove(i,r)},this.bindRemove=function(t,n){n=n||this.defaultExpirationTime,setTimeout(function(){e.triggerRemove(t)},n)},this.triggerRemove=function(t){if(!this.notifs
[t])return;this.notifs[t].className=this.notifs[t].className+" disapear",setTimeout(function(){e.remove(t)},this.closeAnimationDuration)},this.remove=function(e){var t=this.notifs[e].offsetHeight;this.notifsHeight-=t,this.container.style.height=this.notifsHeight+"px",this.container.removeChild(this.notifs[e]),delete this.notifs[e];return}};return e}),define("DE.LangSystem",["DE.CONFIG"],function(e){var t=new function(){this.DEName="LangSystem",this.currentLang="en",this.dictionary={},this.avalaibleLang=new Array,this.init=function(e){for(var t in e)this.dictionary[t]=e[t],this.avalaibleLang.push(t)},this.get=function(e){return this.dictionary[this.currentLang][e]||this.dictionary.en&&this.dictionary.en[e]||null},this.forceGet=function(e,t){return this.avalaibleLang.indexOf(e)==-1?null:this.dictionary[e][t]||null},this.getLang=function(e){this.currentLang=this.avalaibleLang[0],e||(e=navigator.language||navigator.browserLanguage||navigator.userLanguage||"en");for(var t in this.dictionary)
if(e.match(t)){this.currentLang=t;break}}};return e.debug.log("LangSystem loaded",3),t}),define("DE.GamePad",["DE.CONFIG","DE.Event","DE.Notifications","DE.LangSystem"],function(e,t,n,r){var i=t.addEventCapabilities,s=function(e){var t=function(){if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){var e=new Number(RegExp.$1);return e}return!1},n=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("chrome")>-1&&e.indexOf("android")==-1&&e.indexOf("iphone")==-1&&e.indexOf("ipad")==-1&&e.indexOf("ipod")==-1},r={firefox:t,chrome:n};return r[e]()},o={},u=new function(){function u(e){n.create(r.get("onGamepadConnect")||"Gamepad "+(e.gamepad.index+1)+" connected"),l[e.gamepad.index]=e.gamepad,l.length||(l.length=0),l.length++}this.DEName="GamePad";var a={},f={},l={};this.gamePadsInfos={};var c={},h=function(){},p=function(){};this.init=function(){s("chrome")||navigator.getGamepads?(e.notifications.gamepadEnable&&n.create(r.get("gamepadAvalaible")||e.notifications.gamepadAvalaible
),h=function(e){var t=navigator.getGamepads&&navigator.getGamepads()||navigator.webkitGetGamepads&&navigator.webkitGetGamepads()||[];for(var n=0;n<t.length;++n)if(t[n]){if(!c[n]||c[n]!=t[n].timestamp)c[n]=t[n].timestamp,this.handleGamePad(t[n],e)}else this.disconnectGamePad(n)},p=function(e){var t=navigator.getGamepads&&navigator.getGamepads()||navigator.webkitGetGamepads&&navigator.webkitGetGamepads()||[];for(var n=0;n<t.length;++n){var r=t[n];if(r){this.handleGamePad(r,e);continue}this.disconnectGamePad(n)}},this.updateByChange()):s("firefox")};var d=function(e){var t=["leftThumbX","leftThumbY","rightThumbX","rightThumbY"],n=["a","b","y","x","left_shoulder","right_shoulder","LeftTrigger","RightTrigger","back","start","left_thumb","right_thumb","dpad_up","dpad_down","dpad_left","dpad_right"],r={};r.index=e.controllerId,r.timestamp=e.packetNumber,r.buttons=[],r.axes=[];for(var i=0;i<n.length;++i){var s=n[i];if(s=="LeftTrigger"||s=="RightTrigger"){r.buttons[i]=e[s]/255;continue}if(e[s]){
r.buttons[i]=1;continue}r.buttons[i]=0}for(var i=0;i<t.length;++i){var s=t[i];r.axes[i]=e[s]/32767;if(s=="leftThumbY"||s=="rightThumbY")r.axes[i]*=-1}return r};this.windowsControllers=[],this.adaptToWindowsLib=function(e,t){var n=t||4;e||console.error("gamepad::adaptToWindowsLib - windowsGamepadLib is null");for(var r=0;r<n;++r)this.windowsControllers[r]=new e.Controller(r);h=function(e){var t=this.windowsControllers;for(var n=0;n<t.length;++n){var r=t[n];if(r){r=r.getState();if(r.connected){if(!c[n]||c[n]!=r.packetNumber){c[n]=r.packetNumber;var i=d(r);this.handleGamePad(i,e)}continue}this.disconnectGamePad(n)}}},p=function(e){var t=this.windowsControllers;for(var n=0;n<t.length;++n){var r=t[n];if(r){r=r.getState();if(r.connected){var i=d(r);this.handleGamePad(i,e);continue}this.disconnectGamePad(n)}}},this.update=p,this.handleDown=w},window.addEventListener("MozGamepadConnected",u,!1),window.addEventListener("gamepadconnected",u,!1),this.connectToGameLoop=function(e){e.addNonStop("gamePad"
,this)},this.handleGamePad=function(i,s){var u=i.index;this.gamePadsInfos[u]=i,a[u]&&this.handleListeners(u,i.buttons,a,s),f[u]&&this.handleListeners(u,i.axes,f,s),o[u]||(e.debug.log("Gamepad connected "+u,2),e.notifications.gamepadChange&&(this.isGamepadConnected=!0,n.create(r.get("onGamepadConnect")||"Gamepad "+(u+1)+" connected")),t.trigger("connectGamepad",u),o[u]=!0)},this.disconnectGamePad=function(i){c[i]=null,l[i]=null,this.gamePadsInfos[i]=null;if(o[i]){e.debug.log("Disconnect gamepad "+i,2);if(e.notifications.gamepadChange){this.isGamepadConnected=!1;for(var s in o)if(o[s]){this.isGamepadConnected=!0;break}n.create(r.get("onGamepadDisconnect")||"Gamepad "+(i+1)+" disconnected")}t.trigger("disconnectGamepad",i),o[i]=!1,l.length--}},this.getGamepadsLength=function(){var e=0;for(var t in o)o[t]&&++e;return e};var v=.5,m=function(e){return e<-v&&e<0||e>v&&e>0?!0:!1},g=function(e,t,n,r){m(r)&&!n.active&&(t.trigger("down"+e,r,e),n.active=!0)},y=500,b=150,w=function(e,t,n,r,i){if(m(r
)){if(!n.active)return t.trigger("down"+e,r,e),n.active=!0,n.timesTamp=i,n.diffTime=y,!0;if(n.noRate)return!0;if(n.timesTamp+n.diffTime<i)return t.trigger("down"+e,r,e),n.timesTamp=i,n.diffTime=b,!0}return!1},E=function(e,t,n,r){for(var i in n[e].listeners){var s=s=t[i].value!==undefined?t[i].value:t[i],o=n[e],u=n[e].listeners[i];if(s<.3&&s>0||s>-0.3&&s<0)s=0;s!=u.force&&o.trigger("move"+i,s,i),u.force=s;if(this.handleDown(i,o,u,s,r))continue;!m(s)&&u.active&&(o.trigger("up"+i,s,i),u.active=!1,u.count=0)}};this.handleListeners=E,this.handleGamePadAxes=function(e){for(var t in f[e.index].listeners)if(e.axes[t]>0&&!f[e.index].listeners[t]){a[e.index].trigger("down"+t),a[e.index].listeners[t]=!0;continue}};var S=function(e,t,n){e[t]||(e[t]={},e[t].listeners={},i(e[t])),typeof e[t].listeners[n]=="undefined"&&(e[t].listeners[n]={active:!0,force:0})},x=function(e,t,n,r,i,s){S(e,t,n),e[t].on(r+n,i),e[t].listeners[n].noRate=s},T=function(e,t,n,r){e[t]&&e[t].del(r+n)},N=function(e,t,n){if(!e[t])
return;T(e,t,n,"down"),T(e,t,n,"up"),T(e,t,n,"move"),delete e[t].listeners[n]},C=function(e,t){if(!e[t])return;for(var n in e[t].listeners)N(e,t,n)},k=function(e){if(!e)return;for(var t in e)C(e,t)};this.onBtnDown=function(e,t,n,r){x(a,e,t,"down",n,r)},this.onBtnMove=function(e,t,n,r){x(a,e,t,"move",n,r)},this.onBtnUp=function(e,t,n,r){x(a,e,t,"up",n,r)},this.delBtnDown=function(e,t){T(a,e,t,"down")},this.delBtnMove=function(e,t){T(a,e,t,"move")},this.delBtnUp=function(e,t){T(a,e,t,"up")},this.delBtn=function(e,t){N(a,e,t)},this.delBtnsPad=function(e){C(a,e)},this.delBtnsListeners=function(){k(a)},this.onAxeStart=function(e,t,n,r){x(f,e,t,"down",n,r)},this.onAxeMove=function(e,t,n,r){x(f,e,t,"move",n,r)},this.onAxeStop=function(e,t,n,r){x(f,e,t,"up",n,r)},this.delAxeStart=function(e,t){T(f,e,t,"down")},this.delAxeMove=function(e,t){T(f,e,t,"move")},this.delAxeStop=function(e,t){T(f,e,t,"up")},this.delAxe=function(e,t){N(f,e,t)},this.delAxesPad=function(e){C(f,e)},this.delAxesListeners=function(
){k(f)},this.delListeners=function(){k(f),k(a)},this.plugBtnToInput=function(e,t,n,r){this.onBtnDown(n,r,function(n){e.usedInputs[t].isDown=!0,e.trigger("keyDown",t,n)},!1),this.onBtnUp(n,r,function(n){e.usedInputs[t].isDown=!1,e.trigger("keyUp",t,n)},!1),this.onBtnMove(n,r,function(n){e.trigger("btnMoved",t,n)},!1)},this.plugAxeToInput=function(e,t,n,r){this.onAxeStart(n,r,function(n){e.trigger("axeStart",t,n)},!1),this.onAxeStop(n,r,function(n){e.trigger("axeStop",t,n)},!1),this.onAxeMove(n,r,function(n){e.trigger("axeMoved",t,n)},!1)},this.updateByRate=function(){this.update=p,this.handleDown=w},this.updateByChange=function(){this.update=h,this.handleDown=g},this.update=function(){}};return e.debug.log("gamepad loaded",3),u}),define("handjs",[],function(){function e(){C=!0,clearTimeout(k),k=setTimeout(function(){C=!1},700)}function t(e){var t=[];if(e){t.unshift(e);while(e.parentNode)t.unshift(e.parentNode),e=e.parentNode}return t}function n(e,n){var r=t(e),i=t(n),s=null;while(r.length>0&&
r[0]==i.shift())s=r.shift();return s}function r(e,t,r){var i=n(e,t),s=e,o=[];while(s&&s!=i)g(s,"pointerenter")&&o.push(s),s=s.parentNode;while(o.length>0)r(o.pop())}function i(e,t,r){var i=n(e,t),s=e;while(s&&s!=i)g(s,"pointerleave")&&r(s),s=s.parentNode}function s(e,t){["pointerdown","pointermove","pointerup","pointerover","pointerout"].forEach(function(n){window.addEventListener(e(n),function(e){!C&&y(e.target,n)&&t(e,n,!0)})}),window["on"+e("pointerenter").toLowerCase()]===undefined&&window.addEventListener(e("pointerover"),function(e){if(C)return;var n=y(e.target,"pointerenter");if(!n||n===window)return;n.contains(e.relatedTarget)||r(n,e.relatedTarget,function(n){t(e,"pointerenter",!1,n,e.relatedTarget)})}),window["on"+e("pointerleave").toLowerCase()]===undefined&&window.addEventListener(e("pointerout"),function(e){if(C)return;var n=y(e.target,"pointerleave");if(!n||n===window)return;n.contains(e.relatedTarget)||i(n,e.relatedTarget,function(n){t(e,"pointerleave",!1,n,e.relatedTarget
)})})}var o=o||{};if(window.PointerEvent)return;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>0&&(r=Number(arguments[1]),r!=r?r=0:r!=0&&r!=Infinity&&r!=-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){if(!this||!(e instanceof Function))throw new TypeError;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")});var u=["pointerdown","pointerup","pointermove","pointerover","pointerout","pointercancel","pointerenter","pointerleave"],a=["PointerDown","PointerUp","PointerMove","PointerOver","PointerOut","PointerCancel","PointerEnter","PointerLeave"],f="touch",l="pen",c="mouse",h={},p=function(e){while(e&&!e.handjs_forcePreventDefault)e=
e.parentNode;return!!e||window.handjs_forcePreventDefault},d=function(e,t,n,r,i){var s;document.createEvent?(s=document.createEvent("MouseEvents"),s.initMouseEvent(t,n,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,i||e.relatedTarget)):(s=document.createEventObject(),s.screenX=e.screenX,s.screenY=e.screenY,s.clientX=e.clientX,s.clientY=e.clientY,s.ctrlKey=e.ctrlKey,s.altKey=e.altKey,s.shiftKey=e.shiftKey,s.metaKey=e.metaKey,s.button=e.button,s.relatedTarget=i||e.relatedTarget),s.offsetX===undefined&&(e.offsetX!==undefined?(Object&&Object.defineProperty!==undefined&&(Object.defineProperty(s,"offsetX",{writable:!0}),Object.defineProperty(s,"offsetY",{writable:!0})),s.offsetX=e.offsetX,s.offsetY=e.offsetY):Object&&Object.defineProperty!==undefined?(Object.defineProperty(s,"offsetX",{get:function(){return this.currentTarget&&this.currentTarget.offsetLeft?e.clientX-this.currentTarget.offsetLeft:e.clientX}}),Object.defineProperty(s,"offsetY"
,{get:function(){return this.currentTarget&&this.currentTarget.offsetTop?e.clientY-this.currentTarget.offsetTop:e.clientY}})):e.layerX!==undefined&&(s.offsetX=e.layerX-e.currentTarget.offsetLeft,s.offsetY=e.layerY-e.currentTarget.offsetTop)),e.isPrimary!==undefined?s.isPrimary=e.isPrimary:s.isPrimary=!0;if(e.pressure)s.pressure=e.pressure;else{var o=0;e.which!==undefined?o=e.which:e.button!==undefined&&(o=e.button),s.pressure=o==0?0:.5}e.rotation?s.rotation=e.rotation:s.rotation=0,e.hwTimestamp?s.hwTimestamp=e.hwTimestamp:s.hwTimestamp=0,e.tiltX?s.tiltX=e.tiltX:s.tiltX=0,e.tiltY?s.tiltY=e.tiltY:s.tiltY=0,e.height?s.height=e.height:s.height=0,e.width?s.width=e.width:s.width=0,s.preventDefault=function(){e.preventDefault!==undefined&&e.preventDefault()};if(s.stopPropagation!==undefined){var u=s.stopPropagation;s.stopPropagation=function(){e.stopPropagation!==undefined&&e.stopPropagation(),u.call(this)}}s.pointerId=e.pointerId,s.pointerType=e.pointerType;switch(s.pointerType){case 2:s.pointerType=
f;break;case 3:s.pointerType=l;break;case 4:s.pointerType=c}r?r.dispatchEvent(s):e.target?e.target.dispatchEvent(s):e.srcElement.fireEvent("on"+w(t),s)},v=function(e,t,n,r,i){e.pointerId=1,e.pointerType=c,d(e,t,n,r,i)},m=function(e,t,n,r,i,s){var o=t.identifier+2;t.pointerId=o,t.pointerType=f,t.currentTarget=n,r.preventDefault!==undefined&&(t.preventDefault=function(){r.preventDefault()}),d(t,e,i,n,s)},g=function(e,t){return e.__handjsGlobalRegisteredEvents&&e.__handjsGlobalRegisteredEvents[t]},y=function(e,t){while(e&&!g(e,t))e=e.parentNode;if(e)return e;if(g(window,t))return window},b=function(e,t,n,r,i,s){y(n,e)&&m(e,t,n,r,i,s)},w=function(e){return e.toLowerCase().replace("pointer","mouse")},E=function(e,t){var n=u.indexOf(t),r=e+a[n];return r},S=function(e,t,n,r){e.__handjsRegisteredEvents===undefined&&(e.__handjsRegisteredEvents=[]);if(r){if(e.__handjsRegisteredEvents[t]!==undefined){e.__handjsRegisteredEvents[t]++;return}e.__handjsRegisteredEvents[t]=1,e.addEventListener(t,n,!1)}
else{if(e.__handjsRegisteredEvents.indexOf(t)!==-1){e.__handjsRegisteredEvents[t]--;if(e.__handjsRegisteredEvents[t]!=0)return}e.removeEventListener(t,n),e.__handjsRegisteredEvents[t]=0}},x=function(e,t,n){e.__handjsGlobalRegisteredEvents||(e.__handjsGlobalRegisteredEvents=[]);if(n){if(e.__handjsGlobalRegisteredEvents[t]!==undefined){e.__handjsGlobalRegisteredEvents[t]++;return}e.__handjsGlobalRegisteredEvents[t]=1}else e.__handjsGlobalRegisteredEvents[t]!==undefined&&(e.__handjsGlobalRegisteredEvents[t]--,e.__handjsGlobalRegisteredEvents[t]<0&&(e.__handjsGlobalRegisteredEvents[t]=0));var r,i;window.MSPointerEvent?(r=function(e){return E("MS",e)},i=d):(r=w,i=v);switch(t){case"pointerenter":case"pointerleave":var s=r(t);e["on"+s.toLowerCase()]!==undefined&&S(e,s,function(e){i(e,t)},n)}},T=function(e){var t=e.prototype?e.prototype.addEventListener:e.addEventListener,n=function(e,n,r){u.indexOf(e)!=-1&&x(this,e,!0),t===undefined?this.attachEvent("on"+w(e),n):t.call(this,e,n,r)};e.prototype?
e.prototype.addEventListener=n:e.addEventListener=n},N=function(e){var t=e.prototype?e.prototype.removeEventListener:e.removeEventListener,n=function(e,n,r){u.indexOf(e)!=-1&&x(this,e,!1),t===undefined?this.detachEvent(w(e),n):t.call(this,e,n,r)};e.prototype?e.prototype.removeEventListener=n:e.removeEventListener=n};T(window),T(window.HTMLElement||window.Element),T(document),T(HTMLBodyElement),T(HTMLDivElement),T(HTMLImageElement),T(HTMLUListElement),T(HTMLAnchorElement),T(HTMLLIElement),T(HTMLTableElement),window.HTMLSpanElement&&T(HTMLSpanElement),window.HTMLCanvasElement&&T(HTMLCanvasElement),window.SVGElement&&T(SVGElement),N(window),N(window.HTMLElement||window.Element),N(document),N(HTMLBodyElement),N(HTMLDivElement),N(HTMLImageElement),N(HTMLUListElement),N(HTMLAnchorElement),N(HTMLLIElement),N(HTMLTableElement),window.HTMLSpanElement&&N(HTMLSpanElement),window.HTMLCanvasElement&&N(HTMLCanvasElement),window.SVGElement&&N(SVGElement);var C=!1,k=-1;return function(){window.MSPointerEvent?
s(function(e){return E("MS",e)},d):(s(w,v),window.ontouchstart!==undefined&&(window.addEventListener("touchstart",function(t){for(var n=0;n<t.changedTouches.length;++n){var i=t.changedTouches[n];h[i.identifier]=i.target,b("pointerover",i,i.target,t,!0),r(i.target,null,function(e){m("pointerenter",i,e,t,!1)}),b("pointerdown",i,i.target,t,!0)}e()}),window.addEventListener("touchend",function(t){for(var n=0;n<t.changedTouches.length;++n){var r=t.changedTouches[n],s=h[r.identifier];b("pointerup",r,s,t,!0),b("pointerout",r,s,t,!0),i(s,null,function(e){m("pointerleave",r,e,t,!1)})}e()}),window.addEventListener("touchmove",function(t){for(var n=0;n<t.changedTouches.length;++n){var s=t.changedTouches[n],o=document.elementFromPoint(s.clientX,s.clientY),u=h[s.identifier];u&&p(u)===!0&&t.preventDefault(),b("pointermove",s,u,t,!0);if(u===o)continue;u&&(b("pointerout",s,u,t,!0,o),u.contains(o)||i(u,o,function(e){m("pointerleave",s,e,t,!1,o)})),o&&(b("pointerover",s,o,t,!0,u),o.contains(u)||r(o,u,function(
e){m("pointerenter",s,e,t,!1,u)})),h[s.identifier]=o}e()}),window.addEventListener("touchcancel",function(e){for(var t=0;t<e.changedTouches.length;++t){var n=e.changedTouches[t];b("pointercancel",n,h[n.identifier],e,!0)}})))}(),navigator.pointerEnabled===undefined&&(navigator.pointerEnabled=!0,navigator.msPointerEnabled&&(navigator.maxTouchPoints=navigator.msMaxTouchPoints)),document.styleSheets&&document.addEventListener&&document.addEventListener("DOMContentLoaded",function(){if(o.doNotProcessCSS||document.body.style.touchAction!==undefined)return;var e=new RegExp(".+?{.*?}","m"),t=new RegExp(".+?{","m"),n=function(n){var r=e.exec(n);if(!r)return;var i=r[0];n=n.replace(i,"").trim();var s=t.exec(i)[0].replace("{","").trim();if(i.replace(/\s/g,"").indexOf("touch-action:none")!=-1){var o=document.querySelectorAll(s);for(var u=0;u<o.length;u++){var a=o[u];a.style.msTouchAction!==undefined?a.style.msTouchAction="none":a.handjs_forcePreventDefault=!0}}return n},r=function(e){if(window.setImmediate
)e&&setImmediate(r,n(e));else while(e)e=n(e)};try{for(var i=0;i<document.styleSheets.length;i++){var s=document.styleSheets[i];if(s.href==undefined)continue;var u=new XMLHttpRequest;u.open("get",s.href),u.send();var a=u.responseText.replace(/(\n|\r)/g,"");r(a)}}catch(f){}var l=document.getElementsByTagName("style");for(var i=0;i<l.length;i++){var c=l[i],h=c.innerHTML.replace(/(\n|\r)/g,"").trim();r(h)}},!1),""}),define("DE.Inputs",["DE.CONFIG","DE.Event","DE.GamePad","DE.LangSystem","DE.Time","handjs"],function(e,t,n,r,i){var s={en:{"leave-page":"By leaving the page you'll lost any progression unsaved."},fr:{"leave-page":"En quittant la page vous allez perdre toute progression non sauvegard\u00e9."}},o=new function(){function r(e){return e.pointerId=e.pointerId||0,o.mouse[e.pointerId]||(o.mouse[e.pointerId]={isDown:!1,x:0,y:0,index:e.pointerId}),o.mouse[e.pointerId].isDown=!0,o.mouse[e.pointerId].x=e.clientX,o.mouse[e.pointerId].y=e.clientY,o.mouse[e.pointerId]}this.DEName="Inputs",this
.isListening=!1,this.usedInputs={};var s={};this.keyLocked=!1,this.mouse=[{x:0,y:0,isDown:!1,index:0}],this.dbInputs={MOUSE:{leftClick:1000000001,rightClick:1000000002,wheelTop:1000000003,wheelDown:1000000004},KEYBOARD:{up:38,down:40,left:37,right:39,space:32,shift:16,caps:20,tab:9,escape:27,d:68,q:81,z:90,s:83,a:65,e:69,r:82,t:84,y:89,u:85,i:73,o:79,p:80,f:70,g:71,h:72,j:74,k:75,l:76,m:77,w:87,x:88,c:67,v:86,b:66,n:78,enter:13,"return":8,"PAD+":107,"PAD-":109,"PAD*":106,"PAD/":111,PAD0:96,PAD1:97,PAD2:98,PAD3:99,PAD4:100,PAD5:101,PAD6:102,PAD7:103,PAD8:104,PAD9:105,F5:116,F11:122,F12:123},GAMEPADBUTTONS:{A:0,B:1,Y:3,X:2,"D-Up":12,"D-Right":15,"D-Left":14,"D-Bot":13,select:8,start:9,RBS:7,RTS:5,LBS:6,LTS:4,power:16},GAMEPADAXES:{LHorizontal:0,LVertical:1,RHorizontal:2,RVertical:3}},this.debugKeys=[123],this.ignoreKeys=[116,122,123],this.queue={keyDown:{},keyUp:{},mouseDown:{},mouseUp:{},btnMoved:{},axeMoved:{},axeStart:{},axeStop:{}},this.on=function(e,t,n){if(!this.queue[e][t]){console
.log("%cWARN:: Try to bind on a non existant input ::: "+e+" - "+t,"color:red");return}this.queue[e][t].push(n)},this.init=function(e){var t={};for(var r in e){t[r]={},t[r].inputs=new Array;for(var i=0,s;s=e[r].keycodes[i];i++){var o=s[0]=="K"||s[0]=="k"?"KEYBOARD":"MOUSE",u=s.split("."),a=0,f;u[0][0]=="G"?(u[0][1]&&(a=parseInt(u[0][1])),u[1]=="A"?o="GAMEPADAXES":o="GAMEPADBUTTONS",f=u[2]):f=s.slice(2,s.length);if(typeof this.dbInputs[o][f]=="undefined"){console.log("%cAn input couldn't be found in the database, did you respect the caseSensitive ?:"+o+"."+f+"\n Ignoring it and continue...","color:red");continue}o=="GAMEPADBUTTONS"?n.plugBtnToInput(this,r,a,this.dbInputs[o][f]):o=="GAMEPADAXES"&&n.plugAxeToInput(this,r,a,this.dbInputs[o][f]),t[r].inputs.push({code:this.dbInputs[o][f],type:o})}t[r].interval=e[r].interval||0,t[r].lastCall=Date.now(),t[r].actions={},t[r].isDown=!1,t[r].isLongPress=e[r].isLongPress||!1,t[r].stayOn=e[r].stayOn||!1,t[r].numberCall=0,t[r].numberPress=0,t[r].stayOn&&
(t[r].lastCall=Date.now()+t[r].interval),this.queue.keyDown[r]=new Array,this.queue.keyUp[r]=new Array,this.queue.mouseDown[r]=new Array,this.queue.mouseUp[r]=new Array,this.queue.btnMoved[r]=new Array,this.queue.axeMoved[r]=new Array,this.queue.axeStart[r]=new Array,this.queue.axeStop[r]=new Array}this.usedInputs=t,this.toggleListeners()},this.get=function(e){return this.usedInputs[e]?this.usedInputs[e]:!1},this.trigger=function(e,t,n){if(o.keyLocked&&e.search("mouse")==-1)return;for(var r in o.queue[e][t])o.queue[e][t][r](n)},this.key=function(e){if(o.keyLocked)return;return this.usedInputs[e]&&this.usedInputs[e].isDown&&(!this.usedInputs[e].interval||Date.now()-this.usedInputs[e].lastCall>=this.usedInputs[e].interval/i.scaleDelta)?(o.usedInputs[e].stayOn||(o.usedInputs[e].lastCall=Date.now()),o.usedInputs[e].numberCall++,!0):!1},this.toggleListeners=function(e,t){var n=e||window;this.isListening&&!t?n.removeEventListener?(n.removeEventListener("keydown",o.keyDown,!1),n.removeEventListener
("keyup",o.keyUp,!1),n.removeEventListener("keypress",o.keyPress,!1)):n.detachEvent&&(n.detachEvent("onkeydown",o.keyDown),n.detachEvent("onkeyup",o.keyUp),n.detachEvent("onkeypress",o.keyPress)):n.addEventListener?(n.addEventListener("keydown",o.keyDown,!1),n.addEventListener("keyup",o.keyUp,!1),n.addEventListener("keypress",o.keyPress,!1)):n.attachEvent&&(n.attachEvent("onkeydown",o.keyDown),n.attachEvent("onkeyup",o.keyUp),n.attachEvent("onkeypress",o.keyPress))},this.findInputs=function(e,t){var n=[];for(var r in o.usedInputs)for(var i in o.usedInputs[r].inputs){var s=o.usedInputs[r].inputs[i].code,u=o.usedInputs[r].inputs[i].type;s==e&&u==t&&n.push(r)}return n.length>0?n:!1},this.keyDown=function(n){var r=n||window.event,i=r.which||r.keyCode;if(o.ignoreKeys.indexOf(i)!=-1){if(o.debugKeys.indexOf(i)!=-1){if(e.DEBUG)return;r.preventDefault()}return}i==o.dbInputs.KEYBOARD.shift?o.isShiftDown=!0:o.isShiftDown&&i==o.dbInputs.KEYBOARD.tab&&t.trigger("toggle-nebula");if(o.keyLocked)return i==
o.dbInputs.KEYBOARD.escape&&t.trigger("close-nebula"),!1;var s=o.findInputs(i,"KEYBOARD");if(s!==!1)for(var u=0,a;a=s[u];++u)!o.usedInputs[a].isDown&&Date.now()-o.usedInputs[a].lastCall>=o.usedInputs[a].interval&&(o.usedInputs[a].isLongPress&&!o.usedInputs[a].stayOn&&(o.usedInputs[a].lastCall=Date.now()),o.usedInputs[a].isDown||o.trigger("keyDown",a,1),o.usedInputs[a].isDown=!0),o.usedInputs[a].numberPress++;r.preventDefault()},this.keyUp=function(e){var t=e||window.event,n=t.which||t.keyCode;n==o.dbInputs.KEYBOARD.shift&&(o.isShiftDown=!1);if(o.keyLocked)return!1;var r=o.findInputs(n,"KEYBOARD");if(r!==!1)for(var i=0,s;s=r[i];++i)o.usedInputs[s].isDown&&o.trigger("keyUp",s),o.usedInputs[s].stayOn&&(o.usedInputs[s].lastCall=Date.now()),o.usedInputs[s].isDown=!1},this.keyPress=function(e){var t=e||window.event,n=t.which||t.keyCode,r=t.keyCode,i=o.findInputs(r,"KEYBOARD");i!==!1},this.mouseDown=function(e){var t=!1,n=!1;"which"in e?(t=e.which==3,n=e.which==2):"button"in e&&(t=e.button==2)
;var i=r(e);i.isRightClick=t,i.isMiddleClick=n,s[e.target.id]&&s[e.target.id].oOnMouseDown(i);var u=o.findInputs(1000000001,"MOUSE");if(u!==!1)for(var a=0,f;f=u[a];++a)o.usedInputs[f].isDown||o.trigger("mouseDown",f,i),o.usedInputs[f].isDown=!0;return!1},this.rightClick=function(e){e.preventDefault(),e.stopPropagation()},this.mouseUp=function(e){var t=!1,n=!1;"which"in e?(t=e.which==3,n=e.which==2):"button"in e&&(t=e.button==2);var i=r(e);i.isRightClick=t,i.isMiddleClick=n,s[e.target.id]&&s[e.target.id].oOnMouseUp(i);var u=o.findInputs(1000000001,"MOUSE");if(u!==!1)for(var a=0,f;f=u[a];++a)o.usedInputs[f].isDown&&o.trigger("mouseUp",f),o.usedInputs[f].isDown=!1;return e.preventDefault(),!1},this.mouseMove=function(e){return s[e.target.id]&&s[e.target.id].oOnMouseMove(r(e)),e.preventDefault(),!1},this.mouseClick=function(e){},this.mouseDbClick=function(){},this.addEvent=function(e){},this.addActionInput=function(t,n,r){if(!this.checkInputExist(n))return;e.DEBUG&&e.DEBUG_LEVEL>=3&&this.usedInputs
[n].actions[r]&&e.debug.log("Replace the action "+r+" on input "+n,3)},this.removeActionInput=function(t,n){if(!this.checkInputExist(t))return;if(!this.usedInputs[t].actions[n])throw new Error("Try to remove a not founded action by id:: "+n);e.debug.log("Remove the action "+n+" on input "+t,3),delete this.usedInputs[t].actions[n]},this.checkInputExist=function(t){return this.usedInputs[t]?!0:(e.debug.log("Try to access an input not defined:: "+t,1),!1)},this.addRender=function(e){s[e.id]=e;var t=e.canvas;t.addEventListener("pointerdown",o.mouseDown,!1),t.addEventListener("pointerup",o.mouseUp,!1),t.addEventListener("pointerout",o.mouseMove,!1),t.addEventListener("pointermove",o.mouseMove,!1),t.addEventListener("contextmenu",o.rightClick,!1),t.addEventListener("DOMMouseScroll",o.mouseWheel,!1),t.addEventListener("mousewheel",o.mouseWheel,!1),window.attachEvent&&t.attachEvent("onmousewheel",o.mouseWheel)},this.removeRender=function(t){if(!s[t].canvas){e.debug.log("[INPUTS] Try to remove a renders but not found :: "+
t,1);return}s[t].canvas.removeEventListener("pointerdown",o.mouseDown,!1),s[t].canvas.removeEventListener("pointerup",o.mouseUp,!1),s[t].canvas.removeEventListener("pointerout",o.mouseUp,!1),s[t].canvas.removeEventListener("pointermove",o.mouseMove,!1),s[t].canvas.removeEventListener("contextmenu",o.rightClick,!1),s[t].canvas.removeEventListener("DOMMouseScroll",o.mouseWheel,!1),delete s[t]},this.mouseWheel=function(e){var t=e.wheelDelta>0?1:-1;e.detail&&(t=e.detail<0?1:-1),t==1?o.trigger("axeMoved","wheelTop"):o.trigger("axeMoved","wheelDown")}};return window.onbeforeunload=function(e){if(!window.leavePage)return s[r.currentLang]["leave-page"]},window.onunload=function(e){t.trigger("unload-game")},e.debug.log("Inputs loaded",3),o}),define("DE.SystemDetection",["DE.CONFIG","DE.LangSystem"],function(e,t){var n=new function(){this.DEName="SystemDetection",this.touchPlatform=!1,this.init=function(e){ua=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i
.test(ua)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i
.test(ua.substr(0,4)))this.touchPlatform=!0;if(e.touchPlatform||window.ENGINE_SETTING&&window.ENGINE_SETTING.touchPlatform)this.touchPlatform=!0;t.getLang()},this.render=null,this.scene=null,this.camera=null,this.isOverridingMainLoop=!1,this.askToRateIf="playedOnce",this.askToRate=function(){},this.initSystem=function(e,t){if(e)for(var n in e)this[n]=e[n];this.init(t)}};return e.debug.log("SystemDetection loaded",3),n}),define("stash",[],function(){function e(e,t){return t!==undefined&&t!==null&&t.constructor===e}function t(e){return"'"+String(e).replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")+"'"}function n(e){var t=l.createElement("_");return t.innerHTML=e,t.firstChild}function r(e){if(e.outerHTML)return e.outerHTML;var t=l.createElement("_");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function i(n){var i=arguments.callee,s=[],o,u=-1,f;if(e(String,n))return t(n);if(n===undefined||n===null||e(Boolean,n)||e(Number,n)||e(RegExp
,n)||e(Function,n)&&!/^function[^\{]+\{\s*\[native code\]/.test(String(n)))return String(n);if(e(Date,n))return"new Date("+n.getTime()+")";if(e(Array,n)){o=n.length;while(++u<o)s.push(i(n[u]));return"["+s+"]"}if(e(Object,n)){for(f in n)s.push(t(f)+":"+i(n[f]));return"{"+s+"}"}if(n===a)return"window";for(f in a)if(n===a[f])return"window."+f;for(f in l)if(n===l[f])return"document."+f;if(n.nodeName)return"h("+t(r(n))+")"}function s(e){return(new Function("var a=arguments;h=a[0];return "+e)).apply(a,[n])}function o(){var t={},n=arguments,r=n.length,i=-1,s;while(++i<r)if(e(Object,n[i]))for(s in n[i])t[s]=e(Object,t[s])&&e(Object,n[i][s])?n.callee(t[s],n[i][s]):n[i][s];return t}function u(t,n,r){var u=f[t],a;if(r){a=s(u);if(e(Array,a))n=a.concat(n);else if(e(Boolean,a))n=a&&!!n;else if(e(Date,a)&&!isNaN(n*1))n=new Date(a.getTime()+n*1);else if(e(Function,a)&&e(Function,n))n=new Function("return("+String(a)+").apply(this, arguments)&&("+String(n)+").apply(this, arguments)");else if(e(Number,a)&&!
isNaN(n*1))n=a+n*1;else if(e(Object,a)&&e(Object,n))n=o(a,n);else if(e(RegExp,a)&&e(RegExp,n)){var l=/^\/([\W\w]*)\/([a-z]*?)$/,c=String(a).match(l),h=String(n).match(l);n=new RegExp(c[1]+h[1],c[2]+h[2])}else{if(!e(String,a))return 2;n=a+String(n)}}return n=i(n),u===n?2:(f[t]=n)&&1}var a=window,f=window.document.localStorage||window.localStorage,l=document,c={has:function(){var e=[].concat.apply([],arguments),t,n=-1;while(t=e[++n])if(f[t]===undefined)return!1;return!0},get:function(e){var t=[].concat.apply([],arguments),n,r=-1,i={};if(t.length===1)return s(f[e]);while(n=t[++r])i[n]=s(f[n]);return i},getAll:function(){var e,t={};for(e in f)t[e]=f[e];return t},set:function(t,n){var r=[].concat.apply([],arguments),i,s=-1,o,a=2;if(e(String,t))return u(t,n);while(i=r[++s])for(o in i)a=Math.min(a,u(o,i[o]));return a},add:function(t,n){var r=[].concat.apply([],arguments),i,s=-1,o,a=2;if(e(String,t))return u(t,n,!0);while(i=r[++s])for(o in i)a=Math.min(a,u(o,i[o],!0));return a},cut:function(e){
var t=[].concat.apply([],arguments),n,r=-1;while(n=t[++r])delete f[n];return!0},cutAll:function(){for(var e in f)delete f[e];return!0}};return c}),define("DE.about",["DE.CONFIG"],function(e){var t={};return t.DEName="about",t.version="0.1.0",t.gameName="DreamGame",t.gameVersion="0.1.0",t.gameAuthor="Dreamirl",t.set=function(e){e=e||{},t.gameName=e.gameName||t.gameName,t.gameVersion=e.gameVersion||t.gameVersion,t.gameAuthor=e.gameAuthor||t.gameAuthor,t.namespace=e.namespace||null},e.debug.log("about loaded",3),t}),define("DE.SaveSystem",["stash","DE.CONFIG","DE.about","DE.Event"],function(e,t,n,r){var i=new function(){this.DEName="SaveSystem",this.saveModel={},this.namespace="DreamGame",this.useLocalStorage=!0,this.init=function(t,r){t=t||{},t.settings||(t.settings={}),this.namespace=n.namespace,this.version=n.version,r&&(this.version=e.get(this.namespace)),this.saveModel=t;for(var i in this.saveModel)this.saveModel[i]=e.get(this.namespace+this.version+i)||this.saveModel[i];this.loadSave
(this.saveModel,!0)},this.updateSave=function(){if(!this.useLocalStorage)return;for(var t in this.saveModel)e.cut(this.namespace+this.version+t);this.version=n.version,e.set(this.namespace,this.version);for(var t in this.saveModel)e.set(this.namespace+this.version+t,this.saveModel[t])},this.loadSave=function(e,t){this.useLocalStorage=t;for(var n in e)!this.saveModel[n]&&this.saveModel[n]!==!1&&this.saveModel[n]!==0&&(r.trigger("savesystem-attr-not-found",n),console.log("Seems your game version is to old, we send a report",n)),this.saveModel[n]=e[n];this.updateSave(),r.trigger("savesystem-loaded",this.saveModel)},this.get=function(t){return t in this.saveModel||(this.saveModel[t]=e.get(this.namespace+this.version+t)||this.saveModel[t]),this.saveModel[t]},this.save=function(n,i){var s=n.split("."),o=s[0];o in this.saveModel||t.debug.log("%c[WARN] You save a key "+o+" doesn't exist in your saveModel ! add it to your saveModel but engine wont be able to get it later",0,"color:orange"),s.length==2?
(i===undefined&&(i=this.get(o)[1]),this.saveModel[o][s[1]]=i,this.useLocalStorage&&e.set(this.namespace+this.version+o,this.saveModel[o])):s.length==1&&(i===undefined&&(i=this.get(o)),this.saveModel[o]=i,this.useLocalStorage&&e.set(this.namespace+this.version+o,i)),r.trigger("savesystem-save",this.saveModel)},this.saveAll=function(){if(!this.useLocalStorage)return;for(var t in this.saveModel)e.set(this.namespace+this.version+t,this.saveModel[t])},this.saveAchievements=function(t){if(!this.useLocalStorage)return;e.set(this.namespace+"achievements",t)},this.loadAchievements=function(){return e.get(this.namespace+"achievements")||{}}};return t.debug.log("SaveSystem loaded",3),i}),define("DE.Screen",["DE.CONFIG","DE.SaveSystem","DE.Event"],function(e,t,n){var r=new function(){this.DEName="Screen",this.screenSizes={},this.conceptionSizeIndex=0,this.ratioToConception=1,this.currentSizeIndex=0,this.activeScreenWidth=0,this.screenSize={w:0,h:0},this.dpiSizeRatio={w:0,h:0},this.dpi=1,this.init=function(
e){e||console.log("%cFATAL ERROR %cyou need to pass the file containing all images datas when call DreamEngine.init","color:red;background:black","color: red"),this.screenSizes=e.screenSizes||[{w:1920,h:1080,path:""}],this.conceptionSizeIndex=e.conceptionSizeIndex||0},this.updateScreenSizes=function(r){this.dpi=1;var i=i||1;i&&(this.dpi=i);var s=t.get("settings").quality||undefined,o=this.screenSizes;this.currentSizeIndex=0,this.screenSize.w=window.innerWidth||document.documentElement.clientWidth,this.screenSize.h=window.innerHeight||document.documentElement.clientHeight,this.dpiSizeRatio.w=(window.innerWidth||document.documentElement.clientWidth)/this.dpi>>0,this.dpiSizeRatio.h=(window.innerHeight||document.documentElement.clientHeight)/this.dpi>>0;if(o[r]||!isNaN(s)&&o[s])o[r]?(this.currentSizeIndex=r,t.get("settings").quality=r,t.save("settings",t.get("settings"))):this.currentSizeIndex=s||r;else{var u=0;for(var a=0;a<o.length;++a){this.currentSizeIndex=a;if(o[a].w<=this.screenSize.w&&
o[a].h<=this.screenSize.h){if(a>0){var f=Math.abs(o[a].w-this.screenSize.w),l=Math.abs(o[a].h-this.screenSize.h),c=Math.abs(o[a-1].w-this.screenSize.w),h=Math.abs(o[a-1].h-this.screenSize.h);c<f&&h<l&&(this.currentSizeIndex=a-1)}break}}t.get("settings").quality=r,t.save("settings",t.get("settings"))}this.activeScreenWidth=o[this.conceptionSizeIndex].w,e.debug.log("Choosen screen size index is "+this.currentSizeIndex+" - screenSize: "+JSON.stringify(this.screenSize)+" - choosedSize: "+JSON.stringify(o[this.currentSizeIndex])+" - dpi: "+this.dpi,2),this.ratioToConception=o[this.currentSizeIndex].w/o[this.conceptionSizeIndex].w,e.debug.log("Physical ratio is :: "+this.ratioToConception,2),n.trigger("updateScreenSizes",this.ratioToConception,o[this.currentSizeIndex])}};return e.debug.log("Screens loaded",3),r}),define("buzz",[],function(){var e={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80,document:document},types:{mp3:"audio/mpeg",ogg:"audio/ogg"
,wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(t,n){function r(e){var t=[],n=e.length-1;for(var r=0;r<=n;r++)t.push({start:e.start(r),end:e.end(r)});return t}function i(e){return e.split(".").pop()}function s(t,n){var r=o.createElement("source");r.src=n,e.types[i(n)]&&(r.type=e.types[i(n)]),t.appendChild(r)}n=n||{};var o=n.document||e.defaults.document,u=0,a=[],f={},l=e.isSupported();this.load=function(){return l?(this.sound.load(),this):this},this.play=function(){return this.sound.isPreloaded?l?(this.sound.play(),this):this:(this.tryToPlay=!0,this)},this.togglePlay=function(){return this.sound.isPreloaded?l?(this.sound.paused?this.sound.play():this.sound.pause(),this):this:(this.tryToPlay=!0,this)},this.pause=function(){return l?(this.sound.pause(),this):this},this.isPaused=function(){return l?this.sound.paused:null},this.stop=function(){return l?(this.setTime(0),this.sound.pause(),this):this},this.isEnded=function(){return l?
this.sound.ended:null},this.loop=function(){return l?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return l?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return l?(this.sound.muted=!0,this):this},this.unmute=function(){return l?(this.sound.muted=!1,this):this},this.toggleMute=function(){return l?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return l?this.sound.muted:null},this.setVolume=function(e){return l?(e<0&&(e=0),e>100&&(e=100),this.volume=e,this.sound.volume=e/100,this):this},this.getVolume=function(){return l?this.volume:this},this.increaseVolume=function(e){return this.setVolume(this.volume+(e||1))},this.decreaseVolume=function(e){return this.setVolume(this.volume-(e||1))},this.setTime=function(e){if(!l)return this;var t=!0;return this.whenReady(function(){t===!0&&(t=!1,this.sound.currentTime=e)}),this},this.getTime=function(
){if(!l)return null;var t=Math.round(this.sound.currentTime*100)/100;return isNaN(t)?e.defaults.placeholder:t},this.setPercent=function(t){return l?this.setTime(e.fromPercent(t,this.sound.duration)):this},this.getPercent=function(){if(!l)return null;var t=Math.round(e.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(t)?e.defaults.placeholder:t},this.setSpeed=function(e){return l?(this.sound.playbackRate=e,this):this},this.getSpeed=function(){return l?this.sound.playbackRate:null},this.getDuration=function(){if(!l)return null;var t=Math.round(this.sound.duration*100)/100;return isNaN(t)?e.defaults.placeholder:t},this.getPlayed=function(){return l?r(this.sound.played):null},this.getBuffered=function(){return l?r(this.sound.buffered):null},this.getSeekable=function(){return l?r(this.sound.seekable):null},this.getErrorCode=function(){return l&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!l)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED"
;case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return l?this.sound.readyState:null},this.getStateMessage=function(){if(!l)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return l?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!l)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(e,t){return l?(this.sound[e]=t,this):this},this.get=function(e){return l?e?this.sound[e]:this.sound:null},this.bind=function(e,t){if(!l)return this;e=e.split(" ");var n=this,r=function(e){t.call(n,e)};for(var i=0;i<e.length
;i++){var s=e[i],o=s;s=o.split(".")[0],a.push({idx:o,func:r}),this.sound.addEventListener(s,r,!0)}return this},this.unbind=function(e){if(!l)return this;e=e.split(" ");for(var t=0;t<e.length;t++){var n=e[t],r=n.split(".")[0];for(var i=0;i<a.length;i++){var s=a[i].idx.split(".");if(a[i].idx==n||s[1]&&s[1]==n.replace(".",""))this.sound.removeEventListener(r,a[i].func,!0),a.splice(i,1)}}return this},this.bindOnce=function(e,t){if(!l)return this;var n=this;return f[u++]=!1,this.bind(e+"."+u,function(){f[u]||(f[u]=!0,t.call(n)),n.unbind(e+"."+u)}),this},this.trigger=function(e){if(!l)return this;e=e.split(" ");for(var t=0;t<e.length;t++){var n=e[t];for(var r=0;r<a.length;r++){var i=a[r].idx.split(".");if(a[r].idx==n||i[0]&&i[0]==n.replace(".","")){var s=o.createEvent("HTMLEvents");s.initEvent(i[0],!1,!0),this.sound.dispatchEvent(s)}}}return this},this.fadeTo=function(t,n,r){function i(){setTimeout(function(){s<t&&u.volume<t?(u.setVolume(u.volume+=1),i()):s>t&&u.volume>t?(u.setVolume(u.volume-=1
),i()):r instanceof Function&&r.apply(u)},o)}if(!l)return this;n instanceof Function?(r=n,n=e.defaults.duration):n=n||e.defaults.duration;var s=this.volume,o=n/Math.abs(s-t),u=this;return this.play(),this.whenReady(function(){i()}),this},this.fadeIn=function(e,t){return l?this.setVolume(0).fadeTo(100,e,t):this},this.fadeOut=function(e,t){return l?this.fadeTo(0,e,t):this},this.fadeWith=function(e,t){return l?(this.fadeOut(t,function(){this.stop()}),e.play().fadeIn(t),this):this},this.whenReady=function(e){if(!l)return null;var t=this;this.sound.readyState===0?this.bind("canplay.buzzwhenready",function(){e.call(t)}):e.call(t)};if(l&&t){for(var c in e.defaults)e.defaults.hasOwnProperty(c)&&(n[c]=n[c]||e.defaults[c]);this.sound=o.createElement("audio"),this.sound.oncanplaythrough=function(){this.oncanplaythrough=null,this.isPreloaded=!0,this.tryToPlay&&this.play()},this.sound.addEventListener("canplaythrough",function(){this.oncanplaythrough=null,this.isPreloaded=!0,this.tryToPlay&&this.play
()});if(t instanceof Array)for(var h in t)t.hasOwnProperty(h)&&s(this.sound,t[h]);else if(n.formats.length)for(var p in n.formats)n.formats.hasOwnProperty(p)&&s(this.sound,t+"."+n.formats[p]);else s(this.sound,t);n.loop&&this.loop(),n.autoplay&&(this.sound.autoplay="autoplay"),n.preload===!0?this.sound.preload="auto":n.preload===!1?this.sound.preload="none":this.sound.preload=n.preload,this.setVolume(n.volume),e.sounds.push(this)}},group:function(e){function t(){var t=n(null,arguments),r=t.shift();for(var i=0;i<e.length;i++)e[i][r].apply(e[i],t)}function n(e,t){return e instanceof Array?e:Array.prototype.slice.call(t)}e=n(e,arguments),this.getSounds=function(){return e},this.add=function(t){t=n(t,arguments);for(var r=0;r<t.length;r++)e.push(t[r])},this.remove=function(t){t=n(t,arguments);for(var r=0;r<t.length;r++)for(var i=0;i<e.length;i++)if(e[i]==t[r]){e.splice(i,1);break}},this.load=function(){return t("load"),this},this.play=function(){return t("play"),this},this.togglePlay=function(
){return t("togglePlay"),this},this.pause=function(e){return t("pause",e),this},this.stop=function(){return t("stop"),this},this.mute=function(){return t("mute"),this},this.unmute=function(){return t("unmute"),this},this.toggleMute=function(){return t("toggleMute"),this},this.setVolume=function(e){return t("setVolume",e),this},this.increaseVolume=function(e){return t("increaseVolume",e),this},this.decreaseVolume=function(e){return t("decreaseVolume",e),this},this.loop=function(){return t("loop"),this},this.unloop=function(){return t("unloop"),this},this.setTime=function(e){return t("setTime",e),this},this.set=function(e,n){return t("set",e,n),this},this.bind=function(e,n){return t("bind",e,n),this},this.unbind=function(e){return t("unbind",e),this},this.bindOnce=function(e,n){return t("bindOnce",e,n),this},this.trigger=function(e){return t("trigger",e),this},this.fade=function(e,n,r,i){return t("fade",e,n,r,i),this},this.fadeIn=function(e,n){return t("fadeIn",e,n),this},this.fadeOut=function(
e,n){return t("fadeOut",e,n),this}},all:function(){return new e.group(e.sounds)},isSupported:function(){return!!e.el.canPlayType},isOGGSupported:function(){return!!e.el.canPlayType&&e.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!e.el.canPlayType&&e.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!e.el.canPlayType&&e.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!e.el.canPlayType&&(e.el.canPlayType("audio/x-m4a;")||e.el.canPlayType("audio/aac;"))},toTimer:function(e,t){var n,r,i;return n=Math.floor(e/3600),n=isNaN(n)?"--":n>=10?n:"0"+n,r=t?Math.floor(e/60%60):Math.floor(e/60),r=isNaN(r)?"--":r>=10?r:"0"+r,i=Math.floor(e%60),i=isNaN(i)?"--":i>=10?i:"0"+i,t?n+":"+r+":"+i:r+":"+i},fromTimer:function(e){var t=e.toString().split(":");return t&&t.length==3&&(e=parseInt(t[0],10)*3600+parseInt(t[1],10)*60+parseInt(t[2],10)),t&&t.length==2&&(e=parseInt(t[0],10)*60+parseInt(t[1],10)),e},toPercent:function(e,t,n){var r=Math
.pow(10,n||0);return Math.round(e*100/t*r)/r},fromPercent:function(e,t,n){var r=Math.pow(10,n||0);return Math.round(t/100*e*r)/r}};return e}),define("DE.AudioManager",["DE.CONFIG","buzz","DE.Event"],function(e,t,n){var r=new function(){this.DEName="AudioManager",this.muted=!1,this.volume=80,this.loadAudios=function(e){this.music.volume=this.volume,this.fx.volume=this.volume*.75;for(var n=0,r,i,s,o;n<e.length;++n)r=e[n],o=r[3]||{},i={},i.name=r[0]||"noname",i.preload=o.preload||!1,i.loop=o.loop||!1,i.formats=r[2]||["mp3"],i.autoplay=o.autoplay||!1,i.sound=new t.sound(r[1],{formats:i.formats,preload:i.preload,loop:i.loop,autoplay:i.autoplay}),o.isMusic?this.music.add(i):this.fx.add(i);this.setVolume(this.volume)},this.mute=function(){return this.music.mute(),this.fx.mute(),this.muted=!0,this},this.unmute=function(){return this.music.unmute(),this.fx.unmute(),this.muted=!1,this},this.toggle=function(){return this.muted?this.unmute():this.mute(),this},this.setVolume=function(e,t){t=="+"?this
.volume+=e:t=="-"?this.volume-=e:this.volume=e,this.checkVolume();var n=this.volume;this.music.setVolume(n);var r=this.volume*.75;return this.fx.setVolume(r),this},this.checkVolume=function(){return this.volume=(this.volume>100?100:this.volume)>>0,this.volume=(this.volume<0?0:this.volume)>>0,this},this.applyFades=function(){var e=this.music.getAll(),t,n=0;for(var r in e){if(e[r].sound.currentFade==0)continue;t=e[r].sound;for(var i in t.fades)n=t._volume+t.fades[i].dir*t.fades[i].step,++t.fades[i].step,t.volume(n,i!=="default"?i:null),n==t.fades[i].to&&(t.fades[i].callback&&t.fades[i].callback(),delete t.fades[i])}},this.music=new function(){var e={};this.volume=80,this.muted=!1,this.currentPlayed=[],this.savedPlay=[],this.getAll=function(){return e},this.get=function(t){return e[t].sound},this.add=function(t){e[t.name]=t},this.play=function(t){var n=[];t.length!=undefined&&t.push?n=t:n.push(t);for(var r=0,i;r<n.length;++r){i=n[r].split(".");var s=i[1]||null;i=i[0];if(!e[i]||!e[i].sound)
continue;s?this.currentPlayed.push(i+"."+s):this.currentPlayed.push(i),e[i].sound.loop(),e[i].sound.setVolume(this.volume),this.muted||e[i].sound.play(s)}return this},this.stopAllAndPlay=function(e,t){return this.stopAll(t),this.play(e),this},this.stopAll=function(t){this.currentPlayed=[],t||(t=[]),t.push||(t=[t]);for(var n in e){if(t.indexOf(n)!=-1){e[n].sound.isPaused()||this.currentPlayed.push(n);continue}e[n].sound.stop()}return this},this.pauseAll=function(t){this.currentPlayed=[],t||(t=[]),t.push||(t=[t]);for(var n in e){if(t.indexOf(n)!=-1){e[n].sound.isPaused()||this.currentPlayed.push(n);continue}e[n].sound.pause()}return this},this.pauseAllAndPlay=function(t){for(var n in e)e[n].sound.pause();if(this.muted)return;return this.play(t),this},this.mute=function(){return this.savedPlay=[].concat(this.currentPlayed),this.muted=!0,this.pauseAll(),this},this.unmute=function(){this.muted=!1;for(var t=0;t<this.savedPlay.length;++t)e[this.savedPlay[t]].sound.play();return this.currentPlayed=
this.savedPlay,this},this.setVolume=function(t){this.volume=t||0;for(var n in e)e[n].sound.setVolume(this.volume);return this}},this.fx=new function(){var e={};this.volume=80,this.muted=!1,this.get=function(t){return e[t].sound},this.add=function(t){e[t.name]=t},this.play=function(t){if(this.muted)return;if(!e[t]){console.log("Unable to find the fx named "+t+". Prevent play");return}return e[t].sound.isPaused()||e[t].sound.stop(),e[t].sound.play(),this},this.stop=function(t){e[t].sound.stop()},this.mute=function(){this.muted=!0;for(var t in e)e[t].sound.stop()},this.unmute=function(){return this.muted=!1,this},this.setVolume=function(t){this.volume=t||0;for(var n in e)e[n].sound.setVolume(this.volume);return this}}};return e.debug.log("AudioManager loaded",3),r}),define("DE.MainLoop",["DE.Time","DE.CONFIG","DE.States","DE.Inputs","DE.GamePad","DE.ImageManager","DE.SystemDetection","DE.Screen","DE.Event","DE.AudioManager"],function(e,t,n,r,i,s,o,u,a,f){var l=new function(){this.DEName="MainLoop"
,this.launched=!1,this.renders=new Array,this.scenes=new Array,this.maxRenders=1,this.loader=null,this.additionalModules={},this.loop=function(){if(!l.launched)return;requestAnimationFrame(l.loop);if(!e.update())return;if(n.get("isLoading")){if(!l.loader)return;var t=(s.imagesLoaded/s.imagesRequested*1e3>>0)/10;t.toString().length>4&&(t=t.slice(0,4));for(var r=0,a;a=l.renders[r];r++)a.ctx.translate(a.sizes.width*.5,a.sizes.height*.5),l.loader.renderers[1].setText(t+"%"),l.loader.render(a.ctx,u.ratioToConception,{x:0,y:0,z:-10},{width:0,height:0},a.sizes.width/u.activeScreenWidth),a.ctx.translate(-a.sizes.width*.5,-a.sizes.height*.5);return}if(o.isOverridingMainLoop){if(!o.render)return;o.render.render(),o.scene.update(e.currentTime)}else if(n.get("isReady")){for(var r=0,a;a=l.renders[r];++r)a.render(),a.update();f.applyFades();while(e.missedFrame>=0){i.update(e.currentTime),l.customLoop(e.currentTime);for(var c in l.additionalModules)l.additionalModules[c].update(e.currentTime);for(r=0,
a;a=l.scenes[r];++r)a.sleep||a.update();for(r=0,a;a=l.renders[r];++r)a.updateGuis();e.deltaTime=1,e.timeSinceLastFrameScaled=0,e.timeSinceLastFrame=0,--e.missedFrame}}},this.addRender=function(e){e.id=this.maxRenders++,this.renders.push(e),e.fullScreenMode=="ratioStretch"&&e.screenChangedSizeIndex(u.ratioToConception,u.screenSizes[u.currentSizeIndex])},this.screenChangedSizeIndex=function(e,t){for(var n=0,r;r=this.renders[n];++n)r.screenChangedSizeIndex(e,t)},this.addScene=function(e){this.scenes.push(e)},this.customLoop=function(e){}};return t.debug.log("MainLoop loaded",3),l}),define("DE.Scene",["DE.CONFIG","DE.COLORS","DE.GameObject","DE.Time","DE.MainLoop","DE.Event"],function(e,t,n,r,i,s){function o(t){this.name=t||"NoName-"+(Date.now()+Math.random()*Date.now()>>0),this.gameObjects=new Array,this.objectsByTag={},this.objectsByName={},this.sleep=!1,this.maxObjects=0,this.timers=new Array,this.onGlobalMouseDown={},this.onLastGlobalMouseDown={},this.onGlobalMouseMove={},this.onLastGlobalMouseMove=
{},this.onGlobalMouseUp={},this.onLastGlobalMouseUp={},this.onGlobalMouseClick={},this.onLastGlobalMouseClick={},this._init=function(){i.addScene(this)},this.update=function(){if(this.sleep)return;for(var e=0,t=this.gameObjects.length,n;e<t;++e){n=this.gameObjects[e];if(!n)continue;if(n.flag!==null)switch(n.flag){case"delete":this.delete(e),--t;continue}n.update(r.currentTime)}for(var e=0,t=this.timers.length;e<t;++tk)this.timers[e].update();this.waitSortGameObjects&&this.sortGameObjects()},this.sortGameObjects=function(){this.gameObjects.sort(function(e,t){return t.position.z==e.position.z?t.zindex==e.zindex?t.position.x-e.position.x:e.zindex-t.zindex:t.position.z-e.position.z});for(var e=0,t;t=this.gameObjects[e];++e)t.sortChildrens();this.waitSortGameObjects=!1},this.add=function(e){var t=Array.prototype.slice.call(arguments);for(var n=0;n<t.length;++n)if(t[n].length)for(var r=0,i=t[n].length||1;r<i;++r)this.addOne(t[n][r]);else this.addOne(t[n])},this.addOne=function(t){if(!(t instanceof 
n)){e.debug.log("%cIt's not or not herits from a GameObjects",1,"color:red");return}t.scene=this,this.gameObjects.push(t),t.name&&(this.objectsByName[t.name]||(this.objectsByName[t.name]=[]),this.objectsByName[t.name].push(t)),t.tag&&(this.objectsByTag[t.tag]||(this.objectsByTag[t.tag]=[]),this.objectsByTag[t.tag].push(t)),++this.maxObjects,this.waitSortGameObjects=!0},s.addEventComponents(this),this._init()}return o.prototype=o.prototype||{},s.addEventCapabilities(o),o.prototype.cleanObjectBinding=function(e){delete this.onGlobalMouseDown[e.id],delete this.onLastGlobalMouseDown[e.id],delete this.onGlobalMouseMove[e.id],delete this.onLastGlobalMouseMove[e.id],delete this.onGlobalMouseUp[e.id],delete this.onLastGlobalMouseUp[e.id]},o.prototype.remove=function(t){this.cleanObjectBinding(t);if(this.gameObjects[t]){var n=this.gameObjects[t];this.gameObjects.splice(t,1);var r=0;n.tag&&this.objectsByTag[n.tag]&&(r=this.objectsByTag[n.tag].indexOf(n),this.objectsByTag[n.tag].splice(r,1)),n.name&&
this.objectsByName[n.name]&&(r=this.objectsByName[n.name].indexOf(n),this.objectsByName[n.name].splice(r,1))}else{var r=this.gameObjects.indexOf(t);if(r==-1){e.debug.log("%cRemove gameObject not found",1,"color:orange",t);return}this.gameObjects.splice(r,1),t.tag&&this.objectsByTag[t.tag]&&(r=this.objectsByTag[t.tag].indexOf(t),this.objectsByTag[t.tag].splice(r,1)),t.name&&this.objectsByName[t.name]&&(r=this.objectsByName[t.name].indexOf(t),this.objectsByName[t.name].splice(r,1))}this.maxObjects--},o.prototype.delete=function(e){this.gameObjects[e]?this.gameObjects[e].killMePlease():e.killMePlease(),this.remove(e)},o.prototype.getObjectByTag=function(e){if(!this.objectsByTag[e])return null;this.objectsByTag[e][0]},o.prototype.getObjectsByTag=function(e){return this.objectsByTag[e]||[]},o.prototype.getObjectByName=function(e){return this.objectsByName[e]?this.objectsByName[e][0]:null},o.prototype.getObjectsByName=function(e){return this.objectsByName[e]||[]},o.prototype.deleteAll=function(
){var e=this.gameObjects;while(e.length>0)this.delete(0);this.maxObjects=0},o.prototype.DEName="Scene",e.debug.log("Scene loaded",3),o}),define("DE.Rigidbody",["DE.Vector2","DE.CONFIG"],function(e,t){function n(t,n){n=n||{},this.gameObject=t,this.velocity=n.velocity||new e(n.initialVelocityX||0,n.initialVelocityY||0),this.mass=n.mass||0,this.isKinetic=!1,this.isTrigger=!1,this.addForce=function(){},this.addForceTo=function(){}}return n.prototype=n.prototype||{},n.prototype.update=function(){},n.prototype.DEName="Rigidbody",t.debug.log("Rigidbody loaded",3),n}),define("DE.FixedBoxCollider",["DE.Collider","DE.COLORS","DE.CONFIG","DE.CanvasBuffer"],function(e,t,n,r){function i(i,s,o){o=o||{},o.type=n.COLLISION_TYPE.FIXED_BOX,e.call(this,o);var u=new Array,a=new Array,f=new Array;this.width=i||1,this.height=s||1,this.preventRotation=!0,this.localPosition.x-=this.width*.5,this.localPosition.y-=this.height*.5,this.createDebugRenderer=function(){this.debugBuffer=new r(this.width,this.height),this
.debugBuffer.ctx.lineWidth=2,this.debugBuffer.ctx.strokeStyle=t.DEBUG.COLLIDER,this.debugBuffer.ctx.strokeRect(0,0,this.width,this.height)},this.debugRender=function(e,t,n){if(!this.debugBuffer)return;e.rotate(-this.gameObject.position.rotation),e.drawImage(this.debugBuffer.canvas,this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.debugBuffer.canvas.width*t*n>>0,this.debugBuffer.canvas.height*t*n>>0),e.rotate(this.gameObject.position.rotation)},this.getRealPosition=function(){var e=this.gameObject.getPos(),t=this.gameObject.getHarmonics(),n=this.localPosition.x+this.width*.5,r=this.localPosition.y+this.height*.5;return{x:-(-n*t.cos+r*t.sin)+e.x-this.width*.5,y:-(-n*t.sin+r*-t.cos)+e.y-this.height*.5,z:e.z}},n.DEBUG_LEVEL>1&&this.createDebugRenderer()}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="FixedBoxCollider",n.debug.log("FixedBoxCollider loaded",3),i}),define("DE.OrientedBoxCollider",["DE.Collider","DE.CONFIG","DE.CanvasBuffer"
,"DE.COLORS"],function(e,t,n,r){function i(i,s,o){o=o||{},o.type=t.COLLISION_TYPE.ORIENTED_BOX,e.call(this,o);var u=new Array,a=new Array,f={x:this.localPosition.x,y:this.localPosition.y,radius:undefined};this.width=i||1,this.height=s||1;var l=-this.width*.5,c=this.width*.5,h=-this.height*.5,p=this.height*.5;this.init=function(){u.push({x:l,y:h}),u.push({x:l,y:p}),u.push({x:c,y:p}),u.push({x:c,y:h});for(var e=0,n;n=u[e];e++)n.ox=n.x,n.oy=n.y;var r=this.localPosition.x-(this.localPosition.x+u[0].x);r*=r;var i=this.localPosition.y-(this.localPosition.y+u[0].y);i*=i,f.radius=Math.sqrt(r+i);var s=this.width*.5;a.push({x:0,y:0,radius:s,isColliding:!1}),this.height<this.width&&(s=this.height*.5,a[0]={x:0,y:0,radius:s,isColliding:!1});var o=(this.width-s*2)/(s*2)/2,d=!0;o<=0&&(o=(this.height-s*2)/(s*2)/2,d=!1);if(o>0){o>>=0,o++;while(o>0)d?(a.push({x:-s+l+s*2*o,y:0,radius:s,isColliding:!1}),a.push({x:s-l-s*2*o,y:0,radius:s,isColliding:!1})):(a.push({x:0,y:-s+h+s*2*o,radius:s,isColliding:!1}),a
.push({x:0,y:s-h-s*2*o,radius:s,isColliding:!1})),o--}t.DEBUG_LEVEL>1&&this.createDebugRenderer()},this.createDebugRenderer=function(){this.debugBuffer=new n(f.radius,f.radius),this.debugBuffer.ctx.lineWidth=2,this.debugBuffer.ctx.strokeStyle=r.DEBUG.COLLIDER,this.debugBuffer.ctx.strokeRect(0,0,this.width,this.height),this.debugBuffer.ctx.strokeStyle="blue",this.debugBuffer.ctx.beginPath(),this.debugBuffer.ctx.arc(this.localPosition.x,this.localPosition.y,f.radius,0,Math.PI*2,!0),this.debugBuffer.ctx.stroke(),this.debugBuffer.ctx.closePath();for(var e=0,t;t=a[e];e++)this.debugBuffer.ctx.strokeStyle="blue",this.isColliding&&(this.debugBuffer.ctx.strokeStyle="green"),this.debugBuffer.ctx.beginPath(),this.debugBuffer.ctx.arc(this.localPosition.x+t.x,this.localPosition.y+t.y,t.radius,0,Math.PI*2,!0),this.debugBuffer.ctx.stroke(),this.debugBuffer.ctx.closePath();for(var e=0,i;i=u[e];e++)this.debugBuffer.ctx.strokeStyle="red",this.debugBuffer.ctx.fillRect(i.x-1,i.y-1,2,2)},this.debugRender=function(
e){e.rotate(-this.gameObject.position.rotation),e.drawImage(this.debugBuffer.canvas,this.localPosition.x-this.debugBuffer.canvas.width*.5>>0,this.localPosition.y-this.debugBuffer.canvas.height*.5>>0),e.rotate(this.gameObject.position.rotation)},this.getExternCircle=function(){return f},this.getInternCircles=function(){return a},this.init()}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="OrientedBoxCollider",t.debug.log("OrientedBoxCollider loaded",3),i}),define("DE.CircleCollider",["DE.Collider","DE.CONFIG","DE.CanvasBuffer","DE.COLORS"],function(e,t,n,r){function i(i,s){s=s||{},s.type=t.COLLISION_TYPE.CIRCLE,e.call(this,s),this.radius=i||1,this.createDebugRenderer=function(){this.debugBuffer=new n(this.radius*2,this.radius*2),this.debugBuffer.ctx.lineWidth=2,this.debugBuffer.ctx.strokeStyle=r.DEBUG.CIRCLE_COLLIDER,this.debugBuffer.ctx.beginPath(),this.debugBuffer.ctx.arc(this.radius,this.radius,this.radius,0,Math.PI*2,!0),this.debugBuffer
.ctx.stroke(),this.debugBuffer.ctx.closePath()},this.debugRender=function(e,t,n){if(!this.debugBuffer)return;e.drawImage(this.debugBuffer.canvas,this.localPosition.x-this.debugBuffer.canvas.width*.5*t*n>>0,this.localPosition.y-this.debugBuffer.canvas.height*.5*t*n>>0,this.debugBuffer.canvas.width*t*n>>0,this.debugBuffer.canvas.height*t*n>>0)},t.DEBUG_LEVEL>1&&this.createDebugRenderer()}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="CircleCollider",t.debug.log("CircleCollider loaded",3),i}),define("DE.BoxRenderer.render",["DE.CONFIG"],function(e){function t(e,t,n){var r=e.globalAlpha;e.globalAlpha=this.alpha*r;switch(this.method){case"fill":this.fillIt(e,t,n);break;case"fillAndStroke":this.fillIt(e,t,n),this.strokeIt(e,t,n);break;case"stroke":this.strokeIt(e,t,n);break;default:this.strokeIt(e,t,n)}e.globalAlpha=r}return e.debug.log("BoxRenderer.render loaded",3),t}),define("DE.BoxRenderer",["DE.Renderer","DE.BoxRenderer.render","DE.CONFIG"
,"DE.Sizes"],function(e,t,n,r){function i(t,n,i){e.call(this,t),this.sizes=new r(n,i,t.scaleX||t.scale||1,t.scaleY||t.scale||1,this),this.preventCenter=t.preventCenter||!1,this.preventCenter||this.sizes._center(),this.fillIt=function(e,t,n){e.fillStyle=this.fillColor,e.fillRect(this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.sizes.width*this.sizes.scaleX*t*n>>0,this.sizes.height*this.sizes.scaleY*t*n>>0)},this.strokeIt=function(e,t,n){e.lineWidth=this.lineWidth,e.strokeStyle=this.strokeColor,e.strokeRect(this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.sizes.width*this.sizes.scaleX*t*n>>0,this.sizes.height*this.sizes.scaleY*t*n>>0)},this.setWidth=function(e){this.sizes.setSizes(e,this.sizes.height)},this.setHeight=function(e){this.sizes.setSizes(this.sizes.width,e)},this.setSizes=function(e,t){this.sizes.setSizes(e,t)}}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="BoxRenderer",i.prototype.render=t,n.debug.log
("BoxRenderer loaded",3),i}),define("DE.CircleRenderer.render",["DE.CONFIG"],function(e){function t(e,t,n){var r=e.globalAlpha;e.globalAlpha=this.alpha*r,e.drawImage(this.buffer.canvas,this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.radius*2*t*n>>0,this.radius*2*t*n>>0),e.globalAlpha=r}return e.debug.log("CircleRenderer.render loaded",3),t}),define("DE.CircleRenderer",["DE.Renderer","DE.CircleRenderer.render","DE.CONFIG","DE.CanvasBuffer"],function(e,t,n,r){function i(t,n,i,s,o){e.call(this,t),this.radius=n||1,this.angleStart=i||0,this.angleEnd=s||Math.PI*2,this.clockRotation=o||!1,this.buffer=null,this.preventCenter=t.preventCenter||!1,this.preventCenter||(this.localPosition.x-=this.radius,this.localPosition.y-=this.radius),this.initCircle=function(){this.buffer=new r(this.radius*2+this.lineWidth,this.radius*2+this.lineWidth),this.redraw()},this.redraw=function(){var e=this.buffer.ctx;e.clearRect(0,0,this.radius*2+this.lineWidth,this.radius*2+this.lineWidth),e.fillStyle=this
.fillColor,e.lineWidth=this.lineWidth,e.strokeStyle=this.strokeColor,e.globalAlpha=this.alpha,e.beginPath(),e.arc(this.radius+this.lineWidth/2>>0,this.radius+this.lineWidth/2>>0,this.radius,this.angleStart,this.angleEnd,this.clockRotation);switch(this.method){case"fill":e.fill();break;case"fillAndStroke":e.fill(),e.stroke();break;case"stroke":e.stroke();break;default:e.stroke()}e.closePath()},this.initCircle()}return i.prototype=new e,i.prototype.constructor=i,i.prototype.supr=e.prototype,i.prototype.DEName="CircleRenderer",i.prototype.render=t,n.debug.log("CircleRenderer loaded",3),i}),define("DE.SpriteRenderer.render",["DE.ImageManager","DE.CONFIG","DE.Time"],function(e,t,n){function r(t,r,i){if(this.isAnimated&&!this.isPaused&&!this.isOver&&n.currentTime-this.lastAnim>this.eachAnim){var s=(n.currentTime-this.lastAnim)/this.eachAnim>>0;this.lastAnim=n.currentTime;while(s>0)this.isReversed?!this.isLoop&&this.currentFrame-1<this.startFrame?(this.isOver=!0,this.onAnimEnd()):this.currentFrame=
this.currentFrame-1<this.startFrame?this.endFrame-1:this.currentFrame-1:!this.isLoop&&this.currentFrame+1>=this.endFrame?(this.isOver=!0,this.onAnimEnd()):this.currentFrame=this.currentFrame+1>=this.endFrame?this.startFrame:this.currentFrame+1,s--}var o=t.globalAlpha;t.globalAlpha=this.alpha*o,t.drawImage(e.images[this.spriteName],this.frameSizes.width*this.currentFrame,this.frameSizes.height*this.currentLine,this.frameSizes.width,this.frameSizes.height,this.localPosition.x*i>>0,this.localPosition.y*i>>0,this.sizes.width*this.sizes.scaleX*i>>0,this.sizes.height*this.sizes.scaleY*i>>0),t.globalAlpha=o}return t.debug.log("SpriteRender.render loaded",3),r}),define("DE.SpriteRenderer",["DE.Renderer","DE.ImageManager","DE.Sizes","DE.SpriteRenderer.render","DE.CONFIG","DE.Time","DE.Event"],function(e,t,n,r,i,s,o){function u(r){if(!r)throw new Error("SpriteRenderer :: You have to pass arguments object to instantiate -- see the doc");e.call(this,r),this.spriteName=r.spriteName||undefined;if(!this
.spriteName)throw new Error("SpriteRenderer :: No spriteName defined -- declaration canceled");if(!t.images[this.spriteName])throw new Error("SpriteRenderer :: Can't find image "+this.spriteName+" in imagesDatas");this.startFrame=r.startFrame||t.images[this.spriteName].startFrame||0,this.endFrame=r.endFrame||t.images[this.spriteName].endFrame||t.images[this.spriteName].totalFrame||0,this.currentFrame=this.startFrame||0,this.startLine=r.startLine||0,this.currentLine=r.startLine||0,this.totalFrame=t.images[this.spriteName].totalFrame||0,this.totalLine=r.totalLine||t.images[this.spriteName].totalLine||0,this.eachAnim=r.eachAnim||t.images[this.spriteName].eachAnim||0,this.lastAnim=Date.now(),this.frameSizes=new n(t.images[this.spriteName].widthFrame,t.images[this.spriteName].heightFrame,1,1),r.scaleX=r.scale||r.scaleX||r.scalex||1,r.scaleY=r.scale||r.scaleY||r.scaley||1,this.sizes=new n(r.width||r.w||t.images[this.spriteName].widthFrame,r.height||r.h||t.images[this.spriteName].heightFrame,r
.scaleX,r.scaleY,this),this.isAnimated=r.isAnimated!==undefined?r.isAnimated:t.images[this.spriteName].isAnimated,this.isPaused=r.paused!==undefined?r.paused:r.isPaused||!1,t.images[this.spriteName].isPaused||!1,this.isReversed=r.reversed!==undefined?r.reversed:r.isreversed!=undefined?r.isreversed:r.isReversed!=undefined?r.isReversed:t.images[this.spriteName].isReversed||!1,this.isOver=!1,this.isLoop=r.isLoop!=undefined?r.isLoop:t.images[this.spriteName].isLoop,this.preventCenter=r.preventCenter||!1,this.preventCenter||this.sizes._center(),this.onAnimEnd=function(){},o.on("imageLoaded",function(e,n,r){if(r!=this.spriteName)return;this.frameSizes.width=t.images[this.spriteName].widthFrame,this.frameSizes.height=t.images[this.spriteName].heightFrame,this.sizes.setSizes(this.frameSizes)},this)}return u.prototype=new e,u.prototype.constructor=u,u.prototype.supr=e.prototype,u.prototype.DEName="SpriteRenderer",u.prototype.render=r,u.prototype.setFrame=function(e){e+1>=this.endFrame?this.currentFrame=
this.endFrame-1:e<this.startFrame?this.currentFrame=this.startFrame:this.currentFrame=e},u.prototype.setLine=function(e){e+1>=this.totalLine?this.currentLine=this.totalLine-1:this.currentLine=e},u.prototype.restartAnim=function(){this.isOver=!1,this.isReversed?this.currentFrame=this.endFrame-1:this.currentFrame=this.startFrame,this.lastAnim=s.currentTime},u.prototype.setPause=function(e,t){this.isPaused=e,!e&&!this.isAnimated&&(this.isAnimated=!0,this.lastAnim=Date.now())},u.prototype.setEndFrame=function(e){this.totalFrame<=e?this.endFrame=this.totalFrame-1:this.endFrame=e},u.prototype.setDelay=function(e){this.eachAnim=e},u.prototype.setLoop=function(e){this.isLoop=e},u.prototype.changeSprite=function(e,r){r=r||{},this.spriteName=e,this.startFrame=r.startFrame||0,this.endFrame=r.endFrame||t.images[this.spriteName].totalFrame||0,this.totalFrame=t.images[this.spriteName].totalFrame||0,this.totalLine=r.totalLine||t.images[this.spriteName].totalLine||0,this.currentFrame=r.currentFrame!==undefined?
r.currentFrame:this.currentFrame>this.endFrame?0:this.currentFrame,this.eachAnim=r.eachAnim||t.images[this.spriteName].eachAnim||0,this.lastAnim=Date.now(),this.frameSizes=new n(t.images[this.spriteName].widthFrame,t.images[this.spriteName].heightFrame,1,1),r.scaleX=r.scale||r.scaleX||r.scalex||1,r.scaleY=r.scale||r.scaleY||r.scaley||1,this.sizes._uncenter(),this.sizes=new n(r.width||r.w||t.images[this.spriteName].widthFrame,r.height||r.h||t.images[this.spriteName].heightFrame,r.scaleX,r.scaleY,this),this.sizes._center(),this.isAnimated=r.isAnimated!==undefined?r.isAnimated:t.images[this.spriteName].isAnimated,this.isPaused=r.paused!==undefined?r.paused:r.isPaused||!1,t.images[this.spriteName].isPaused||!1,this.isReversed=r.reversed!==undefined?r.reversed:r.isreversed!=undefined?r.isreversed:r.isReversed!=undefined?r.isReversed:t.images[this.spriteName].isReversed||!1,this.isOver=!1,this.isLoop=r.isLoop!=undefined?r.isLoop:t.images[this.spriteName].isLoop},i.debug.log("SpriteRenderer loaded"
,3),u}),define("DE.Render",["DE.CONFIG","DE.Sizes","DE.Time","DE.MainLoop","DE.CollisionSystem","DE.Inputs","DE.CanvasBuffer"],function(e,t,n,r,i,s,o){function u(u,a){function f(){return{x:document.scrollLeft||window.pageXOffset,y:document.scrollTop||window.pageYOffset}}function l(e,t,n){var r={x:e,y:t},i=this.canvas,s=0,o=0;while(i)s+=i.offsetLeft,o+=i.offsetTop,i=i.parentElement;return r.x-=s,r.y-=o,{x:r.x/c+f().x>>0,y:r.y/c+f().y>>0,index:n}}a=a||{},this.id=0,this.divId=u||undefined,this.canvas=null,this.ctx=null,this.sizes=new t(a.width||e.defaultRenderWidth||100,a.height||e.defaultRenderHeight||100,a.scaleX||1,a.scaleY||1),this.savedSizes=new t(a.width||e.defaultRenderWidth||100,a.height||e.defaultRenderHeight||100,a.scaleX||1,a.scaleY||1);var c=1;this.physicRatio=1,this.alpha=a.alpha||1,this.conserveSizes=a.conserveSizes||!1,this.fullScreenMode=a.fullScreen||null,this.cameras=new Array,this.maxCameras=0,this.events={},this.isFullscreen=!1,this.freeze=!1,this.init=function(){if(this
.inited)return;r.addRender(this);if(!this.divId)this.div=window.document.body,e.debug.log("%cWARN: you not specified a DOM Object where push the render, it will push in the body *hiiik*",1,"color:orange");else{this.div=document.getElementById(this.divId);if(!this.div)throw new Error("Can't found the div by the given id")}this.canvas=document.createElement("canvas"),this.div.appendChild(this.canvas),s.addRender(this),this.ctx=this.canvas.getContext("2d"),this.buffer=new o(this.sizes.width,this.sizes.height),this.inited=!0,this.updateSizes();var t=this;this.div.addEventListener("fullscreenchange",function(e){t.isFullscreen=document.fullscreenElement},!1),this.div.addEventListener("msfullscreenchange",function(e){t.isFullscreen=document.msFullscreenElement},!1),this.div.addEventListener("mozfullscreenchange",function(e){t.isFullscreen=document.mozFullScreen},!1),this.div.addEventListener("webkitfullscreenchange",function(e){t.isFullscreen=document.webkitIsFullScreen},!1)},this.goFullscreen=
function(){this.isFullscreen?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this.div.requestFullscreen?this.div.requestFullscreen():this.div.msRequestFullscreen?this.div.msRequestFullscreen():this.div.mozRequestFullScreen?this.div.mozRequestFullScreen():this.div.webkitRequestFullscreen&&this.div.webkitRequestFullscreen()},this.updateSizes=function(){if(!this.inited)return;this.conserveSizes?(this.sizes.width=this.div.offsetWidth.valueOf(),this.sizes.height=this.div.offsetHeight.valueOf()):(this.div.style.width=this.sizes.width+"px",this.div.style.height=this.sizes.height+"px"),this.canvas.width=this.sizes.width.valueOf(),this.canvas.height=this.sizes.height.valueOf(),this.canvas.id=this.id,this.fullScreenMode&&(this.fullScreen(this.fullScreenMode),this.resizeOnEventResize()),this.buffer.resize(this.sizes.width
,this.sizes.height)},this.screenChangedSizeIndex=function(e,t){this.savedSizes.width=t.w,this.savedSizes.height=t.h,this.physicRatio=e,this.updateSizes();for(var n=0,r;r=this.cameras[n];++n)r.screenChangedSizeIndex(e,t)},this.resize=function(e,t,n){this.div!=window.document.body&&(this.div.style.width=e+"px",this.div.style.height=t+"px"),this.canvas.width=e,this.canvas.height=t,this.sizes.width=e,this.sizes.height=t},this.resizeOnEventResize=function(){if(!this.fullScreenMode)return;var e=this,t=undefined,n=function(){e.fullScreenMethod.call(e)};window.addEventListener?window.addEventListener("resize",function(){t&&window.clearTimeout(t),t=window.setTimeout(n,200)},!1):window.attachEvent&&window.attachEvent("onresize",function(){t&&window.clearTimeout(t),t=window.setTimeout(n,200)})},this.resizeRatio=function(e,t,n){var r=this.savedSizes.width,i=this.savedSizes.height,s=e/r;s*i>t&&(s=t/i);var o=s*r>>0,u=s*i>>0;this.resize(o,u,n),this.isFullscreen?(this.div.style.marginLeft=0,this.div.style
.marginTop=0):(this.div.style.marginLeft=(e-o)/2+"px",this.div.style.marginTop=(t-u)/2+"px"),c=o/this.savedSizes.width};var h;this.changeFullScreenMode=function(e){this.fullScreenMode=e;switch(e){case"ratioStretch":h=function(e,t){this.resizeRatio(e,t,!0)};break;case"fullStretch":h=function(e,t){this.resize(e,t,!0)};break;case"ratio":h=function(e,t){this.resizeRatio(e,t,!1)};break;default:h=function(e,t){}}},this.fullScreenMethod=function(){var e=window.innerWidth||document.documentElement.clientWidth,t=window.innerHeight||document.documentElement.clientHeight,n=window.getComputedStyle(this.div.parentElement,null).getPropertyValue("height");if(this.div.parentElement!=null&&n&&t<document.body.clientHeight){var r=this.div.parentElement.innerWidth||this.div.parentElement.clientWidth,i=this.div.parentElement.innerHeight||this.div.parentElement.clientHeight;i<t&&(t=i),r<e&&(e=r)}if(!h)throw"Render.js : fullScreenMethod need a fullScreenMode, maybe you never used changeFullScreenMode";h.call(
this,e,t)},this.fullScreen=function(e,t){e&&this.changeFullScreenMode(e),t,this.fullScreenMethod()},this.render=function(){if(this.freeze)return;this.ctx.globalAlpha=this.alpha,this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.sizes.width,this.sizes.height);for(var t=0,r;r=this.cameras[t];++t)r.render(this.ctx,c,this.physicRatio);e.DEBUG_LEVEL>0&&(this.ctx.globalAlpha=1,this.ctx.font="24px Arial",this.ctx.fillStyle="white",this.ctx.fillText("DeltaTime: "+n.deltaTime,(this.sizes.width>>0)-220,30),this.ctx.fillText("MissedFrame: "+n.missedFrame,(this.sizes.width>>0)-220,60),this.ctx.fillText("FPS: "+n.fps,(this.sizes.width>>0)-220,90))},this.update=function(){if(this.freeze)return;for(var e in this.events)this.camerasMouseCollide.apply(this,this.events[e]),delete this.events[e]},this.updateGuis=function(){if(this.sleep||this.freeze)return;for(var e=0,t;t=this.cameras[e];++e)t.gui&&!t.gui.sleep&&t.gui.update()},this.add=function(e){this.cameras.push(e),e.on("changeCursor",function(e){this
.canvas.style.cursor=e},this),this.maxScenes++,e.screenChangedSizeIndex(this.physicRatio,this.savedSizes)},this.remove=function(t){var n=this.cameras.indexOf(t);if(n==-1){e.debug.log("Remove camera not found ",1,t);return}this.cameras.splice(n,1),this.maxScenes--},this.camerasMouseCollide=function(e,t,n,r){var s=l.call(this,t,n,r);if(this["on"+e](s)||s.stopPropagation)return s;for(var o=0,u,a;o<this.cameras.length;o++){u=this.cameras[o];if(u.sleep)continue;a={x:u.renderPosition.x-u.renderSizes.width*.5*u.renderSizes.scaleX,y:u.renderPosition.y-u.renderSizes.height*.5*u.renderSizes.scaleY,width:u.renderSizes.width*u.renderSizes.scaleX,height:u.renderSizes.height*u.renderSizes.scaleY,enable:!0};if(i.pointFixedBoxCollision(s,a)){if(!u.indexMouseOver[r]&&u.oOnMouseEnter(s,this.physicRatio))break;if(u["oOn"+e](s,this.physicRatio))break}else if(u.indexMouseOver[r]&&u.oOnMouseLeave(s,this.physicRatio))break}return s.stopPropagation||this["lastOn"+e](s),s},this.onMouseMove=function(){},this.onMouseDown=
function(){},this.onMouseUp=function(){},this.lastOnMouseMove=function(){},this.lastOnMouseDown=function(){},this.lastOnMouseUp=function(){},this.oOnMouseDown=function(e){this.events[Date.now()+"down"]=["MouseDown",e.x,e.y,e.index]},this.oOnMouseUp=function(e){this.events[Date.now()+"up"]=["MouseUp",e.x,e.y,e.index]},this.oOnMouseMove=function(e){this.events[Date.now()+"move"]=["MouseMove",e.x,e.y,e.index]}}return u.prototype.DEName="Render",e.debug.log("Render loaded",3),u}),define("DE.Mid.gameObjectMouseEvent",["DE.CollisionSystem"],function(e){function t(n,r,i,s){if(!r.enable)return!1;var o=r.indexMouseOver[i.index];if(r.collider&&(r["onMouse"+n]||r.onMouseLeave||r.onMouseEnter)){if(e.checkCollisionWith(i,r.collider)){r.indexMouseOver[i.index]=!0,r.cursorOnOver&&(s.cursor="pointer");if(!o&&r.onMouseEnter&&r.onMouseEnter(i,s))return!0;if(r["onMouse"+n]&&r["onMouse"+n](i,s))return!0}else if(o){r.cursorOnOver&&(s.cursor="default"),r.indexMouseOver[i.index]=!1;if(r.onMouseLeave&&r.onMouseLeave
(i,s))return!0}}else r.collider&&r.cursorOnOver&&(e.checkCollisionWith(i,r.collider)?(r.indexMouseOver[i.index]=!0,s.cursor="pointer"):o&&(r.indexMouseOver[i.index]=!1,s.cursor="default"));for(var u=r.childrens.length-1,a;u>=0;--u)if(t(n,r.childrens[u],i,s))return!0}return t}),define("DE.Camera",["DE.CONFIG","DE.Sizes","DE.Vector2","DE.CanvasBuffer","DE.Mid.gameObjectMouseEvent","DE.ImageManager","DE.Event","DE.Time"],function(e,t,n,r,i,s,o,u){function a(e,i,s,u,a){a=a||{},this.name=a.name||"",this.tag=a.tag||"",this.scene=a.scene||null,this.gui=a.gui||undefined,this.renderSizes=new t(e,i,a.scale||a.scaleX||1,a.scale||a.scaleY||1),this.fieldSizes=new t(e,i,a.scale||a.scaleX||1,a.scale||a.scaleY||1),this.renderPosition=new n(s+e*.5,u+i*.5,a.z||-10),this.savedPosition=new n(s+e*.5,u+i*.5,a.z||-10),this.scenePosition=new n(a.realx||0,a.realy||0,a.realz||a.z||-10),this.limits={minX:a.minX!=undefined?a.minX:undefined,maxX:a.maxX!=undefined?a.maxX:undefined,minY:a.minY!=undefined?a.minY:undefined
,maxY:a.maxY!=undefined?a.maxY:undefined},this.alpha=a.alpha||1,this.bufferAlpha=a.bufferAlpha||1,this.backgroundColor=a.backgroundColor||null,this.backgroundImage=a.backgroundImage||null,this.useTransparency=a.useTransparency||a.transparent||!1,this.stretchedBackground=a.stretchedBackground!=undefined?a.stretchedBackground:!0,this.cameras=new Array,this.maxCameras=0,this.freeze=!1,this.sleep=!1,this.startX=0,this.startY=0,this._buffer=new r(this.renderSizes.width,this.renderSizes.height),this._visibleGameObjects=[],this.indexMouseOver={},this.lastPointersPos={},this._propagationEvent={},this.fadeData={from:1,to:0,duration:1e3,done:!0},this.fadeBufferData={from:1,to:0,duration:500,done:!0},this.shakeData={done:!0,prevX:0,prevY:0},this.moveData={done:!0},o.addEventComponents(this)}return a.prototype.render=function(t,n,r){if(this.sleep)return;var i=t.globalAlpha,o=this._buffer;if(!this.freeze){this.applyFocus(),this.checkLimits(r),this.applyShake(),this.applyMove(),o.ctx.globalAlpha=this
.bufferAlpha*i,this.useTransparency&&o.ctx.clearRect(0,0,this.renderSizes.width,this.renderSizes.height),this.backgroundImage!=null?this.stretchedBackground?o.ctx.drawImage(s.images[this.backgroundImage],0,0,this.renderSizes.width,this.renderSizes.height):o.ctx.drawImage(s.images[this.backgroundImage],0,0):this.backgroundColor!=null&&(o.ctx.fillStyle=this.backgroundColor,o.ctx.fillRect(0,0,this.renderSizes.width,this.renderSizes.height)),o.ctx.save();if(this.scene){var u=this.scene.gameObjects;this._visibleGameObjects=[];for(var a=0,f=u.length,l,c,h,p;a<f;a++){l=u[a];if(l.position.z<this.scenePosition.z)continue;p=10/(l.position.z-this.scenePosition.z),c=l.position.x,h=l.position.y,p!=1&&(c=(l.position.x-(this.scenePosition.x+this.fieldSizes.width*.5))*p+(this.scenePosition.x+this.fieldSizes.width*.5),h=(l.position.y-(this.scenePosition.y+this.fieldSizes.height*.5))*p+(this.scenePosition.y+this.fieldSizes.height*.5)),l&&l.enable&&c+l.biggerOffset.width*p>=this.scenePosition.x&&c-l.biggerOffset
.width*p<=this.scenePosition.x+this.fieldSizes.width&&h+l.biggerOffset.height*p>=this.scenePosition.y&&h-l.biggerOffset.height*p<=this.scenePosition.y+this.fieldSizes.height&&(this._visibleGameObjects.push(l),l.render(o.ctx,r,this.scenePosition,this.fieldSizes))}}else o.ctx.textAlign="center",o.ctx.fillStyle="white",o.ctx.fillText("No scene affiliated :(",this.renderSizes.width*.5,this.renderSizes.height*.5);o.ctx.restore(),o.ctx.globalAlpha=this.alpha*i,e.DEBUG&&(o.ctx.fillStyle="white",o.ctx.textAlign="left",o.ctx.fillText("Camera "+this.name,10,20),o.ctx.strokeStyle="red",o.ctx.strokeRect(0,0,this.renderSizes.width>>0,this.renderSizes.height>>0),o.ctx.fillStyle="yellow",o.ctx.fillRect(this.renderSizes.width-10,this.renderSizes.height-10,10,10),o.ctx.fillRect(this.renderSizes.width-10,0,10,10),o.ctx.fillRect(0,this.renderSizes.height-10,10,10),o.ctx.fillRect(0,0,10,10),o.ctx.fillRect(this.renderSizes.width*.5,this.renderSizes.height*.5,20,5),o.ctx.fillRect(this.renderSizes.width*.5,this
.renderSizes.height*.5,5,20)),this.applyFade()}t.translate(this.renderPosition.x*n>>0,this.renderPosition.y*n>>0),t.rotate(this.renderPosition.rotation),this.gui&&this.gui.render(o.ctx,n,r,this.renderSizes),t.globalAlpha=this.alpha,t.drawImage(o.canvas,-this.renderSizes.width*this.renderSizes.scaleX*n*.5>>0,-this.renderSizes.height*this.renderSizes.scaleY*n*.5>>0,this.renderSizes.width*this.renderSizes.scaleX*n>>0,this.renderSizes.height*this.renderSizes.scaleY*n>>0),t.rotate(-this.renderPosition.rotation),t.translate(-this.renderPosition.x*n>>0,-this.renderPosition.y*n>>0),t.globalAlpha=i},a.prototype.checkLimits=function(e){var t=this.limits;t.minX!=undefined&&this.scenePosition.x<t.minX*e?this.scenePosition.x=t.minX*e:t.maxX!=undefined&&this.scenePosition.x+this.renderSizes.width>t.maxX*e&&(this.scenePosition.x=t.maxX*e-this.renderSizes.width),t.minY!=undefined&&this.scenePosition.y<t.minY*e?this.scenePosition.y=t.minY*e:t.maxY!=undefined&&this.scenePosition.y+this.renderSizes.height>
t.maxY*e&&(this.scenePosition.y=t.maxY*e-this.renderSizes.height)},a.prototype.screenChangedSizeIndex=function(e){this.renderSizes.width=this.fieldSizes.width*e>>0,this.renderSizes.height=this.fieldSizes.height*e>>0,this.renderPosition.x=this.savedPosition.x*e>>0,this.renderPosition.y=this.savedPosition.y*e>>0,this._buffer.canvas.width=this.renderSizes.width,this._buffer.canvas.height=this.renderSizes.height},a.prototype.add=function(e){this.cameras.push(e),++this.maxCameras},a.prototype.remove=function(t){var n=this.cameras.indexOf(t);if(n==-1){e.debug.log("%cRemove camera not found ",1,"color:orange",t);return}this.cameras.splice(n,1),this.maxCameras--},a.prototype.applyFade=function(){if(!this.fadeData.done){this.fadeData.stepVal=u.timeSinceLastFrame/this.fadeData.oDuration*u.scaleDelta*this.fadeData.dir*this.fadeData.fadeScale,this.alpha+=this.fadeData.stepVal*u.scaleDelta,this.fadeData.duration-=u.timeSinceLastFrame*u.scaleDelta;if(this.fadeData.dir<0&&this.alpha<=this.fadeData.to||
this.fadeData.dir>0&&this.alpha>=this.fadeData.to||this.alpha<0||this.alpha>1)this.alpha=this.fadeData.to;this.fadeData.duration<=0&&(this.trigger("fadeEnd"),this.fadeData.done=!0,(this.alpha==1||this.alpha==0)&&this.alpha==0&&(this.sleep=!0))}if(!this.fadeBufferData.done){this.fadeBufferData.stepVal=u.timeSinceLastFrame/this.fadeBufferData.oDuration*u.scaleDelta*this.fadeBufferData.dir*this.fadeBufferData.fadeScale,this.bufferAlpha+=this.fadeBufferData.stepVal*u.scaleDelta,this.fadeBufferData.duration-=u.timeSinceLastFrame*u.scaleDelta;if(this.fadeBufferData.dir<0&&this.bufferAlpha<=this.fadeBufferData.to||this.fadeBufferData.dir>0&&this.bufferAlpha>=this.fadeBufferData.to||this.bufferAlpha<0||this.bufferAlpha>1)this.bufferAlpha=this.fadeBufferData.to;if(this.fadeBufferData.duration<=0){this.trigger("fadeBufferEnd"),this.fadeBufferData.done=!0;if(this.bufferAlpha==1||this.bufferAlpha==0)this.bufferAlpha==0&&(this.sleep=!0),this.useTransparency=this.oUseTransparency}}},a.prototype.fade=
function(e,t,n,r){if(r&&t==this.bufferAlpha||t==this.alpha||this.alpha==0&&r)return;this.sleep=!1;var i={from:e||1,to:t!=undefined?t:0,duration:n||500,oDuration:n||500,fadeScale:Math.abs(e-t),done:!1};i.dir=i.from>t?-1:1,r?(this.fadeBufferData=i,this.oUseTransparency=this.useTransparency,this.useTransparency=!0):(this.alpha=e,this.fadeData=i)},a.prototype.fadeTo=function(e,t,n){this.sleep=!1,this.fade(this.alpha,e,t,n)},a.prototype.fadeOut=function(e,t){this.fade(this.alpha,0,e,t)},a.prototype.fadeIn=function(e,t){this.fade(this.alpha,1,e,t)},a.prototype.shake=function(e,t,n,r){this.shakeData={duration:n||500,xRange:e,yRange:t,prevX:this.shakeData?this.shakeData.prevX:0,prevY:this.shakeData?this.shakeData.prevY:0,callback:r}},a.prototype.applyShake=function(){if(this.shakeData.done)return;var e=this.shakeData;this.scenePosition.x-=e.prevX,this.scenePosition.y-=e.prevY,e.duration-=u.timeSinceLastFrame*u.scaleDelta;if(e.duration<=0){e.callback&&e.callback.call(this,e.callback),e.done=!0,e
.prevX=0,e.prevY=0,this.trigger("shakeEnd");return}e.prevX=-(Math.random()*e.xRange)+Math.random()*e.xRange>>0,e.prevY=-(Math.random()*e.yRange)+Math.random()*e.yRange>>0,this.scenePosition.x+=e.prevX,this.scenePosition.y+=e.prevY},a.prototype.moveTo=function(e,t,n,r){var i=this.scenePosition;this.moveData={distX:-(i.x-(e.x!==undefined?e.x:i.x)),distY:-(i.y-(e.y!==undefined?e.y:i.y)),distZ:-(i.z-(e.z!==undefined?e.z:i.z)),dirX:i.x>e.x?1:-1,dirY:i.y>e.y?1:-1,dirZ:i.z>e.z?1:-1,duration:t||500,oDuration:t||500,curveName:r||"linear",done:!1,stepValX:0,stepValY:0,stepValZ:0,destX:e.x!==undefined?e.x:i.x,destY:e.y!==undefined?e.y:i.y,destZ:e.z!==undefined?e.z:i.z,callback:n},this.moveData.leftX=this.moveData.distX,this.moveData.leftY=this.moveData.distY,this.moveData.leftZ=this.moveData.distZ},a.prototype.applyMove=function(){if(this.moveData.done)return;var e=this.moveData;e.distX!=0&&(e.stepValX=u.timeSinceLastFrame/e.oDuration*e.distX*u.scaleDelta,e.leftX-=e.stepValX,this.scenePosition.x+=
e.stepValX),e.distY!=0&&(e.stepValY=u.timeSinceLastFrame/e.oDuration*e.distY*u.scaleDelta,e.leftY-=e.stepValY*e.dirY,this.scenePosition.y+=e.stepValY),e.distZ!=0&&(e.stepValZ=u.timeSinceLastFrame/e.oDuration*e.distZ*u.scaleDelta,e.leftZ-=e.stepValZ*e.dirZ,this.scenePosition.z+=e.stepValZ),e.duration-=u.timeSinceLastFrame*u.scaleDelta,e.dirX<0&&e.leftX<0?this.scenePosition.x+=e.leftX:e.dirX>0&&e.leftX>0&&(this.scenePosition.x-=e.leftX),e.dirY<0&&e.leftY<0?this.scenePosition.y+=e.leftY:e.dirY>0&&e.leftY>0&&(this.scenePosition.y-=e.leftY),e.dirZ<0&&e.leftZ<0?this.scenePosition.z+=e.leftZ:e.dirZ>0&&e.leftZ>0&&(this.scenePosition.z-=e.leftZ);if(e.duration<=0){e.done=!0,this.scenePosition.setPosition(e.destX,e.destY,e.destZ),e.callback&&e.callback.call(this,e.callback),this.trigger("moveEnd");return}},a.prototype.focus=function(e,t){t=t||{},this.target=e,this.focusLock=t.lock||{},this.focusOffset=t.offsets||{x:0,y:0}},a.prototype.applyFocus=function(){if(!this.target)return;var e=this.target.
getPos();this.focusLock.x||(this.scenePosition.x=e.x-this.fieldSizes.width*.5+(this.focusOffset.x||0)),this.focusLock.y||(this.scenePosition.y=e.y-this.fieldSizes.height*.5+(this.focusOffset.y||0))},a.prototype.convertMousePos=function(e,t){e.x-=this.renderPosition.x-this.renderSizes.width*.5>>0,e.y-=this.renderPosition.y-this.renderSizes.height*.5>>0;var n=this.renderPosition.getHarmonics();if(n.sin==0&&n.cos==0)return this.renderSizes.scaleX!=1||this.renderSizes.scaleY!=1?{x:(e.x/t-(this.renderSizes.width-this.renderSizes.width*this.renderSizes.scaleX)/2)/this.renderSizes.scaleX>>0,y:(e.y/t-(this.renderSizes.height-this.renderSizes.height*this.renderSizes.scaleY)/2)/this.renderSizes.scaleY>>0,index:e.index}:{x:e.x/t>>0,y:e.y/t>>0,index:e.index};var r=this.renderSizes.width/2-e.x,i=this.renderSizes.height/2-e.y;return this.renderSizes.scaleX!=1||this.renderSizes.scaleY!=1?{x:((-(r*n.cos+i*n.sin)+this.renderSizes.width/2)/t-(this.renderSizes.width-this.renderSizes.width*this.renderSizes
.scaleX)/2)/this.renderSizes.scaleX>>0,y:((r*n.sin+i*-n.cos+this.renderSizes.height/2)/t-(this.renderSizes.height-this.renderSizes.height*this.renderSizes.scaleY)/2)/this.renderSizes.scaleY>>0,index:e.index,isDown:e.isDown}:{x:(-(r*n.cos+i*n.sin)+this.renderSizes.width/2)/t>>0,y:(r*n.sin+i*-n.cos+this.renderSizes.height/2)/t>>0,index:e.index,isDown:e.isDown}},a.prototype.onMouseDown=function(){},a.prototype.onMouseEnter=function(){},a.prototype.onMouseMove=function(){},a.prototype.onMouseLeave=function(){},a.prototype.onMouseUp=function(){},a.prototype.onMouseClick=function(){},a.prototype.onLastMouseMove=function(){},a.prototype.onLastMouseDown=function(){},a.prototype.onLastMouseUp=function(){},a.prototype.onLastMouseClick=function(){},a.prototype.oOnMouseDown=function(e,t){e.isDown=!0,e.date=Date.now(),this._propagationEvent[e.index]=e,this.mouseDetectorHandler("Down",e,t),this.trigger("changeCursor",this._propagationEvent[e.index].cursor||"default")},a.prototype.oOnMouseUp=function(
t,n){Date.now()<this._propagationEvent[t.index].date+e.CLICK_DELAY&&this.mouseDetectorHandler("Click",{x:t.x,y:t.y,index:t.index,isDown:t.isDown},n),this.mouseDetectorHandler("Up",t,n),this.trigger("changeCursor",this._propagationEvent[t.index].cursor||"default"),this._propagationEvent[t.index]={}},a.prototype.oOnMouseMove=function(e,t){this._propagationEvent[e.index].index||(this._propagationEvent[e.index]=e),this.lastPointersPos[e.index]=e,this.indexMouseOver[e.index]=!0,this.mouseDetectorHandler("Move",e,t),this.trigger("changeCursor",this._propagationEvent[e.index].cursor||"default")},a.prototype.oOnMouseEnter=function(e,t){e=this.convertMousePos(e,t),this.onMouseEnter(e),this._propagationEvent[e.index]=this._propagationEvent[e.index]||{},this.trigger("changeCursor",this._propagationEvent[e.index].cursor||"default")},a.prototype.oOnMouseLeave=function(e,t){this.indexMouseOver[e.index]=!1,e=this.convertMousePos(e,t),this.onMouseLeave(e),this._propagationEvent[e.index]=this._propagationEvent
[e.index]||{},this.trigger("changeCursor",this._propagationEvent[e.index].cursor||"default")},a.prototype.mouseDetectorHandler=function(e,t,n){if(this.freeze||this.sleep||this._propagationEvent[t.index]["prevent"+e])return;t=this.convertMousePos(t,n),this.trigger("mouse"+e,t,this._propagationEvent[t.index]);if(this["onMouse"+e](t,this._propagationEvent[t.index])||t.stopPropagation)return;if(this.gui&&!this.gui.sleep&&this.gui["oOnMouse"+e](t,this._propagationEvent[t.index])||t.stopPropagation)return;if(this.scene&&!this.scene.sleep){t.scenePosition=this.scenePosition,t.fieldSizes=this.fieldSizes,t.x+=this.scenePosition.x,t.y+=this.scenePosition.y;for(var r in this.scene["onGlobalMouse"+e])if(this.scene["onGlobalMouse"+e][r].enable&&this.scene["onGlobalMouse"+e][r]["onGlobalMouse"+e](t,this._propagationEvent[t.index]))return;for(var r=this._visibleGameObjects.length-1,s;r>=0;--r){s=this._visibleGameObjects[r];if(i(e,s,t,this._propagationEvent[t.index]))return}}if(!t.stopPropagation&&!this
._propagationEvent[t.index]["preventLast"+e]){if(this.scene&&!this.scene.sleep){for(var r in this.scene["onLastGlobalMouse"+e])this.scene["onLastGlobalMouse"+e][r].enable&&this.scene["onLastGlobalMouse"+e][r]["onLastGlobalMouse"+e](t,this._propagationEvent[t.index]);t.x-=this.scenePosition.x,t.y-=this.scenePosition.y}t.scenePosition=undefined,t.fieldSizes=undefined,this.trigger("onLastMouse"+e,t,this._propagationEvent[t.index]),this.gui&&!this.gui.sleep&&this.gui.oOnLastMouse(e,t,this._propagationEvent[t.index]),this["onLastMouse"+e](t,this._propagationEvent[t.index])}},o.addEventCapabilities(a),a.prototype.DEName="Camera",e.debug.log("Camera loaded",3),a}),define("DE.TextRenderer.render",["DE.CONFIG"],function(e){function t(e,t,n){var r=e.globalAlpha;e.globalAlpha=this.alpha*r,e.drawImage(this.buffer.canvas,this.localPosition.x*t*n>>0,this.localPosition.y*t*n>>0,this.sizes.width*this.sizes.scaleX*t*n>>0,this.sizes.height*this.sizes.scaleY*t*n>>0),e.globalAlpha=r}return e.debug.log("TextRenderer.render loaded"
,3),t}),define("DE.TextRenderer",["DE.Renderer","DE.TextRenderer.render","DE.CONFIG","DE.Sizes","DE.CanvasBuffer","DE.ImageManager"],function(e,t,n,r,i,s){function o(t,n,o,u){e.call(this,t);if(!t||!n||!o||u==undefined)throw new Error("TextRenderer :: Can't instantiate without params, width, height, text");this.text=u,this.textAlign=t.textAlign||"center",this.textBaseline=t.textBaseline||"middle",this.fontSize=t.fontSize||20,this.fontStyle=t.fontStyle||"",this.font=t.font||"Calibri",this.sizes=new r(n,o,1,1,this),this.preventCenter=t.preventCenter||!1,this.preventCenter||this.sizes._center(),this.paddingX=t.padding||t.paddingX||0,this.paddingY=t.padding||t.paddingY||0,this.backgroundColor=t.backgroundColor,this.borderColor=t.borderColor,this.borderSize=t.borderSize||1,this.backgroundImage=t.backgroundImage,this.backgroundImage&&!s.images[this.backgroundImage]&&(console.log("TextRenderer :: %cCant find given backgroundImage - "+this.backgroundImage+" check your imagesDatas - ignore background"
,"color: red"),this.backgroundImage=undefined);if(this.backgroundImage||this.backgroundColor||this.borderColor)this.background=!0;this.init=function(){this.buffer=new i(this.sizes.width,this.sizes.height),this.clearBuffer()},this.clearBuffer=function(){this.buffer.ctx.clearRect(0,0,this.sizes.width,this.sizes.height),this.buffer.ctx.font=this.fontStyle+" "+this.fontSize+"pt "+this.font,this.buffer.ctx.textAlign=this.textAlign,this.buffer.ctx.textBaseline=this.textBaseline,this.background&&(this.backgroundImage?this.buffer.ctx.drawImage(s.images[this.backgroundImage],0,0,this.sizes.width,this.sizes.height):this.backgroundColor&&(this.buffer.ctx.fillStyle=this.backgroundColor,this.buffer.ctx.fillRect(0,0,this.sizes.width,this.sizes.height)),this.borderColor&&(this.buffer.ctx.lineWidth=this.borderSize,this.buffer.ctx.strokeStyle=this.borderColor,this.buffer.ctx.strokeRect(0,0,this.sizes.width,this.sizes.height),this.buffer.ctx.lineWidth=1));var e=this.textAlign=="right"?this.sizes.width-this
.paddingX:this.textAlign=="left"?this.paddingX:this.sizes.width*.5+this.paddingX>>0,t=this.textBaseline=="bottom"?this.sizes.height-this.paddingY:this.textBaseline=="top"?this.paddingY:this.sizes.height*.5+this.paddingY>>0;if(this.method=="fill"||this.method=="fillAndStroke")this.buffer.ctx.fillStyle=this.fillColor,this.forceWidth?this.buffer.ctx.fillText(this.text,e,t,this.sizes.width):this.buffer.ctx.fillText(this.text,e,t);if(this.method=="stroke"||this.method=="fillAndStroke")this.buffer.ctx.lineWidth=this.lineWidth,this.fillColor&&(this.buffer.ctx.globalAlpha=.8),this.buffer.ctx.strokeStyle=this.strokeColor,this.forceWidth?this.buffer.ctx.strokeText(this.text,e,t,this.sizes.width):this.buffer.ctx.strokeText(this.text,e,t)},this.setText=function(e){this.text=e,this.clearBuffer(),this.onSetText(e)},this.onSetText=function(e){},this.setSizes=function(e,t){this.sizes.setSizes(e,t)},this.init(t)}return o.prototype=new e,o.prototype.constructor=o,o.prototype.supr=e.prototype,o.prototype.
DEName="TextRenderer",o.prototype.render=t,n.debug.log("TextRenderer loaded",3),o}),define("DE.TileRenderer.render",["DE.ImageManager","DE.CONFIG","DE.Time"],function(e,t,n){function r(t,n,r){var i=t.globalAlpha;t.globalAlpha=this.alpha*i,e.imageNotRatio?t.drawImage(e.images[this.imageName],this.tileposition.x*n>>0,this.tileposition.y*n>>0,this.tilesizes.width*n+1>>0,this.tilesizes.height*n+1>>0,this.localPosition.x*n*r>>0,this.localPosition.y*n*r>>0,this.sizes.width*this.sizes.scaleX*n*r+2>>0,this.sizes.height*this.sizes.scaleY*n*r+1>>0):t.drawImage(e.images[this.imageName],this.tileposition.x,this.tileposition.y,this.tilesizes.width,this.tilesizes.height,this.localPosition.x*r>>0,this.localPosition.y*r>>0,this.sizes.width*this.sizes.scaleX*r>>0,this.sizes.height*this.sizes.scaleY*r>>0),t.globalAlpha=i}return t.debug.log("TileRenderer.render loaded",3),r}),define("DE.TileRenderer",["DE.Renderer","DE.ImageManager","DE.Vector2","DE.Sizes","DE.TileRenderer.render","DE.CONFIG"],function(e,
t,n,r,i,s){function o(i){if(!i)throw new Error("TileRenderer :: You have to pass arguments object to instantiate -- see the doc");e.call(this,i),this.imageName=i.imageName||undefined;if(!this.imageName)throw new Error("TileRenderer :: No imageName defined -- declaration canceled");if(!t.images[this.imageName])throw new Error("TileRenderer :: Can't find image "+this.imageName+" in imagesDatas");i.tilesizes=i.tilesizes||i.tileSizes||{},this.tilesizes=new r(i.tilesizes.width||i.tilesizes.w||i.width||10,i.tilesizes.height||i.tilesizes.h||i.height||10,1,1),i.tileposition=i.tileposition||i.tilePosition||{},this.tileposition=new n(i.tileposition.x||i.x||0,i.tileposition.y||i.y||0),this.tileposition||console.error("Tile position must be defined"),i.scaleX=i.scale||i.scaleX||i.scalex||1,i.scaleY=i.scale||i.scaleY||i.scaley||1,i.sizes=i.sizes||{},this.sizes=new r(i.sizes.width||i.width||i.w||i.tilesizes.width||10,i.sizes.height||i.height||i.h||i.tilesizes.height||10,i.scaleX,i.scaleY,this),this.preventCenter=
i.preventCenter||!1,this.preventCenter||this.sizes._center()}return o.prototype=new e,o.prototype.constructor=o,o.prototype.supr=e.prototype,o.prototype.DEName="TileRenderer",o.prototype.render=i,s.debug.log("TileRenderer loaded",3),o}),define("DE.Gui",["DE.CONFIG","DE.COLORS","DE.Time","DE.Event","DE.GameObject","DE.CanvasBuffer","DE.Mid.gameObjectMouseEvent"],function(e,t,n,r,i,s,o){function u(t){t=t||{},this.id=t.id||undefined,this.alpha=t.alpha||1,this.gameObjects=t.gameObjects||[],this.timers=new Array,this.sleep=!1,this.onGlobalMouseDown={},this.onLastGlobalMouseDown={},this.onGlobalMouseMove={},this.onLastGlobalMouseMove={},this.onGlobalMouseUp={},this.onLastGlobalMouseUp={},this.onGlobalMouseClick={},this.onLastGlobalMouseClick={},this.render=function(e,t,n,r){if(this.sleep)return;var i=e.globalAlpha;e.globalAlpha=i*this.alpha;for(var s=0;s<this.gameObjects.length;++s)this.gameObjects[s].render(e,n,{x:0,y:0,z:-10},r);e.globalAlpha=i},this.update=function(){if(this.sleep)return;for(
var e=0,t=this.gameObjects.length,r;e<t;++e){r=this.gameObjects[e];if(!r)continue;if(r.flag!==null)switch(r.flag){case"delete":this.delete(e),--t;continue}r.update(n.currentTime)}for(var e=0,t=this.timers.length;e<t;++tk)this.timers[e].update();this.waitSortGameObjects&&this.sortGameObjects()},this.add=function(e){var t=Array.prototype.slice.call(arguments);for(var n=0;n<t.length;++n)if(t[n].length)for(var r=0,i=t[n].length||1;r<i;++r)this.addOne(t[n][r]);else this.addOne(t[n])},this.addOne=function(t){if(!(t instanceof i)){e.debug.log("%cIt's not or not herits from a GameObjects",1,"color:red");return}t.scene=this,this.gameObjects.push(t),++this.maxObjects,this.waitSortGameObjects=!0},this.sortGameObjects=function(){this.gameObjects.sort(function(e,t){return t.zindex==e.zindex?t.position.x-e.position.x:e.zindex-t.zindex});for(var e=0,t;t=this.gameObjects[e];++e)t.sortChildrens();this.waitSortGameObjects=!1},this.onMouseMove=function(e){for(var t in this.components){if(!this.components[
t].enable)continue;var n=this.components[t];if(n.checkState&&n.checkState(e))return n.onMouseMove(e),!0}return!1},r.addEventComponents(this)}return u.prototype=u.prototype||{},r.addEventCapabilities(u),u.prototype.onMouseDown=function(){},u.prototype.onMouseMove=function(){},u.prototype.onMouseUp=function(){},u.prototype.onMouseClick=function(){},u.prototype.onLastMouseMove=function(){},u.prototype.onLastMouseDown=function(){},u.prototype.onLastMouseUp=function(){},u.prototype.onLastMouseClick=function(){},u.prototype.oOnMouseDown=function(e,t){return this.mainMouseHandler("Down",e,t)},u.prototype.oOnMouseMove=function(e,t){return this.mainMouseHandler("Move",e,t)},u.prototype.oOnMouseClick=function(e,t){return this.mainMouseHandler("Click",e,t)},u.prototype.oOnMouseUp=function(e,t){return this.mainMouseHandler("Up",e,t)},u.prototype.oOnLastMouse=function(e,t,n){this["onLastMouse"+e](t,n);for(var r in this["onLastGlobalMouse"+e])this["onLastGlobalMouse"+e][r].enable&&this["onLastGlobalMouse"+
e][r]["onLastGlobalMouse"+e](t,n)},u.prototype.mainMouseHandler=function(e,t,n){if(this["onMouse"+e](t,n))return!0;for(var r in this["onGlobalMouse"+e])if(this["onGlobalMouse"+e][r].enable&&this["onGlobalMouse"+e][r]["onGlobalMouse"+e](t,n))return!0;if(!t.stopPropagation)for(var r=0,i;i=this.gameObjects[r];++r)if(o(e,i,t,n))return!0},u.prototype.cleanObjectBinding=function(e){delete this.onGlobalMouseDown[e.id],delete this.onLastGlobalMouseDown[e.id],delete this.onGlobalMouseMove[e.id],delete this.onLastGlobalMouseMove[e.id],delete this.onGlobalMouseUp[e.id],delete this.onLastGlobalMouseUp[e.id]},u.prototype.remove=function(t){this.cleanObjectBinding(t);if(this.gameObjects[t])this.gameObjects.splice(t,1);else{var n=this.gameObjects.indexOf(t);if(n==-1){e.debug.log("%cRemove gameObject not found",1,"color:orange",t);return}this.gameObjects.splice(n,1)}this.maxObjects--},u.prototype.delete=function(e){this.gameObjects[e]?this.gameObjects[e].killMePlease():e.killMePlease(),this.remove(e)},
u.prototype.deleteAll=function(){var e=this.gameObjects;while(e.length>0)this.delete(0);this.maxObjects=0},u.prototype.DEName="Gui",e.debug.log("Gui loaded",3),u}),define("DE.AchievementSystem",["stash","DE.CONFIG","DE.about","DE.Event","DE.AudioManager","DE.Notifications","DE.LangSystem","DE.SaveSystem"],function(e,t,n,r,i,s,o,u){var a={en:"<div class='ingame-achievement'><img src='%path%' alt='%name%' />%name% unlocked</div>",fr:"<div class='ingame-achievement'><img src='%path%' alt='%name%' />%name% d\u00e9bloqu\u00e9</div>",es:"<div class='ingame-achievement'><img src='%path%' alt='%name%' />%name% desbloqueado</div>",pt:"<div class='ingame-achievement'><img src='%path%' alt='%name%' />%name% desbloqueado</div>",de:"<div class='ingame-achievement'><img src='%path%' alt='%name%' />%name% entriegelt</div>",it:"<div class='ingame-achievement'><img src='%path%' alt='%name%' />%name% sbloccato</div>",ru:"<div class='ingame-achievement'><img src='%path%' alt='%name%' />%name% \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d</div>"
},f=new function(){this.DEName="AchievementSystem",this.achievements=[],this.userAchievements={},this.achievementsUrl="img/achievements/",this.init=function(e,t){for(var n in a){if(!o.dictionary[n])continue;o.dictionary[n]["achievement-unlock"]=a[n]}this.achievements=[];for(var n=0,r;r=e[n];++n)this.achievements.push(r);this.userAchievements=t||u.loadAchievements()},this.checkEvent=function(e,t){for(var n=0,r,i;r=this.achievements[n];++n){i=this.userAchievements[r.namespace];for(var s in r.objectives){if(s!=e||i&&(i.complete||i.objectives[s]&&i.objectives[s].complete))continue;this.updateValue(r,s,t)}}u.saveAchievements(this.userAchievements)},this.isUnlock=function(e){for(var t=0,n,r;n=this.achievements[t];++t)if(n.namespace==e)return this.userAchievements[e]?this.userAchievements[e].complete:!1},this.updateValue=function(e,t,n){var r=e.objectives[t];if(!this.userAchievements[e.namespace]||!this.userAchievements[e.namespace].objectives)this.userAchievements[e.namespace]={objectives:{}}
;var i=this.userAchievements[e.namespace];switch(r.type){case"increment":i.objectives[t]||(i.objectives[t]={value:0}),i.objectives[t].value+=n||1;break;default:i.objectives[t]={value:n}}this.checkUnlock(e)},this.checkUnlock=function(e){var t=this.userAchievements[e.namespace].objectives,n=e.objectives,r=!0,i,s;for(var o in n){if(!t[o]){r=!1;continue}if(t[o].complete)continue;i=n[o],s=!0;switch(i.type){case"equal":i.target!=t[o].value&&(s=!1);break;case"increment":case">=":i.target>t[o].value&&(s=!1)}s?t[o].complete=!0:r=!1}r&&this.unlocked(e)},this.unlocked=function(e){this.userAchievements[e.namespace].complete=!0;var n=e.names[o.currentLang]||e.names.en||"null",r=this.achievementsUrl+e.namespace+".png",u=(o.get("achievement-unlock")||"Set achievement unlock text please").replace(/%name%/gi,n).replace(/%path%/gi,r);s.create(u,t.notifications.achievementUnlockDuration),i.fx.play("achievement-unlocked")},r.on("games-datas",this.checkEvent,this)};return f}),define("NebulaOffline",["DE.about"
,"DE.Event","DE.SaveSystem","DE.LangSystem","DE.Notifications","DE.AchievementSystem"],function(about,Event,SaveSystem,LangSystem,Notifications,AchievementSystem){var _offLineTemplate="<div class='centeredModal'><div class='close'>X</div><h3 class='title'></h3><p class='about'></p><div class='btns'><button class='yesLoad'></button><button class='noLoad'></button></div></div>",_offLineVignet="<div class='vignet'><img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAALgElEQVRYR31XCZAcZRV+/9XdM9MzszN7JrvZ3RCOJQllgBBC8OAMVaBAeUREjVSBhNISlBIRscpoqSUeQFlaBZHDCAkaELmCiaBBOeVKDJANOZbd7JG9Z3fu7v4P3z+bbBIq2lW9WzPTf//f/73vvfc9Ase5Nm0CtgiAATQ6xYrjCkldEmcOIdQhEDlUc0ooEGI0DTUxjtBhqGh5PD+dy2VyxVWrQB3vvcf7jhz95dq1QD+3EHghzHpJJxU3IH1CWVIa7VPDPSC4aaAbeKS7tAHiGnpDlcC9CMYUHfKyQ4mmBKpAohyR4Wj/+OjUpTdC8P/AHAZA8NT0hNhcl1Z0wgBPuwBZAzQNofbFEHmcIB9A8cYVtUX2j70ZosLfaje1tFAoG/PbwDNPcwpTwMxoCfqGV6yCyv9kYNta4E0LG72ootMskao3SjXxABaLAtylQwMgAYz+0PJZ6DM4DD5GBGJ0EZD9zxj0F6IfJuvoS8w1w9G06lm6Zqj8YRC112x7sNNrSkCd0aQZiGmJl8gWoxXoEF+MAGqb4wb2MsZU+/Py1X/0yGddbqHNXOed7FzWmmYXGgnErqOxGTCUc+jOR1c2zzE9hV0D3eevPbLmMJHw0v0NyfqsX68q+rR4wJ6yZzJag5EagsDk3uoNH9szFnUnfVppzIhifZaVUyka+i5RlJIatGpg2GReOQfHlH9BO1+vgplIsfgMiB1j4Wc65sPOM1cN7DuahdpDFkDcE9moSBfv2BN15YvGCZXOx+M8qEvTckOGVTIZFvhxojg+b4/tHFRXG20IYaRQaWRPI+OGow4k6j9fMLwp1OtoBHMtezUQgsN7U9XLT1oQvtB1xXjhMIgagFc2tcUcqRMQsnQ5MgnNiRtzKRecOI4BzyakvUSvegqFiKk4owmDm82ID7/gxuwN1Jda290JCyQIgSSn1aMmAJ/gAhoj8Nyu4PuLu/gzH7th8D/HAHj21+A2uRkP4qm4K3TcSBE3XCeQ3iShhrJedQ8T0Ek4gfteKt2aiEO5qZGO1adoSWvq4okTZzexH3uCzgNBCoMMrs6k8fx4+RPqWVkCSj1kAkFs2xt88bo7RjYeA8CKMOmGvjE8xQVN4QHSmFEeG1TXUA1X1ZSN3N//QvmW+e30g1O7vN46j5Q1xZIEiiERsUqVpHv7ZcPpSfonyeDggIYb5jaxoMbElPqrxmpgQ/HuqHzAiUe3X/adseFZEb72cDbFiN/gCtKMeZx08uqLUDCrAWmmHsbPpXDf34u3LD7F2bvwVKePSagqRyqrU8EQIl4kIq40kJkqmGxbCE8PluQm3iTW1yWJqo7LLr9A7qaOBQH65f7wytU/Gnl6FkD3+tb60KVz/DJ7AwF4WAdA5nUtn1mcwe+eL3zv1C63Z8kpTh81SmrBGFOaa0I0aiHAilnUwgloFLqGsEY5oRdlgN77j/5o9Yol7qgVbXxEbTGYnpaFx98J1nSeP3K/Ldk1Ee7c0J7hzLRWItaWNeKvWkqQkxJYkoCkbOrJtwu3XXxefJ9rN6REsB75MHaGBmLzXIDs0/qixhQZQFWGSvCUQ/gcMSSf27yrcvvyZfEdPrLgjqrHVAl8y8Ifd5RvXX5G/OGV3+gfmk1DP+HOYdTp8Kv8bxZAhABEGgv930vfPXdpbO+CTl5iE+YSocy3pkrq/bgmHSJFPYbhGZjSmyss+kFLPR3BvHQohzl8TP88UNDeE8A3TzqBF+m0vpCXzC2YFdCXl1srPrnpiluH3j9UCcHLitYGcOn8RNm5i0TyzGhSA68j8MhrlRsvvSix13XAuGN6y0OvlW9uzPKpS+aLB2z55ahsZKnwwr7SZ5cvFru441KsnS2qoLriVVj/4mD05WVnuGO2PiQmNIbBYJ3QB94Noguu+fHo/hkA2AuyJzRnqXDatWYnJkr6ETmNLQlDsGVPcO1Hz44NuiPyOibop57dHXz9vBWxAT+nt8i8qaWW5Ka4+f3qqouXOu+omMNYaFpwy58yQi/451C0+uwzPGTGEA8PYHsLgjD/mqie9dWfjb9VA2Db8IUntafriJ6nGJ9jX64KBkpUfdBdgu99ZKGT473ysb/srv7otEXe/s55vORMqI2mCFmbKVv2VO4MPPLEyo+5PUwTTzM+1+uXj+dCPdCdl79YuiQ+ZuuJBaAqCABVuXU4OPemO0dfme1pb96bSbmN3lyi3XZ3FJGWDBSp7tlXhdsWnSKmUVSPPfFude3ys7zuujpRiMqav/5OpXVoWKFfUMMfP9vZ2ZoVAXBaR4hocQei5zbsrHz7zCXu7vntbkCNZva9qohGAmvKlt7SuTf9evIIAKwFyZjjWSF2Hn6wxBFABW5beLIzBXl1SnlYfXk8Zn7S0eYexCStMKz849PEpHxS4RAq5ZIYU7yB5/RyOg2/2rCr/LVPXpR6L+aA5xXNzaakL7EaKCnd/8/Byue/dffkq7MMWAAJ7rYSfoQBliLw7xH5hSVdsVFNNHcG5dYXR+TqZae7BzQ1eVuQpLJ1AYwH1FFA0raQiQ/k1ke6y984qVPsX7I4kcf09GPTZouc1rUWXayqvtf7g3PW3D1+sAbAesCuqD0FQrdRyudatesyihABbO4Orj3/nFgPKt5MTUaNzQX6aLdUV3V0uJPCpWWFhalWHQhx0SwknAP6maf2VW5AbzaxcoXXJ2LUFxGdx6bVeoVhZQnsJ9uKN0+mJn+zbh1EMwDWgrNoYWNWKrdDMN7pTOo/aqxvPMnh4ReLN638hLc75rE8MCWiXn2tb+hXrEGR1LwZxMlGP4CrUIzLrAPYtLtyvcPN2MdX+AfigjiMQzo2dej0uPme0XDze0Pynu/cM/7MbCl+b1OjXwW3RRjaGa+K30MQtWpUqwWApTXaMVq5+uQT+BA2Kywj0tm9P2xpiuBLLQl2JWYXHZpWz7/YX91sGJmY3yEOLDoxlnOIdNAvZrwC+RrG/krrJ1mMYWEo3LhkEf/Tp28ZGT2mF0hBWkGIFr/Ct6LJBpmbKUTUceCN/eVfzFsgtsVidALDHUbUEFlWznDOxIt5LTCysj5DSnOanJrnIzRyQZMMflpKCuan1jtwn8G65wu3LmhnL11/x+grx7TjNzfObWDcaasLnO2WWgwrqJIErZAFXEjQ7uw4ENzWMZ/vEK6Zxm8qGONZm4peEnkwREvN0T3EOdUJltPn0IL5gQ0L9wm88UH0h57J6NGVp49vXboGal5hloHtD3bW0UTYfHCYnLggFXsIx46M7Qe6Yo3pjHCspSoG+oUpbn5Zh/aMaRMoo2umlBpD0Ys6jFJBSrJeTMJGW2xq3RTXFiPa9+c3CmvbnIkNa1B4hzefBfDKnW0x2hKmktyrnyzC3JHBaP6ZHf4625Z1iGzY4oFdzHoD6/3x00jZyN8Jhr2emu1eSJaQor4aQnLyjEc/ZNGx9ZYU6Xv89fwdp3ayJ7/ww/GhozefBWDTsG2gzWH1Jk45S7sCMuM50pJW9PpMnF5uHbIOLCO4BImvDSmHNqpZdusPj5ob7O/WA24fDDbuPBj+a/GJzstX3T7y7oc3nwVwOBzYlBg0NnqJRvBdbMYR8Mb+Xt18WpP3IJ47WQMSKTARFgVL5HEmQGtUFTPTG3ZUfxJPkANnLdb/STZP9B01GR2CfpQGjkZmG9OyLIhYsi6WTSV8iGhduWIaevp1y4I655qGFLuQahQbDi725ChUOTyt397eF24bK6ph16NVnB9GmpvowJxmOsxMOPXRa4/Y8CPc/Q8Ah9mws2Ib2v80tMW0wnlROAlMPX8wp9OFnEnmS8qt2XVtIj/Gin6K4E2L6K3L6J7L6NcqRaGrf9s1EOChPjzYzZ75mOn4ODEitbB0dPJkOO3SDNoSJYSsKJbwPaJV1Sg0pQK4Gs2FMpnxIlEtycGpERmbBIVjmA3SoaHueAoA+C9UYKxssItuVAAAAABJRU5ErkJggg==' /></div>"
,_langs={en:{"nebula-bad-namespace":"No namespace given for the game, disable Nebula or set a valid namespace in about","nebula-title":"Connect to Nebula system","nebula-description":"Login to synchronize and save your progressions on Dreamirl's servers, you'll synchronize the same progression on your mobile, computer, laptop, whatever!<br />Not registered yet ? You can do by clicking Login.","nebula-login":"Login","nebula-nop":"No thank you","nebula-firewall":"Cannot load, seems you firewall block connexion, or the server is down"},fr:{"nebula-bad-namespace":"Aucun namespace valide n'a \u00e9t\u00e9 trouv\u00e9, d\u00e9sactivation du module Nebula (vous pouvez aussi le d\u00e9sactiver automatiquement)","nebula-title":"Connexion au syst\u00e8me Nebula","nebula-description":"Connectez vous pour synchroniser et sauvegarder votre progression sur les serveur Dreamirl, vous pourrez ainsi conserver le m\u00eame avancement sur votre mobile, votre pc ou votre pc portable !<br />Vous n'\u00eates pas encore inscrit ? Vous pouvez le faire en cliquant Se connecter!"
,"nebula-login":"Se connecter","nebula-nop":"Non merci","nebula-firewall":"Chargement impossible, il semble que votre pare-feu bloque la connexion, ou le serveur est down"}},NebulaOffline=new function(){var _self=this;this.el=null,this.container=null,this.isNebula=!0,this.init=function(e){_langs[LangSystem.currentLang]||(_langs[LangSystem.currentLang]={});if(!about.namespace){alert(_langs[LangSystem.currentLang]["nebula-bad-namespace"]||_langs.en["nebula-bad-namespace"]);return}var t=document.getElementById(e||"Dreamirl-Nebula");t||(t=document.body);var n=document.createElement("div");n.id="NebulaClient",n.innerHTML=_offLineTemplate,this.elParent=t,t.appendChild(n),n.getElementsByClassName("title")[0].innerHTML=_langs[LangSystem.currentLang]["nebula-title"]||_langs.en["nebula-title"],n.getElementsByClassName("about")[0].innerHTML=_langs[LangSystem.currentLang]["nebula-description"]||_langs.en["nebula-description"];var r=n.getElementsByClassName("yesLoad")[0];r.innerHTML=_langs[LangSystem
.currentLang]["nebula-login"]||_langs.en["nebula-login"],r.addEventListener("click",function(e){_self.loadClient()},!0);var i=n.getElementsByClassName("noLoad")[0];i.innerHTML=_langs[LangSystem.currentLang]["nebula-nop"]||_langs.en["nebula-nop"],i.addEventListener("click",function(e){_self.hide()},!0),n.getElementsByClassName("close")[0].addEventListener("click",function(){_self.hide()},!0),this.container=n;var s=document.createElement("div");s.id="NebulaVignet",s.innerHTML=_offLineVignet,t.appendChild(s),this.vignet=s,s.addEventListener("click",function(){_self.show()},!0),Event.trigger("nebula-show"),Event.on("force-nebula-load",this.loadClient,this),Event.on("close-nebula",this.hide,this),Event.on("show-nebula",this.show,this),Event.on("toggle-nebula",function(){this.visible?this.hide():this.show()},this),this.show()},this.hide=function(){this.visible=!1,Event.trigger("nebula-hide"),_self.container.className+=_self.container.className+=" fading",setTimeout(function(){_self.container.
className+=" hided"},200)},this.show=function(){this.visible=!0,Event.trigger("nebula-show"),_self.container.className=_self.container.className.replace(/hided/gi,"").replace(/  /gi,""),setTimeout(function(){_self.container.className=_self.container.className.replace(/fading/gi,"")},50),setTimeout(function(){_self.container.className=_self.container.className.replace(/hided/gi,"")},250)},this.loadClient=function(){if(window.Nebula){window.Nebula.init(about,Event,SaveSystem,Notifications,AchievementSystem);return}var e=document.createElement("script");e.type="text/javascript",e.src="http://dreamirl.com/Nebula.js?r="+Date.now(),e.pointer=this,document.body.appendChild(e),e.onload=this.onLoadClient,e.onerror=function(){alert(_langs[LangSystem.currentLang]["nebula-firewall"]||_langs.en["nebula-firewall"]),_self.hide()}},this.onLoadClient=function(e){console.log("%cGet Nebula !","color:green"),window.NebulaReady=function(){window.Nebula.init(about,Event,SaveSystem,Notifications,AchievementSystem
)},e&&eval('require( [ "Nebula" ] )')}};return NebulaOffline}),define("DREAM_ENGINE",["DE.CONFIG","DE.COLORS","DE.Time","DE.Vector2","DE.Sizes","DE.ImageManager","DE.CollisionSystem","DE.Collider","DE.Renderer","DE.Scene","DE.Rigidbody","DE.CanvasBuffer","DE.GameObject","DE.FixedBoxCollider","DE.OrientedBoxCollider","DE.CircleCollider","DE.BoxRenderer","DE.CircleRenderer","DE.SpriteRenderer","DE.Render","DE.MainLoop","DE.Event","DE.States","DE.Inputs","DE.Camera","DE.TextRenderer","DE.TileRenderer","DE.AudioManager","DE.Gui","DE.LangSystem","DE.SystemDetection","DE.GamePad","DE.Screen","DE.about","DE.SaveSystem","DE.Notifications","NebulaOffline","DE.AchievementSystem"],function(){var e={},t=null,n=Date.now();for(var r in arguments){if(arguments[r].isNebula){t=arguments[r];continue}var i=arguments[r],s=i.DEName;!s&&i.prototype&&(s=i.prototype.DEName);if(!s){console.log("%cNo name for "+r,"color:red",arguments[r]);continue}e[s]=arguments[r],delete e[s].DEName}return e.init=function(r){r=
r||{},r.loader=r.loader||{},r.loader.name=r.loader.name||"loader",r.loader.url=r.loader.url||"loader",r.loader.totalFrame=r.loader.totalFrame||16,r.loader.eachAnim=r.loader.eachAnim||45,r.loader.ext=r.loader.ext||"png",r.loader.isAnimated=!0,r.loader.scale=r.loader.scale||1,window.ENGINE_SETTING=window.ENGINE_SETTING||{},e.about.set(r.about),e.SaveSystem.init(r.saveModel,r.saveIgnoreVersion),e.LangSystem.init(r.dictionary||{}),e.SystemDetection.initSystem(r.system,r.paramsSystem||{}),e.AchievementSystem.init(r.achievements||[]),e.on("updateScreenSizes",function(e,t){this.ImageManager.pathPrefix=t.path,this.ImageManager.imageNotRatio=t.notRatio||!1,this.ImageManager.ratioToConception=e,this.ImageManager.folderName=r.images.folderName,this.ImageManager.pushImage(r.loader.name,r.loader.url,r.loader.ext,r.loader)},e,!1),r.ignoreNotification||e.Notifications.init(r),e.GamePad.init(),e.pause=function(){this.on("isReady",function(){this.MainLoop.launched=!0,this.MainLoop.loop(),this.paused&&(this
.MainLoop.launched=!1,this.Inputs.keyLocked=!0)},this),this.MainLoop.launched=!1,this.Inputs.keyLocked=!0,this.paused=!0},e.unPause=function(){this.Inputs.keyLocked=!1,this.paused=!1,this.Time.lastCalcul=Date.now(),this.MainLoop.launched=!0,this.MainLoop.loop()},e.on("notisLoadingImages",function(){r.ignoreNebula||(this.on("nebula-hide",this.unPause,this),this.on("nebula-show",this.pause,this),t.init(r.nebulaElementId)),e.MainLoop.loader=new e.GameObject({renderers:[new e.SpriteRenderer({spriteName:"loader",scale:r.loader.scale}),new e.TextRenderer({fillColor:r.loader.fillColor||"#FFFFFF",strokeColor:r.loader.strokeColor||"#FBC989",fontSize:r.loader.fontSize||32,lineWidth:r.loader.lineWidth||2,offsetY:220+(r.loader.offsetY||0),offsetX:0+(r.loader.offsetX||0),font:r.loader.font||"Helvetica"},400,100,"100%")]}),e.on("updateScreenSizes",function(e,t){this.ImageManager.pathPrefix=t.path,this.ImageManager.imageNotRatio=t.notRatio||!1,this.ImageManager.ratioToConception=e,this.ImageManager.arrayLoader
(r.images.imagesList),this.MainLoop.screenChangedSizeIndex(e,t)},e),r.onReady?r.onReady():console.log("%cNo initialisation function given","color:red"),r.onStart?e.Event.on("isReady",function(){var t=Date.now()-n;t>=5e3?(r.onStart(),e.SystemDetection.askToRate()):(e.CONFIG.debug.log("start in ",1e3-t,"ms"),setTimeout(function(){r.onStart(),e.SystemDetection.askToRate()},1e3-t))},e,!1):console.log("%cNo start function given","color:red"),e.ImageManager.arrayLoader(r.images.imagesList),e.AudioManager.loadAudios(r.audios),e.Inputs.init(r.inputs),r.customLoop&&(e.MainLoop.customLoop=r.customLoop)},e,!1),e.Screen.init(r.images),e.Screen.updateScreenSizes(ENGINE_SETTING.quality)},e.start=function(){e.States.up("isInited"),this.MainLoop.launched=!0,this.MainLoop.loop()},e.on=function(){this.Event.on.apply(this.Event,arguments)},e.trigger=function(){this.Event.trigger.apply(this.Event,arguments)},e.deltaTime=e.Time.getDelta(),window.requestAnimationFrame||(window.requestAnimationFrame=function(
){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}()),e}),require(["DREAM_ENGINE","main"],function(e,t){return t(e),e}),define("shared",[],function(){var e={levels:{flat:{components:[{x:2048,y:0,z:4,name:"mountain1",zindex:0,rotation:0},{x:3808,y:64,z:3,name:"mountain1",zindex:0,rotation:0},{x:3136,y:128,z:3,name:"mountain2",zindex:0,rotation:0},{x:2432,y:-20,z:3,name:"trolls",zindex:0,rotation:0},{x:992,y:32,z:3,name:"mountain1",zindex:0,rotation:0},{x:32,y:0,z:3,name:"mountain2",zindex:0,rotation:0},{x:4192,y:64,z:2,name:"mountain2",zindex:0,rotation:0},{x:3552,y:128,z:2,name:"mountain1",zindex:0,rotation:0},{x:2688,y:160,z:2,name:"mountain1",zindex:0,rotation:0},{x:1792,y:96,z:2,name:"mountain2",zindex:0,rotation:0},{x:1184,y:128,z:2,name:"mountain1",zindex:0,rotation:0},{x:640,y:96,z:2,name:"mountain2",zindex:0,rotation:0},{x:-384,y:96,z:2,name:"mountain2"
,zindex:0,rotation:0},{x:288,y:128,z:1,name:"mountain1",zindex:0,rotation:0},{x:4960,y:480,z:0,name:"earth",zindex:0,rotation:0},{x:4576,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:4160,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:3744,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:3328,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:2912,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:2496,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:2080,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:1664,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:1248,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:832,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:416,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:0,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:-416,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:-832,y:416,z:0,name:"floor_large",zindex:0,rotation:0},{x:4576,y:0,z:0,name:"floor_large",zindex:1,rotation:0},{x:-832,y
:-32,z:0,name:"floor_large",zindex:1,rotation:0},{x:-1216,y:448,z:0,name:"earth",zindex:1,rotation:0},{x:4960,y:128,z:0,name:"earth",zindex:2,rotation:0},{x:4544,y:-448,z:0,name:"floor_large",zindex:2,rotation:0},{x:-800,y:-480,z:0,name:"floor_large",zindex:2,rotation:0},{x:-1184,y:96,z:0,name:"earth",zindex:2,rotation:0},{x:4960,y:-224,z:0,name:"earth",zindex:3,rotation:0},{x:4512,y:-896,z:0,name:"floor_large",zindex:3,rotation:0},{x:-768,y:-928,z:0,name:"floor_large",zindex:3,rotation:0},{x:-1184,y:-224,z:0,name:"earth",zindex:3,rotation:0},{x:4928,y:-576,z:0,name:"earth",zindex:4,rotation:0},{x:-1184,y:-576,z:0,name:"earth",zindex:4,rotation:0},{x:4822.857142857139,y:-884.2857142857144,z:0,name:"earth",zindex:5,rotation:0},{x:-1152,y:-896,z:0,name:"earth",zindex:5,rotation:0},{x:-256,y:160,z:0,name:"goal",zindex:20,rotation:0}],startX:4100,startY:100,objects:[{q:4,id:"floor_large",f:0},{q:2,id:"lava",f:1},{q:4,id:"bounce",f:2},{q:3,id:"slow",f:3},{q:4,id:"spikes",f:4},{q:6,id:"ice",f
:5},{q:5,id:"saw",f:6},{q:1,id:"fuck",f:7}],limits:{minX:-600,maxX:4350,minY:-900,maxY:400},buildLimits:{minX:-300,maxX:4100,minY:-300,maxY:100}}},components:{floor_large:{name:"floor_large",tag:"block",sprite:"env",isTile:1,sx:1314,sy:102,tw:512,th:512,w:512,h:512,collider:{type:"box",w:512,h:452,l:0,t:30},zindex:0},earth:{name:"earth",tag:"env",sprite:"env",isTile:1,sx:1314,sy:222,tw:512,th:392,w:512,h:392,collider:!1,zindex:0},wall:{name:"wall",tag:"block",sprite:"env",isTile:1,sx:0,sy:0,tw:128,th:512,w:128,h:512,collider:{type:"box",w:128,h:512,l:0,t:0},zindex:0},platform:{name:"platform",tag:"block",sprite:"env",isTile:1,sx:0,sy:0,tw:512,th:128,w:512,h:128,collider:{type:"box",w:512,h:128,l:0,t:0},zindex:0},lava:{name:"lava",tag:"lava-block",sprite:"env",isTile:1,sx:32,sy:50,tw:512,th:214,w:512,h:214,collider:{type:"box",w:484,h:108,l:-6,t:18},zindex:5},bounce:{name:"bounce",tag:"bounce-block",sprite:"env",isTile:1,sx:32,sy:308,tw:512,th:214,w:512,h:214,collider:{type:"box",w:484,h
:108,l:-6,t:18},zindex:5},slow:{name:"slow",tag:"slow-block",sprite:"env",isTile:1,sx:32,sy:614,tw:512,th:214,w:512,h:214,collider:{type:"box",w:484,h:108,l:-6,t:18},zindex:5},spikes:{name:"spikes",tag:"spike-block",sprite:"env",isTile:1,sx:612,sy:50,tw:512,th:214,w:512,h:214,collider:{type:"box",w:484,h:108,l:-6,t:18},zindex:5},ice:{name:"ice",tag:"ice-block",sprite:"env",isTile:1,sx:612,sy:308,tw:512,th:214,w:512,h:214,collider:{type:"box",w:484,h:108,l:-6,t:18},zindex:5},trolls:{name:"trolls",tag:"bg",sprite:"mountroll",isTile:0,collider:!1,zindex:0},mountain1:{name:"mountain1",tag:"bg",sprite:"env",isTile:1,sx:64,sy:902,tw:786,th:348,w:786,h:348,collider:!1,zindex:0},mountain2:{name:"mountain2",tag:"bg",sprite:"env",isTile:1,sx:934,sy:890,tw:1070,th:456,w:1070,h:456,collider:!1,zindex:0},goal:{name:"goal",tag:"event_trigger",sprite:"flag",isTile:0,collider:{type:"box",w:100,h:1500,t:-500},zindex:0},saw:{name:"saw",tag:"saw-block",sprite:"env",isTile:1,sx:870,sy:1770,tw:234,th:234,w:234
,h:234,collider:{type:"box",w:200,h:200},zindex:9,back:{sx:644,sy:1264,w:210,h:780}},fuck:{name:"fuck",tag:"fuck-block",sprite:"env",isTile:1,sx:82,sy:1284,tw:506,th:754,w:506,h:754,collider:{type:"box",w:472,h:392,l:-10,t:180},zindex:4}}};return e}),define("data",[],function(){var e={coefAirReductor:.99,coefFloorReductor:.5,coefFloorImpulsion:.7,coefIceReductor:.9999,coefIceImpulsion:.05,coefSlowReductor:.05,coefSlowImpulsion:.2,coefAirFriction:.9,maxAttractionForce:100,maxGravityX:20,maxGravityY:20,attractionForce:.1,coefAirControlX:.1,coefAirControlY:.01,runsByGame:5,environmentCollidersTag:["block","lava-block","ice-block","bounce-block","spike-block","slow-block","saw-block","fuck-block"],character:{moveSpeed:8,jumpForce:-3.2,jumpImpulsion:5,mass:10}};return e}),define("screens.menu",["shared","data","DREAM_ENGINE"],function(e,t,n){function s(t){r=new n.Scene("Menu"),i=new n.Camera(1920,1080,0,0,{name:"Test zoom 100%",backgroundColor:"rgb(150,150,170)"}),i.scene=r,r.add(new n.GameObject
({x:960,y:540,zindex:0,renderer:new n.SpriteRenderer({spriteName:"bg_main"})})),r.add(new n.GameObject({x:960,y:540,zindex:10,renderer:new n.SpriteRenderer({spriteName:"panel_main"})}));var s=e.components.fuck,o=new n.GameObject({x:1160,y:540,zindex:4,renderer:new n.TileRenderer({imageName:"env",w:s.w,h:s.h,tilesizes:{w:s.tw||s.w,h:s.th||s.h},tileposition:{x:s.sx,y:s.sy}})});o.position.setRotation(Math.PI*.5);var u=new n.GameObject({x:960,y:950,zindex:2,renderer:new n.TextRenderer({fontSize:130,alpha:0},1920,400,"Press Start")});return r.add(u,o),u.checkPad=function(){if(n.Inputs.key("start1")||n.Inputs.key("start2"))n.trigger("changeScreen","game","flat"),u.enable=!1},u.addAutomatism("checkPad","checkPad"),i.on("fadeEnd",function(){i.alpha==0&&(r.sleep=!0)}),t.add(i),{show:function(){r.sleep=!1,i.sleep=!1,i.fadeIn(500),u.enable=!0,n.AudioManager.fx.play("v_intro"),setTimeout(function(){u.fadeIn(500)},1e3),i.onMouseUp=function(){n.trigger("changeScreen","game","flat")},setTimeout(function(
){o.moveTo({x:1460},1e3,function(){n.AudioManager.fx.play("v_v_gnihihi"),setTimeout(function(){o.moveTo({x:1060},2e3),n.AudioManager.fx.play("v_v_nininini")},3800)})},6850)},hide:function(){i.fadeOut(1e3),u.fadeOut(1e3)}}}var r,i;return s}),define("cameraSizer",["DREAM_ENGINE","shared"],function(e,t){function n(){var n=new e.GameObject;return n.scrollSpeed=40,n.toEdit=function(){t.camera1.renderPosition.y<540&&(t.camera1.renderPosition.y+=10),t.camera1.fieldSizes.height<1080&&(t.camera1.fieldSizes.height+=20,t.camera1.renderSizes.height+=20,t.camera1._buffer.canvas.height+=20),t.camera2.renderPosition.y<1620&&(t.camera2.renderPosition.y+=30),t.camera2.fieldSizes.height<1080&&(t.camera2.fieldSizes.height+=20,t.camera2.renderSizes.height+=20,t.camera2._buffer.canvas.height+=20),t.camera2.renderPosition.y==1080+540&&t.camera2.fieldSizes.height==1080&&t.camera1.renderPosition.y==540&&t.camera1.fieldSizes.height==1080&&(this.removeAutomatism("toEdit"),t.camera1.gui=t.camera1.guiBuild,t.camera2
.gui=t.camera2.guiBuild,t.camera1.gui.show(),t.camera2.gui.show(),t.camera2.gui.sleep=!0,t.player1.enable=!1,t.player2.enable=!1)},n.cam1ToCam2=function(){t.camera1.renderPosition.y>-540&&(t.camera1.renderPosition.y-=this.scrollSpeed),t.camera2.renderPosition.y>540&&(t.camera2.renderPosition.y-=this.scrollSpeed),t.camera1.renderPosition.y<=-540&&(t.camera1.gui.sleep=!0,t.camera2.gui.sleep=!1,t.camera2.renderPosition.y=540,this.removeAutomatism("cam1ToCam2"))},n.cam2ToCam1=function(){t.camera1.renderPosition.y<540&&(t.camera1.renderPosition.y+=this.scrollSpeed),t.camera2.renderPosition.y<1620&&(t.camera2.renderPosition.y+=this.scrollSpeed),t.camera1.renderPosition.y>=540&&(t.camera1.gui.sleep=!1,t.camera2.gui.sleep=!0,t.camera1.renderPosition.y=540,this.removeAutomatism("cam2ToCam1"))},n.toPlay=function(){t.camera1.renderPosition.y>270&&(t.camera1.renderPosition.y-=10),t.camera1.fieldSizes.height>540&&(t.camera1.fieldSizes.height-=20,t.camera1.renderSizes.height-=20,t.camera1._buffer.canvas
.height-=20),t.camera2.renderPosition.y<810&&(t.camera2.renderPosition.y+=10),t.camera2.fieldSizes.height>540&&(t.camera2.fieldSizes.height-=20,t.camera2.renderSizes.height-=20,t.camera2._buffer.canvas.height-=20),t.camera2.renderPosition.y>=810&&t.camera2.fieldSizes.height==540&&t.camera1.renderPosition.y<=270&&t.camera1.fieldSizes.height==540&&(t.camera1.renderPosition.y=270,t.camera2.renderPosition.y=810,this.removeAutomatism("toPlay"),t.player1.position.x=t.levels[n.currentLevel].startX,t.player1.position.y=t.levels[n.currentLevel].startY,t.player2.position.x=t.levels[n.currentLevel].startX,t.player2.position.y=t.levels[n.currentLevel].startY,t.camera1.focus(t.player1),t.camera2.focus(t.player2),t.player1.enable=!0,t.player2.enable=!0,t.camera1.gui=t.camera1.guiPlay,t.camera2.gui=t.camera2.guiPlay,e.trigger("playReady"))},n}return n}),define("Saw",["DREAM_ENGINE","shared"],function(e,t){function n(n,r,i,s){e.GameObject.call(this,{name:n.name,tag:r.tag,x:n.x>>0,y:n.y>>0,z:n.z||r.z||0
,zindex:n.zindex||r.zindex,renderer:i,collider:s}),this.customInit=function(){this.bar=new e.GameObject({x:this.position.x,y:this.position.y,zindex:this.zindex-1,renderer:new e.TileRenderer({imageName:r.sprite,w:r.back.w,h:r.back.h,tilesizes:{w:r.back.tw||r.back.w,h:r.back.th||r.back.h},tileposition:{x:r.back.sx,y:r.back.sy}})}),this.scene.add(this.bar)},this.spawnY=this.position.y,this.dir=1,this.speed=10,this.moveDist=370,this.moveLogic=function(){this.bar.position.x=this.position.x,this.rotate(1),this.translateY(this.speed*this.dir,!0),this.dir==1&&this.position.y+this.speed>=this.spawnY+this.moveDist?this.dir=-1:this.dir==-1&&this.position.y-this.speed<=this.spawnY-this.moveDist&&(this.dir=1)},this.addAutomatism("moveLogic","moveLogic"),this.on("collision-enter",function(n){n.onFloor=!1,n.position.y>this.position.y?n.gravity.y=3:n.gravity.y=-3,n.gravity.x=3,t["camera"+n.playerId].shake(10,10,500),n.setAnim("hurt"),e.trigger("play-random-fx","big-hurt")})}return n.prototype=new e.GameObject
,n.prototype.constructor=n,n.prototype.supr=e.GameObject.prototype,n}),define("createComponent",["DREAM_ENGINE","shared","data","Saw"],function(e,t,n,r){function i(i,s){var o=t.components[i.name];if(o.tag=="character")throw new Error("no character in code");var u=null;!o.sprite||(o.isTile?u=new e.TileRenderer({imageName:o.sprite,w:o.w,h:o.h,tilesizes:{w:o.tw||o.w,h:o.th||o.h},tileposition:{x:o.sx,y:o.sy}}):u=new e.SpriteRenderer({spriteName:o.sprite,w:o.w,h:o.h}));var a=undefined;o.collider&&i.zindex>=0&&(o.collider.type=="circle"?a=new e.CircleCollider(o.collider.r,{offsetLeft:o.collider.l,offsetTop:o.collider.t}):a=new e.FixedBoxCollider(o.collider.w,o.collider.h,{offsetLeft:o.collider.l,offsetTop:o.collider.t}));var f;switch(o.tag){case"saw-block":f=new r(i,o,u,a);break;default:f=new e.GameObject({name:i.name,tag:o.tag,x:i.x>>0,y:i.y>>0,z:i.z||o.z||0,zindex:i.zindex||o.zindex,renderer:u,collider:a})}o.tag.match("ice")?(o.physicCoefReductor=n.coefIceReductor,o.physicCoefImpulsion=n.coefIceImpulsion
):o.tag.match("slow")&&(o.physicCoefReductor=n.coefSlowReductor,o.physicCoefImpulsion=n.coefSlowImpulsion);switch(o.tag){case"lava-block":f.on("collision-enter",function(n){n.onFloor=!1,n.gravity.y=-3,n.gravity.x=2,t["camera"+n.playerId].shake(10,10,500),n.setAnim("hurt"),e.trigger("play-random-fx","big-hurt")});break;case"spike-block":f.on("collision-enter",function(n){n.onFloor=!1,n.gravity.y=-1.5,n.gravity.x=1,t["camera"+n.playerId].shake(5,5,500),n.setAnim("hurt"),e.trigger("play-random-fx","hurt")});break;case"bounce-block":f.on("collision-enter",function(t){t.onFloor=!1,t.gravity.y=-5,t.setAnim("jump"),e.trigger("play-random-fx","happy")});break;case"fuck-block":f.on("collision-enter",function(n){if(n.position.y+n.collider.height/2-10>this.position.y-10||this.lastUse-e.Time.currentTime<5e3)return;this.lastUse=Date.now(),n.locked=!0,setTimeout(function(){n.locked=!1},3e3),t["camera"+n.playerId].shake(10,10,2500),n.setAnim("hurt"),e.trigger("play-random-fx","rage")})}return f.physicCoefReductor=
o.physicCoefReductor||n.coefFloorReductor,f.physicCoefImpulsion=o.physicCoefImpulsion||n.coefFloorImpulsion,n.environmentCollidersTag.indexOf(f.tag)!==-1?s.collideObjects.push(f):f.tag==="event_trigger"&&(f.event_target=i.target||o.target,s.event_triggers.push(f)),s.add(f),f.customInit&&f.customInit(),f}return i}),define("makeEditorGui",["DREAM_ENGINE","shared","createComponent"],function(e,t,n){function r(r,i,s){var o=i.guiBuild;o.deleteAll(),o.playerId=r,o.addedObjects=[];var u=JSON.parse(JSON.stringify(t.levels[s].objects));o.container=new e.GameObject({x:960,y:540,zindex:1,renderer:new e.BoxRenderer({fillColor:"rgb(100,100,100)",alpha:.8},1920,1080)}),o.selector=new e.GameObject({x:192,y:358,zindex:10,renderer:new e.BoxRenderer({method:"stroke",strokeColor:"red",lineWidth:2},258,258)}),o.emptyContainer=new e.GameObject,o.emptyContainer.add(o.selector,o.container,new e.GameObject({x:960,y:150,zindex:9,renderer:new e.TextRenderer({fontSize:40},800,100,"Choose a stuff to put on the field"
)}));var a=1;r==1&&(a=2),o.selector.tiledPos={x:0,y:0},o.selector.checkPad=function(){t["player"+a].axes.x>0&&this.tiledPos.x+1<c[this.tiledPos.y].length?this.tiledPos.x+=1:t["player"+a].axes.x<0&&this.tiledPos.x-1>=0&&(this.tiledPos.x-=1),t["player"+a].axes.y>0&&this.tiledPos.y+1<c.length?this.tiledPos.y+=1:t["player"+a].axes.y<0&&this.tiledPos.y-1>=0&&(this.tiledPos.y-=1);if(e.Inputs.key("valid-block-"+a)){c[this.tiledPos.y][this.tiledPos.x].onMouseUp();return}this.focus(c[this.tiledPos.y][this.tiledPos.x])},o.selector.addAutomatism("checkPad","checkPad",{interval:130}),o.add(o.emptyContainer);var f=null,l=7,c=new Array;for(var h=0;h<u.length;++h)f=new e.GameObject({x:64+256*(h%l)+128,y:28+260*(h/l>>0)+330,zindex:8,name:u[h].id,renderers:[new e.SpriteRenderer({spriteName:"block_icons",startFrame:u[h].f}),new e.TextRenderer({offsetX:95,offsetY:100,fontSize:32},100,50,"x"+u[h].q)],collider:new e.FixedBoxCollider(256,256)}),f.quantity=u[h].q,f.onMouseMove=function(){o.selector.position.x=
this.position.x,o.selector.position.y=this.position.y},f.onMouseUp=function(){if(this.quantity==0)return;var e=n({x:i.scenePosition.x+960,y:i.scenePosition.y+540,name:this.name,zindex:10},i.scene);e.renderer.alpha=.7,i.focus(e,{lock:{y:!0}}),e.on("cancel-creation",this.restore,this),e.on("placed",this.placed,this),e.scene.startPlacingObject(e),e.position.y=e.scene.buildLimits.maxY+e.biggerOffset.height,this.quantity--,this.renderers[1].setText("x"+this.quantity),this.quantity==0&&(this.renderer.currentLine=1),o.emptyContainer.enable=!1},f.restore=function(){i.target=null,this.quantity++,this.renderers[1].setText("x"+this.quantity),this.renderer.currentLine=0,o.emptyContainer.enable=!0},f.placed=function(t){o.addedObjects.push(t),i.target=null,--o.objectsToPlace,e.trigger("endPlaceObject",o),o.objectsToPlace>0&&(o.emptyContainer.enable=!0)},h%l==0&&c.push(new Array),c[h/l>>0].push(f),o.emptyContainer.add(f);o.show=function(){this.objectsToPlace=2,this.emptyContainer.enable=!0},o.hide=function(
){this.emptyContainer.enable=!1},o.reset=function(){for(var e=0;e<this.addedObjects.length;++e)this.addedObjects[e].askToKill();this.addedObjects=[]}}return r}),define("makeGameGui",["DREAM_ENGINE","shared","data"],function(e,t,n){function r(r,i){var s=new e.Gui(t.camera1,{id:"Test"});i.gui=s;if(r==1){var o=new e.GameObject({x:960,y:320,renderer:new e.TextRenderer({fontSize:72},780,200,"Player 2 Press start")});o.checkStart=function(){e.Inputs.key("start2")&&(this.askToKill(),e.trigger("goEdit"))},o.addAutomatism("checkStart","checkStart"),s.add(o)}var u=new e.GameObject({x:0,y:100,renderer:new e.TextRenderer({fontSize:40,textAlign:"right"},400,50,"00.00.00")});u.value=0,u.count=function(){this.value+=e.Time.timeSinceLastFrameScaled;var t=(this.value/6e4>>0).toString(),n=((this.value/1e3>>0)%60).toString(),r=(this.value%1e3).toString();r.length>2?r=r[0].toString()+""+r[1].toString():r.length==1&&(r="0"+r[0].toString()),n.length<2&&(n="0"+n.toString()),t.length<2&&(t="0"+t.toString()),this
.renderer.setText(t+"."+n+"."+r)};var a=new e.GameObject({x:0,y:50,renderer:new e.TextRenderer({fontSize:40,textAlign:"right"},675,50,"Total: 00.00.00")});a.value=0,a.count=u.count;var f=new e.GameObject({x:960,y:270,renderer:new e.TextRenderer({fontSize:92},300,300,"3")});f.time=3,f.count=function(){this.time--,this.time==-1?(this.enable=!1,u.addAutomatism("count","count"),t["player"+r].locked=!1):this.time==0?this.renderer.setText("Go !"):this.renderer.setText(this.time)},f.enable=!1,f.addAutomatism("count","count",{interval:1e3});var l=new e.GameObject({x:960,y:270,renderer:new e.TextRenderer({fontSize:92},300,300,"Goal !")});l.enable=!1,s.getReady=function(){c.enable=!1,l.enable=!1,f.enable=!0,f.time=4,u.value=0},s.playerGoal=function(){l.enable=!0,t["player"+r].locked=!0,u.removeAutomatism("count"),t["player"+r].setAnim("idle"),t.player1.onGoal&&t.player2.onGoal&&e.trigger("endRun")};var c=new e.GameObject,h=new e.GameObject({x:960,y:100,renderer:new e.TextRenderer({fontSize:55},900
,60,"Run 1 / x")}),p=new e.GameObject({x:960,y:180,renderer:new e.TextRenderer({fontSize:55},900,60,"Total: 00.00.00")}),d=new e.GameObject({x:960,y:250,renderer:new e.TextRenderer({fontSize:55},900,60,"Round: 00.00.00")}),v=new e.GameObject({x:960,y:280,renderer:new e.TextRenderer({fontSize:75,fillColor:"green"},900,100,"Player "+r+" you lead")});c.add(p,d,v,h),c.enable=!1,s.add(c),s.endRun=function(e,t){h.renderer.setText("Run "+t+" / "+n.runsByGame),v.enable=!1,l.enable=!1,c.enable=!0,p.renderer.setText(a.renderer.text),a.value+=u.value,a.count(),a.renderer.setText("Total: "+a.renderer.text),d.enable=!0,d.renderer.fillColor="green",e<u.value&&(d.renderer.fillColor="red"),d.renderer.setText("Round: +"+u.renderer.text),u.value=0,u.count(),setTimeout(function(){p.renderer.setText(a.renderer.text),d.enable=!1,d.renderer.fillColor=="green"&&(v.enable=!0)},4e3)},s.reset=function(){a.value=0,u.value=0,u.count(),a.count(),a.renderer.setText("Total: "+a.renderer.text)};var m=new e.GameObject(
{x:960,y:r==1?538:2,renderer:new e.BoxRenderer({fillColor:"black"},1920,4)});return s.add(l,u,a,f,m),e.on("playReady",s.getReady),e.on("player"+r+"TouchEnd",s.playerGoal),s.getRunScore=function(){return u.value},s.getScore=function(){return a.value},s}return r}),define("Character",["data","DREAM_ENGINE"],function(e,t){function r(r,i,s,o,u,a){t.GameObject.call(this,{x:r,y:i,zindex:11,tag:s,collider:new t.FixedBoxCollider(o,u)}),a?this.addRenderer(new t.SpriteRenderer({spriteName:a,y:-40})):this.addRenderer(new t.BoxRenderer({fillColor:"rgb(200,30,30)",alpha:.4},o-2,u-2));var f=new t.SpriteRenderer({spriteName:a+"_states",y:-40}),l=this.renderer;l.setPause(!0),this.moveSpeed=e.character.moveSpeed,this.jumpForce=e.character.jumpForce,this.jumpImpulsion=e.character.jumpImpulsion,this.mass=e.character.mass,this.axes={x:0,y:0},this.gravity={x:0,y:0},this.previousMove={x:0,y:0},this.onFloor=!1,this.jumpedTimes=0,this.jumpLimit=2,this.locked=!1,this.dir=-1,this.renderer.currentLine=1;var c=this
;return this.logic=function(){this.move(),this.makeCollision()},this.on("on-floor",function(){this.jumpedTimes=0},this),this.move=function(){var t=this.axes.x;this.locked&&(t=0),t<0?(this.dir=-1,this.renderer.currentLine=1):t>0&&(this.dir=1,this.renderer.currentLine=0),this.onFloor&&(t!=0?this.setAnim("run"):this.setAnim("idle")),this.gravity.x>e.maxGravityX?this.gravity.x=e.maxGravityX:this.gravity.x<-e.maxGravityX&&(this.gravity.x=-e.maxGravityX),this.gravity.y>e.maxGravityY?this.gravity.y=e.maxGravityY:this.gravity.y<-e.maxGravityY&&(this.gravity.y=-e.maxGravityY);var r=0;this.gravity.y>0?r=this.mass*this.gravity.y*e.coefAirFriction>>0:r=this.jumpImpulsion*this.gravity.y*e.coefAirFriction>>0,this.gravity.y+=n(this.gravity.y*this.mass)>e.maxAttractionForce?0:e.attractionForce,this.gravity.y=(this.gravity.y*1e3>>0)/1e3,!this.onFloor&&this.gravity.y>0&&this.setAnim("fall"),!this.onFloor&&this.axes.y>0&&(this.gravity.y+=e.coefAirControlY*this.axes.y);if(this.onFloor)this.gravity.x+=t*this
.currentBlock.physicCoefImpulsion,this.currentBlock.tag=="slow-block"&&this.setAnim("slow");else if(t!=0){var i=this.gravity.x;this.gravity.x+=t*e.coefAirControlX,i>0&&i>1&&i<this.gravity.x?this.gravity.x=i:i<0&&i<-1&&i>this.gravity.x&&(this.gravity.x=i)}var s=this.moveSpeed*this.gravity.x*e.coefAirFriction>>0;this.onFloor&&this.currentBlock&&(this.gravity.x*=this.currentBlock.physicCoefReductor),this.gravity.x=(this.gravity.x*100>>0)/100;var o=this.getPos();this.previousPosition={x:o.x,y:o.y},this.previousGravity={x:this.gravity.x,y:this.gravity.y},this.translate({x:s>>0,y:r>>0}),this.previousMove={x:this.position.x-this.previousPosition.x,y:this.position.y-this.previousPosition.y}},this.makeCollision=function(){if(!this.locked)for(var e=0;e<this.scene.event_triggers.length;++e)if(t.CollisionSystem.fixedBoxCollision(this.scene.event_triggers[e].collider,this.collider))switch(this.scene.event_triggers[e].name){case"goal":this.onGoal=!0,t.trigger("player"+this.playerId+"TouchEnd")}var n=
this.scene.collideObjects,r=this.collider.getRealPosition(),i=r.y,s=r.x,o=r.x+this.collider.width,u=r.y+this.collider.height,a=r.y-this.previousMove.y,f=r.x-this.previousMove.x,l=r.x-this.previousMove.x+this.collider.width,c=r.y-this.previousMove.y+this.collider.height,h={l:0,r:0,t:0,b:0},p={x:0,y:0},d={x:0,y:0},v=[],m,g;for(var e=0,y,b,w;e<n.length;++e,y=!1){m=!1,g=!1,b=n[e];if(b.enable&&t.CollisionSystem.fixedBoxCollision(this.collider,b.collider)){w=b.collider.getRealPosition();var E=w.y,S=w.x,x=w.x+b.collider.width,T=w.y+b.collider.height,N=S-o,C=s-x,k=E-u,L=i-T,A=S-l,O=f-x,M=E-c,_=a-T;this.previousMove.x!=0&&this.previousMove.y!=0?(A>=0&&N<0||A>0&&N<=0)&&this.previousMove.x>0?(p.x=S-(this.collider.width*.5+1)>>0,m=!0):(O>=0&&C<0||O>0&&C<=0)&&this.previousMove.x<0?(p.x=x+this.collider.width*.5+1>>0,m=!0):(M>=0&&k<0||M>0&&k<=0)&&this.previousMove.y>0?(p.y=E-(this.collider.height*.5+1)>>0,g=!0):_>=0&&L<0&&this.previousMove.y<0&&(p.y=T+this.collider.height*.5+1>>0,g=!0):this.previousMove
.x!=0?(this.previousMove.x>0?p.x=S-(this.collider.width*.5+1)>>0:this.previousMove.x<0&&(p.x=x+this.collider.width*.5+1>>0),m=!0):this.previousMove.y!=0&&(this.previousMove.y>0?p.y=E-(this.collider.height*.5+1)>>0:this.previousMove.y<0&&(p.y=T+this.collider.height*.5+1>>0),g=!0),g&&(this.gravity.y=0),m&&(this.gravity.x=0),this.position.x=p.x||this.position.x,this.position.y=p.y||this.position.y;if(this.previousMove.x>0&&this.previousMove.y!=0&&v.length){var D=this.position.x;this.position.x=this.previousPosition.x+this.previousMove.x;var P=!1;for(var H=0;H<v.length;++H)t.CollisionSystem.fixedBoxCollision(this.collider,v[H].collider)?P=!0:v.splice(H,1);P?this.position.x=D:this.gravity.x=this.previousGravity.x}d.x=p.x!=0?p.x-this.position.x:d.x,d.y=p.y!=0?p.y-this.position.y:d.y,v.push(b)}}p.y!=0&&this.previousMove.y>0&&(this.onFloor||this.trigger("on-floor"),this.onFloor=!0,this.gravity.y=0,this.currentBlock=v[0]);for(var H=0;H<v.length;++H)this.trigger("collision-enter",v[H]),v[H].trigger
("collision-enter",this);this.onFloor||(this.currentBlock&&(this.currentBlock.trigger("collision-leave",this),this.trigger("collision-leave",this.currentBlock)),this.currentBlock=null)},this.bindControls=function(e){return this.playerId=e,t.Inputs.on("axeMoved","haxe"+e,function(e){c.updateAxes(e,undefined)}),t.Inputs.on("axeMoved","vaxe"+e,function(e){c.updateAxes(undefined,e)}),t.Inputs.on("axeStop","haxe"+e,function(){c.updateAxes(0,undefined)}),t.Inputs.on("axeStop","vaxe"+e,function(){c.updateAxes(undefined,0)}),t.Inputs.on("keyUp","left"+e,function(){if(t.Inputs.key("right"+e))return;c.updateAxes(0,undefined)}),t.Inputs.on("keyUp","right"+e,function(){if(t.Inputs.key("left"+e))return;c.updateAxes(0,undefined)}),t.Inputs.on("keyDown","left"+e,function(){c.updateAxes(-1,undefined)}),t.Inputs.on("keyDown","right"+e,function(){c.updateAxes(1,undefined)}),t.Inputs.on("keyDown","up"+e,function(){c.updateAxes(undefined,-1)}),t.Inputs.on("keyDown","down"+e,function(){c.updateAxes(undefined
,1)}),t.Inputs.on("keyUp","up"+e,function(){c.updateAxes(undefined,0)}),t.Inputs.on("keyUp","down"+e,function(){c.updateAxes(undefined,0)}),t.Inputs.on("keyDown","jump"+e,function(){c.jump()}),t.Inputs.on("keyUp","jump"+e,function(){c.resetJump()}),this},this.setAnim=function(e){if(this.currentAnim==e)return;this.currentAnim=e,e!="run"&&e!="slow"&&e!="idle"?(f.currentLine=this.renderer.currentLine,this.renderers[0]=f,this.renderer=f,this.currentFrame=0):(l.currentLine=this.renderer.currentLine,this.renderers[0]=l,this.renderer=l,this.currentFrame=0,this.renderer.isPaused=!1,this.renderer.setPause(!1)),this.hurted=!1;switch(e){case"idle":this.renderer.currentFrame=2,this.renderer.setPause(!0);break;case"run":this.renderer.eachAnim=70;break;case"slow":this.renderer.eachAnim=200;break;case"hurt":this.hurted=!0,this.renderer.currentFrame=2;break;case"jump":this.renderer.currentFrame=0;break;case"fall":this.renderer.currentFrame=1}},this.jump=function(){if(!this.onFloor&&this.jumpedTimes>=this
.jumpLimit||this.locked)return;this.jumpedTimes++,this.onFloor=!1,this.gravity.y=this.jumpForce,this.setAnim("jump")},this.resetJump=function(){this.gravity.y<this.jumpForce/2&&(this.gravity.y=this.jumpForce/2)},this.addAutomatism("logic","logic"),this}var n=Math.abs;return r.prototype=new t.GameObject,r.prototype.constructor=r,r.prototype.supr=t.GameObject.prototype,r.prototype.updateAxes=function(e,t){this.axes={x:e!==undefined?e:this.axes.x,y:t!==undefined?t:this.axes.y}},r}),define("levelGenerator",["DREAM_ENGINE","shared","createComponent"],function(e,t,n){var r=function(r,i,s,o){o=o||{limits:{}},o.limits.maxX==1&&(s.limits.maxX=0),o.limits.minX==1&&(s.limits.minX=0),o.limits.maxY==1&&(s.limits.maxY=0),o.limits.minY==1&&(s.limits.minY=0),i.collideObjects=[],i.event_triggers=[],i.deleteAll();if(!t.levels[r]){console.log("%cGive a levelId not found in levels: "+r,"colors:red");return}var u=t.levels[r],a=u.components;for(var f=0;f<a.length;++f){var l=a[f],c=n(l,i);if(!c)continue;o.limits
.maxY==1&&(!o.limits.colliderOffset||!c.collider)&&c.position.y>s.limits.maxY?s.limits.maxY=c.position.y:o.limits.maxY==1&&o.limits.colliderOffset&&c.collider&&(c.collider.radius&&c.position.y+c.collider.radius>>0>s.limits.maxY?s.limits.maxY=c.position.y+c.collider.radius:c.collider.height&&c.position.y+c.collider.height*.5>>0>s.limits.maxY&&(s.limits.maxY=c.position.y+c.collider.height*.5>>0)),o.limits.minY==1&&(!o.limits.colliderOffset||!c.collider)&&c.position.y<s.limits.minY?s.limits.minY=c.position.y:o.limits.minY==1&&o.limits.colliderOffset&&c.collider&&(c.collider.radius&&c.position.y-c.collider.radius>>0<s.limits.minY?s.limits.minY=c.position.y-c.collider.radius:c.collider.height&&c.position.y-c.collider.height*.5>>0<s.limits.minY&&(s.limits.minY=c.position.y-c.collider.height*.5>>0)),o.limits.maxX==1&&(!o.limits.colliderOffset||!c.collider)&&c.position.x>s.limits.maxX?s.limits.maxX=c.position.x:o.limits.maxX==1&&o.limits.colliderOffset&&c.collider&&(c.collider.radius&&c.position
.x+c.collider.radius>>0>s.limits.maxX?s.limits.maxX=c.position.x+c.collider.radius:c.collider.width&&c.position.x+c.collider.width*.5>>0>s.limits.maxX&&(s.limits.maxX=c.position.x+c.collider.width*.5>>0)),o.limits.minX==1&&(!o.limits.colliderOffset||!c.collider)&&c.position.x<s.limits.minX?s.limits.minX=c.position.x:o.limits.minX==1&&o.limits.colliderOffset&&c.collider&&(c.collider.radius&&c.position.x-c.collider.radius>>0<s.limits.minX?s.limits.minX=c.position.x-c.collider.radius:c.collider.width&&c.position.x-c.collider.width*.5>>0<s.limits.minX&&(s.limits.minX=c.position.x-c.collider.width*.5>>0))}u.limits.maxX!=1&&!isNaN(u.limits.maxX)&&(s.limits.maxX=u.limits.maxX),u.limits.minX!=1&&!isNaN(u.limits.minX)&&(s.limits.minX=u.limits.minX),u.limits.maxY!=1&&!isNaN(u.limits.maxY)&&(s.limits.maxY=u.limits.maxY),u.limits.minY!=1&&!isNaN(u.limits.minY)&&(s.limits.minY=u.limits.minY),e.trigger("map-loaded",r,i,s)};return r}),define("screens.game",["shared","DREAM_ENGINE","cameraSizer","makeEditorGui"
,"makeGameGui","Character","levelGenerator","data"],function(e,t,n,r,i,s,o,u){function a(n){function r(n){var r=1;this.playerId==1&&(r=2),n.playerId=r,n.onMouseUp=function(){this.onMouseUp=undefined,this.trigger("placed",this),this.renderer.alpha=1,this.scene.isPlacing=!1},this.isPlacing=!0,this.placedObject=n,n.checkPlacenementInputs=function(){t.Inputs.key("valid-block-"+this.playerId)?(this.removeAutomatism("checkPlacenementInputs"),this.onMouseUp=undefined,this.renderer.alpha=1,this.trigger("placed",this),this.scene.isPlacing=!1):t.Inputs.key("cancel-block-"+this.playerId)?(this.removeAutomatism("checkPlacenementInputs"),this.scene.isPlacing=!1,this.scene.placedObject=null,this.trigger("cancel-creation"),this.askToKill()):(e["player"+this.playerId].axes.x&&(this.position.x+=15*e["player"+this.playerId].axes.x),e["player"+this.playerId].axes.y&&(this.position.y+=5*e["player"+this.playerId].axes.y),this.position.x+this.biggerOffset.width>this.scene.buildLimits.maxX?this.position.x=this
.scene.buildLimits.maxX-this.biggerOffset.width:this.position.x-this.biggerOffset.width<this.scene.buildLimits.minX&&(this.position.x=this.scene.buildLimits.minX+this.biggerOffset.width),this.position.y-this.biggerOffset.height>this.scene.buildLimits.maxY?this.position.y=this.scene.buildLimits.maxY+this.biggerOffset.height:this.position.y-this.biggerOffset.height<this.scene.buildLimits.minY&&(this.position.y=this.scene.buildLimits.minY+this.biggerOffset.height))},setTimeout(function(){n.addAutomatism("checkPlacenementInputs","checkPlacenementInputs")},500)}e.scene1=new t.Scene("Test"),e.camera1=new t.Camera(1920,540,0,0,{name:"Test zoom 100%",backgroundColor:"rgb(150,150,170)"}),e.camera1.scene=e.scene1,e.scene2=new t.Scene("Test"),e.camera2=new t.Camera(1920,540,0,540,{name:"Test zoom 100%",backgroundColor:"rgb(160,150,150)"}),e.camera2.scene=e.scene2,e.camera1.guiBuild=new t.Gui(e.camera1,{id:"Test"}),e.camera2.guiBuild=new t.Gui(e.camera2,{id:"Test"}),e.camera1.guiPlay=i(1,e.camera1)
,e.camera2.guiPlay=i(2,e.camera2),n.add(e.camera1),n.add(e.camera2),e.camera1.scenePosition.z=-15,e.camera2.scenePosition.z=-15,e.scene1.playerId=1,e.scene2.playerId=2,e.scene1.startPlacingObject=r,e.scene2.startPlacingObject=r,t.on("switchToCam1",function(){e.camera1.gui.sleep=!0,e.camera2.gui.sleep=!0,e.sizer.addAutomatism("cam2ToCam1","cam2ToCam1")}),t.on("switchToCam2",function(){e.camera1.gui.sleep=!0,e.camera2.gui.sleep=!0,e.sizer.addAutomatism("cam1ToCam2","cam1ToCam2")}),t.on("goEdit",function(){e.sizer.addAutomatism("toEdit","toEdit"),e.camera1.focus(null),e.camera2.focus(null),e.camera1.moveTo({z:-10},500,function(){this.scenePosition.y=-300}),e.camera2.moveTo({z:-10},500,function(){this.scenePosition.y=-300}),t.AudioManager.music.stopAllAndPlay("edit_music")}),t.on("endPlaceObject",function(n){n.objectsToPlace>0?(n.playerId==1&&e.camera2.gui.objectsToPlace>0&&t.trigger("switchToCam2"),n.playerId==2&&e.camera1.gui.objectsToPlace>0&&t.trigger("switchToCam1")):n.playerId==1?e.camera2
.gui.objectsToPlace==0?t.trigger("goPlay"):t.trigger("switchToCam2"):n.playerId==2&&(e.camera1.gui.objectsToPlace==0?t.trigger("goPlay"):t.trigger("switchToCam1"))});var s=0;return t.on("goPlay",function(){e.player1.onGoal=!1,e.player2.onGoal=!1,e.camera1.gui.sleep=!1,e.camera2.gui.sleep=!1,e.camera1.renderPosition.y=540,e.camera2.renderPosition.y=540,e.camera1.focus(e.player1),e.camera2.focus(e.player2),e.camera1.moveTo({z:-15},500),e.camera2.moveTo({z:-15},500),e.sizer.addAutomatism("toPlay","toPlay"),t.AudioManager.music.stopAllAndPlay("game_music")}),t.on("endRun",function(){++s;if(s<u.runsByGame){var n=e.camera2.guiPlay.getRunScore(),r=e.camera1.guiPlay.getRunScore();e.camera1.guiPlay.endRun(n,s),e.camera2.guiPlay.endRun(r,s),setTimeout(function(){t.trigger("goEdit")},8e3)}else s=0,e.camera1.guiPlay.getScore()<e.camera2.guiPlay.getScore()?alert("player 1 win"):alert("player 2 win"),setTimeout(function(){e.camera1.guiPlay.reset(),e.camera2.guiPlay.reset(),e.camera1.guiBuild.reset(),
e.camera2.guiBuild.reset(),t.trigger("goEdit")},2e3)}),{show:function(t){e.camera1.sleep=!1,e.camera2.sleep=!1,e.camera1.gui.sleep=!0,e.camera2.gui.sleep=!0,e.scene1.sleep=!1,e.scene2.sleep=!1,setTimeout(function(){e.camera1.gui.sleep=!1,e.camera2.gui.sleep=!1},800),f(t)},hide:function(){e.camera1.sleep=!0,e.camera2.sleep=!0,e.scene1.sleep=!0,e.scene2.sleep=!0}}}function f(t){o(t,e.scene1,e.camera1,{limits:{maxX:!0,maxY:!0,minX:!0,colliderOffset:!0}}),o(t,e.scene2,e.camera2,{limits:{maxX:!0,maxY:!0,minX:!0,colliderOffset:!0}}),e.player1=(new s(e.levels[t].startX,e.levels[t].startY,"player",50,140,"player1")).bindControls(1),e.player2=(new s(e.levels[t].startX,e.levels[t].startY,"player",50,140,"player2")).bindControls(2),e.player1.enable=!1,e.player2.enable=!1,e.player1.locked=!0,e.player2.locked=!0,e.scene1.buildLimits=e.levels[t].buildLimits,e.scene2.buildLimits=e.levels[t].buildLimits,e.scene1.add(e.player1),e.scene2.add(e.player2),e.camera1.focus(e.player1),e.camera2.focus(e.player2
),r(1,e.camera1,t),r(2,e.camera2,t),e.sizer=n(),e.scene1.add(e.sizer),e.sizer.currentLevel=t}return a}),define("Game",["DREAM_ENGINE","screens.menu","screens.game"],function(e,t,n){function s(t){e.AudioManager.fx.play(i[t][Math.random()*i[t].length>>0])}function o(e,t){for(var n in r.screens)n!=e&&r.screens[n].hide();r.screens[e].show(t)}var r={};r.render=null,r.init=function(){console.log("init Engine"),e.CONFIG.DEBUG=0,e.CONFIG.DEBUG_LEVEL=0,r.render=new e.Render("render",{fullScreen:"ratioStretch"}),r.render.init(),e.start()},r.start=function(){console.log("game starto!!"),r.screens={game:n(r.render),menu:t(r.render)},e.on("changeScreen",o),e.on("play-random-fx",s),e.trigger("changeScreen","menu"),e.AudioManager.setVolume(80),setTimeout(function(){e.States.down("isLoading")},200)};var i={hurt:["v_hurt_aie","v_hurt_ouille1","v_hurt_ouille2","v_hurt_ouille3","v_hurt_ouillex2","v_hurt_fuck1","v_hurt_fuck2"],"big-hurt":["v_bhurt_awawa","v_bhurt_ouilleaie","v_bhurt_ouillex3","v_bhurt_waha"
],happy:["v_hap_wahou","v_hap_weee","v_hap_wouhou","v_hap_yay","v_hap_yepee","v_jump_zdoing","v_jump_zdoing2"],rage:["v_rage_fuck","v_rage_bouhou","v_rage_grumble"]};return r}),define("gameLoop",["DREAM_ENGINE","Game"],function(e,t){function n(e){}return n}),define("DE.imagesDatas",["DE.CONFIG"],function(e){var t={screenSizes:[{w:1920,h:1080,path:""}],conceptionSizeIndex:0,folderName:"img",imagesList:[["env","env","png",{load:!0,totalFrame:1,eachAnim:1,totalLine:1,isAnimated:!1}],["mountroll","mountroll","png",{load:!0,totalFrame:1,eachAnim:1,totalLine:1,isAnimated:!1}],["bg_main","mainscreen","jpg",{load:!0,totalFrame:1,eachAnim:1,totalLine:1,isAnimated:!1}],["panel_main","panel_main","png",{load:!0,totalFrame:1,eachAnim:1,totalLine:1,isAnimated:!1}],["flag","flag","png",{load:!0,totalFrame:1,eachAnim:1,totalLine:1,isAnimated:!1}],["block_icons","block_icons","png",{load:!0,totalFrame:8,totalLine:2,isAnimated:!1}],["player1","character/p1/run","png",{load:!0,totalFrame:6,totalLine:2,eachAnim
:70,isAnimated:!0}],["player1_states","character/p1/states","png",{load:!0,totalFrame:3,totalLine:2,isAnimated:!1}],["player2","character/p2/run","png",{load:!0,totalFrame:6,totalLine:2,eachAnim:70,isAnimated:!0}],["player2_states","character/p2/states","png",{load:!0,totalFrame:3,totalLine:2,isAnimated:!1}]]};return e.debug.log("imagesDatas loaded",3),t}),define("DE.audiosList",["DE.CONFIG"],function(e){var t=[["game_music","audio/fight",["ogg","mp3"],{preload:!0,loop:!0,isMusic:!0}],["edit_music","audio/editor",["ogg","mp3"],{preload:!0,loop:!0,isMusic:!0}],["mouseclick1","audio/mouseclick1",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_intro","audio/voice/intro",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hurt_aie","audio/voice/short_ouille/aie",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hurt_ouille1","audio/voice/short_ouille/ouille1",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hurt_ouille2","audio/voice/short_ouille/ouille2",["ogg","mp3"],{preload:!0,loop
:!1,isMusic:!1}],["v_hurt_ouille3","audio/voice/short_ouille/ouille3",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hurt_ouillex2","audio/voice/short_ouille/ouilleouille",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hurt_fuck1","audio/voice/short_ouille/fuck1",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hurt_fuck2","audio/voice/short_ouille/fuck2",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_bhurt_awawa","audio/voice/big_ouille/awawa",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_bhurt_ouilleaie","audio/voice/big_ouille/ouilleaie",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_bhurt_ouillex3","audio/voice/big_ouille/ouillex3",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_bhurt_waha","audio/voice/big_ouille/waha",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hap_wahou","audio/voice/happy/wahou",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hap_weee","audio/voice/happy/weeeeee",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hap_wouhou","audio/voice/happy/wouhou"
,["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hap_yay","audio/voice/happy/yay",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_hap_yepee","audio/voice/happy/yepee",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_jump_zdoing","audio/voice/jump/zdoing",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_jump_zdoing2","audio/voice/jump/doinoing",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_v_gnihihi","audio/voice/victory/gnihihi",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_v_nininini","audio/voice/victory/nininini",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_v_niagniana","audio/voice/victory/niagniana",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_v_titoli","audio/voice/victory/titoli-yahi",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_v_tutuwatutu","audio/voice/victory/tutuwatutu",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_rage_fuck","audio/voice/rage/fuck",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_rage_bouhou","audio/voice/rage/bouhou"
,["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}],["v_rage_grumble","audio/voice/rage/grumble",["ogg","mp3"],{preload:!0,loop:!1,isMusic:!1}]];return e.debug.log("audioList loaded",3),t}),define("DE.inputsList",["DE.CONFIG"],function(e){var t={left1:{keycodes:["K.left"]},right1:{keycodes:["K.right"]},up1:{keycodes:["K.up"]},down1:{keycodes:["K.down"]},jump1:{keycodes:["G0.B.A","K.n"],stayOn:!0},haxe1:{keycodes:["G0.A.LHorizontal"]},vaxe1:{keycodes:["G0.A.LVertical"]},left2:{keycodes:["K.a","K.q"]},right2:{keycodes:["K.d"]},up2:{keycodes:["K.z","K.w"]},down2:{keycodes:["K.s"]},jump2:{keycodes:["G1.B.A","K.space"],stayOn:!0},haxe2:{keycodes:["G1.A.LHorizontal"]},vaxe2:{keycodes:["G1.A.LVertical"]},"valid-block-1":{keycodes:["G0.B.A","K.space","K.enter"]},"valid-block-2":{keycodes:["G1.B.A","K.space","K.enter"]},"cancel-block-1":{keycodes:["G0.B.B","K.escape","K.return"]},"cancel-block-2":{keycodes:["G1.B.B","K.escape","K.return"]},start1:{keycodes:["G0.B.start","G0.B.A","K.space","K.enter"]
},start2:{keycodes:["G1.B.start","G1.B.A","K.space","K.enter"]}};return e.debug.log("inputsList loaded",3),t}),define("DE.dictionary",["DE.CONFIG"],function(e){var t={en:{},fr:{}};return e.debug.log("dictionary loaded",3),t}),define("main",["gameLoop","Game","DE.imagesDatas","DE.audiosList","DE.inputsList","DE.dictionary"],function(e,t,n,r,i,s){function o(o){o.init({customLoop:e,onReady:t.init,onStart:t.start,loader:{scale:2},images:n,audios:r,inputs:i,dictionary:s,ignoreNebula:!0})}return o});